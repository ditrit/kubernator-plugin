/*! For license information please see kubernator-plugin.js.LICENSE.txt */
(()=>{var e={181:(e,t)=>{(()=>{var e={985:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";var r=Array.prototype,i=Object.prototype,o={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},s=/[&"'<>]/g;function a(e,t){return i.hasOwnProperty.call(e,t)}function l(e){return o[e]}function c(e,t,n){var r,i,o;if(e instanceof Error&&(e=(i=e).name+": "+i.message),Object.setPrototypeOf?(r=new Error(e),Object.setPrototypeOf(r,c.prototype)):(r=this,Object.defineProperty(r,"message",{enumerable:!1,writable:!0,value:e})),Object.defineProperty(r,"name",{value:"Template render error"}),Error.captureStackTrace&&Error.captureStackTrace(r,this.constructor),i){var s=Object.getOwnPropertyDescriptor(i,"stack");(o=s&&(s.get||function(){return s.value}))||(o=function(){return i.stack})}else{var a=new Error(e).stack;o=function(){return a}}return Object.defineProperty(r,"stack",{get:function(){return o.call(r)}}),Object.defineProperty(r,"cause",{value:i}),r.lineno=t,r.colno=n,r.firstUpdate=!0,r.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},r}function u(e){return"[object Function]"===i.toString.call(e)}function f(e){return"[object Array]"===i.toString.call(e)}function p(e){return"[object String]"===i.toString.call(e)}function h(e){return"[object Object]"===i.toString.call(e)}function d(e){var t,n=(t=e)?"string"==typeof t?t.split("."):[t]:[];return function(e){for(var t=e,r=0;r<n.length;r++){var i=n[r];if(!a(t,i))return;t=t[i]}return t}}function m(e){return Array.prototype.slice.call(e)}function y(e,t,n){return Array.prototype.indexOf.call(e||[],t,n)}function g(e){var t=[];for(var n in e)a(e,n)&&t.push(n);return t}(t=e.exports={}).hasOwnProp=a,t._prettifyError=function(e,n,r){if(r.Update||(r=new t.TemplateError(r)),r.Update(e),!n){var i=r;(r=new Error(i.message)).name=i.name}return r},Object.setPrototypeOf?Object.setPrototypeOf(c.prototype,Error.prototype):c.prototype=Object.create(Error.prototype,{constructor:{value:c}}),t.TemplateError=c,t.escape=function(e){return e.replace(s,l)},t.isFunction=u,t.isArray=f,t.isString=p,t.isObject=h,t.getAttrGetter=d,t.groupBy=function(e,t,n){for(var r={},i=u(t)?t:d(t),o=0;o<e.length;o++){var s=e[o],a=i(s,o);if(void 0===a&&!0===n)throw new TypeError('groupby: attribute "'+t+'" resolved to undefined');(r[a]||(r[a]=[])).push(s)}return r},t.toArray=m,t.without=function(e){var t=[];if(!e)return t;for(var n=e.length,r=m(arguments).slice(1),i=-1;++i<n;)-1===y(r,e[i])&&t.push(e[i]);return t},t.repeat=function(e,t){for(var n="",r=0;r<t;r++)n+=e;return n},t.each=function(e,t,n){if(null!=e)if(r.forEach&&e.forEach===r.forEach)e.forEach(t,n);else if(e.length===+e.length)for(var i=0,o=e.length;i<o;i++)t.call(n,e[i],i,e)},t.map=function(e,t){var n=[];if(null==e)return n;if(r.map&&e.map===r.map)return e.map(t);for(var i=0;i<e.length;i++)n[n.length]=t(e[i],i);return e.length===+e.length&&(n.length=e.length),n},t.asyncIter=function(e,t,n){var r=-1;!function i(){++r<e.length?t(e[r],r,i,n):n()}()},t.asyncFor=function(e,t,n){var r=g(e||{}),i=r.length,o=-1;!function s(){o++;var a=r[o];o<i?t(a,e[a],o,i,s):n()}()},t.indexOf=y,t.keys=g,t._entries=function(e){return g(e).map((function(t){return[t,e[t]]}))},t._values=function(e){return g(e).map((function(t){return e[t]}))},t._assign=t.extend=function(e,t){return e=e||{},g(t).forEach((function(n){e[n]=t[n]})),e},t.inOperator=function(e,t){if(f(t)||p(t))return-1!==t.indexOf(e);if(h(t))return e in t;throw new Error('Cannot use "in" operator to search for "'+e+'" in unexpected types.')}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}var a=n(16),l=n(0);function c(e,t,n){n=n||{},l.keys(n).forEach((function(t){var r,i;n[t]=(r=e.prototype[t],i=n[t],"function"!=typeof r||"function"!=typeof i?i:function(){var e=this.parent;this.parent=r;var t=i.apply(this,arguments);return this.parent=e,t})}));var r=function(e){function n(){return e.apply(this,arguments)||this}return o(n,e),i(n,[{key:"typename",get:function(){return t}}]),n}(e);return l._assign(r.prototype,n),r}var u=function(){function e(){this.init.apply(this,arguments)}return e.prototype.init=function(){},e.extend=function(e,t){return"object"==typeof e&&(t=e,e="anonymous"),c(this,e,t)},i(e,[{key:"typename",get:function(){return this.constructor.name}}]),e}(),f=function(e){function t(){var t,n;return(t=n=e.call(this)||this).init.apply(t,arguments),n}return o(t,e),t.prototype.init=function(){},t.extend=function(e,t){return"object"==typeof e&&(t=e,e="anonymous"),c(this,e,t)},i(t,[{key:"typename",get:function(){return this.constructor.name}}]),t}(a);e.exports={Obj:u,EmitterObj:f}},function(e,t,n){"use strict";var r=n(0),i=Array.from,o="function"==typeof Symbol&&Symbol.iterator&&"function"==typeof i,s=function(){function e(e,t){this.variables=Object.create(null),this.parent=e,this.topLevel=!1,this.isolateWrites=t}var t=e.prototype;return t.set=function(e,t,n){var r=e.split("."),i=this.variables,o=this;if(n&&(o=this.resolve(r[0],!0)))o.set(e,t);else{for(var s=0;s<r.length-1;s++){var a=r[s];i[a]||(i[a]={}),i=i[a]}i[r[r.length-1]]=t}},t.get=function(e){var t=this.variables[e];return void 0!==t?t:null},t.lookup=function(e){var t=this.parent,n=this.variables[e];return void 0!==n?n:t&&t.lookup(e)},t.resolve=function(e,t){var n=t&&this.isolateWrites?void 0:this.parent;return void 0!==this.variables[e]?this:n&&n.resolve(e)},t.push=function(t){return new e(this,t)},t.pop=function(){return this.parent},e}();function a(e){return e&&Object.prototype.hasOwnProperty.call(e,"__keywords")}function l(e){var t=e.length;if(t){var n=e[t-1];if(a(n))return n}return{}}function c(e){var t=e.length;return 0===t?0:a(e[t-1])?t-1:t}function u(e){if("string"!=typeof e)return e;this.val=e,this.length=e.length}u.prototype=Object.create(String.prototype,{length:{writable:!0,configurable:!0,value:0}}),u.prototype.valueOf=function(){return this.val},u.prototype.toString=function(){return this.val},e.exports={Frame:s,makeMacro:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s,a=c(i),u=l(i);if(a>e.length)s=i.slice(0,e.length),i.slice(s.length,a).forEach((function(e,n){n<t.length&&(u[t[n]]=e)})),s.push(u);else if(a<e.length){s=i.slice(0,a);for(var f=a;f<e.length;f++){var p=e[f];s.push(u[p]),delete u[p]}s.push(u)}else s=i;return n.apply(this,s)}},makeKeywordArgs:function(e){return e.__keywords=!0,e},numArgs:c,suppressValue:function(e,t){return e=null!=e?e:"",!t||e instanceof u||(e=r.escape(e.toString())),e},ensureDefined:function(e,t,n){if(null==e)throw new r.TemplateError("attempted to output null or undefined value",t+1,n+1);return e},memberLookup:function(e,t){if(null!=e)return"function"==typeof e[t]?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e[t].apply(e,r)}:e[t]},contextOrFrameLookup:function(e,t,n){var r=t.lookup(n);return void 0!==r?r:e.lookup(n)},callWrap:function(e,t,n,r){if(!e)throw new Error("Unable to call `"+t+"`, which is undefined or falsey");if("function"!=typeof e)throw new Error("Unable to call `"+t+"`, which is not a function");return e.apply(n,r)},handleError:function(e,t,n){return e.lineno?e:new r.TemplateError(e,t,n)},isArray:r.isArray,keys:r.keys,SafeString:u,copySafeness:function(e,t){return e instanceof u?new u(t):t.toString()},markSafe:function(e){var t=typeof e;return"string"===t?new u(e):"function"!==t?e:function(t){var n=e.apply(this,arguments);return"string"==typeof n?new u(n):n}},asyncEach:function(e,t,n,i){if(r.isArray(e)){var o=e.length;r.asyncIter(e,(function(e,r,i){switch(t){case 1:n(e,r,o,i);break;case 2:n(e[0],e[1],r,o,i);break;case 3:n(e[0],e[1],e[2],r,o,i);break;default:e.push(r,o,i),n.apply(this,e)}}),i)}else r.asyncFor(e,(function(e,t,r,i,o){n(e,t,r,i,o)}),i)},asyncAll:function(e,t,n,i){var o,s,a=0;function l(e,t){a++,s[e]=t,a===o&&i(null,s.join(""))}if(r.isArray(e))if(o=e.length,s=new Array(o),0===o)i(null,"");else for(var c=0;c<e.length;c++){var u=e[c];switch(t){case 1:n(u,c,o,l);break;case 2:n(u[0],u[1],c,o,l);break;case 3:n(u[0],u[1],u[2],c,o,l);break;default:u.push(c,o,l),n.apply(this,u)}}else{var f=r.keys(e||{});if(o=f.length,s=new Array(o),0===o)i(null,"");else for(var p=0;p<f.length;p++){var h=f[p];n(h,e[h],p,o,l)}}},inOperator:r.inOperator,fromIterator:function(e){return"object"!=typeof e||null===e||r.isArray(e)?e:o&&Symbol.iterator in e?i(e):e}}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function a(e,t,n){e instanceof t&&n.push(e),e instanceof l&&e.findAll(t,n)}var l=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var n=t.prototype;return n.init=function(e,t){for(var n=arguments,r=this,i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];this.lineno=e,this.colno=t,this.fields.forEach((function(e,t){var i=n[t+2];void 0===i&&(i=null),r[e]=i}))},n.findAll=function(e,t){var n=this;return t=t||[],this instanceof u?this.children.forEach((function(n){return a(n,e,t)})):this.fields.forEach((function(r){return a(n[r],e,t)})),t},n.iterFields=function(e){var t=this;this.fields.forEach((function(n){e(t[n],n)}))},t}(n(1).Obj),c=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"typename",get:function(){return"Value"}},{key:"fields",get:function(){return["value"]}}]),t}(l),u=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var n=t.prototype;return n.init=function(t,n,r){e.prototype.init.call(this,t,n,r||[])},n.addChild=function(e){this.children.push(e)},i(t,[{key:"typename",get:function(){return"NodeList"}},{key:"fields",get:function(){return["children"]}}]),t}(l),f=u.extend("Root"),p=c.extend("Literal"),h=c.extend("Symbol"),d=u.extend("Group"),m=u.extend("Array"),y=l.extend("Pair",{fields:["key","value"]}),g=u.extend("Dict"),v=l.extend("LookupVal",{fields:["target","val"]}),b=l.extend("If",{fields:["cond","body","else_"]}),w=b.extend("IfAsync"),_=l.extend("InlineIf",{fields:["cond","body","else_"]}),k=l.extend("For",{fields:["arr","name","body","else_"]}),x=k.extend("AsyncEach"),O=k.extend("AsyncAll"),S=l.extend("Macro",{fields:["name","args","body"]}),E=S.extend("Caller"),A=l.extend("Import",{fields:["template","target","withContext"]}),T=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.init=function(t,n,r,i,o){e.prototype.init.call(this,t,n,r,i||new u,o)},i(t,[{key:"typename",get:function(){return"FromImport"}},{key:"fields",get:function(){return["template","names","withContext"]}}]),t}(l),C=l.extend("FunCall",{fields:["name","args"]}),N=C.extend("Filter"),L=N.extend("FilterAsync",{fields:["name","args","symbol"]}),j=g.extend("KeywordArgs"),P=l.extend("Block",{fields:["name","body"]}),I=l.extend("Super",{fields:["blockName","symbol"]}),M=l.extend("TemplateRef",{fields:["template"]}).extend("Extends"),R=l.extend("Include",{fields:["template","ignoreMissing"]}),B=l.extend("Set",{fields:["targets","value"]}),D=l.extend("Switch",{fields:["expr","cases","default"]}),F=l.extend("Case",{fields:["cond","body"]}),$=u.extend("Output"),K=l.extend("Capture",{fields:["body"]}),V=p.extend("TemplateData"),q=l.extend("UnaryOp",{fields:["target"]}),U=l.extend("BinOp",{fields:["left","right"]}),z=U.extend("In"),Y=U.extend("Is"),G=U.extend("Or"),W=U.extend("And"),H=q.extend("Not"),J=U.extend("Add"),X=U.extend("Concat"),Q=U.extend("Sub"),Z=U.extend("Mul"),ee=U.extend("Div"),te=U.extend("FloorDiv"),ne=U.extend("Mod"),re=U.extend("Pow"),ie=q.extend("Neg"),oe=q.extend("Pos"),se=l.extend("Compare",{fields:["expr","ops"]}),ae=l.extend("CompareOperand",{fields:["expr","type"]}),le=l.extend("CallExtension",{init:function(e,t,n,r){this.parent(),this.extName=e.__name||e,this.prop=t,this.args=n||new u,this.contentArgs=r||[],this.autoescape=e.autoescape},fields:["extName","prop","args","contentArgs"]}),ce=le.extend("CallExtensionAsync");function ue(e,t,n){var r=e.split("\n");r.forEach((function(e,i){e&&(n&&i>0||!n)&&process.stdout.write(" ".repeat(t));var o=i===r.length-1?"":"\n";process.stdout.write(""+e+o)}))}e.exports={Node:l,Root:f,NodeList:u,Value:c,Literal:p,Symbol:h,Group:d,Array:m,Pair:y,Dict:g,Output:$,Capture:K,TemplateData:V,If:b,IfAsync:w,InlineIf:_,For:k,AsyncEach:x,AsyncAll:O,Macro:S,Caller:E,Import:A,FromImport:T,FunCall:C,Filter:N,FilterAsync:L,KeywordArgs:j,Block:P,Super:I,Extends:M,Include:R,Set:B,Switch:D,Case:F,LookupVal:v,BinOp:U,In:z,Is:Y,Or:G,And:W,Not:H,Add:J,Concat:X,Sub:Q,Mul:Z,Div:ee,FloorDiv:te,Mod:ne,Pow:re,Neg:ie,Pos:oe,Compare:se,CompareOperand:ae,CallExtension:le,CallExtensionAsync:ce,printNodes:function e(t,n){if(n=n||0,ue(t.typename+": ",n),t instanceof u)ue("\n"),t.children.forEach((function(t){e(t,n+2)}));else if(t instanceof le)ue(t.extName+"."+t.prop+"\n"),t.args&&e(t.args,n+2),t.contentArgs&&t.contentArgs.forEach((function(t){e(t,n+2)}));else{var r=[],i=null;t.iterFields((function(e,t){e instanceof l?r.push([t,e]):(i=i||{})[t]=e})),i?ue(JSON.stringify(i,null,2)+"\n",null,!0):ue("\n"),r.forEach((function(t){var r=t[0],i=t[1];ue("["+r+"] =>",n+2),e(i,n+4)}))}}}},function(e,t){},function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}var i=n(8),o=n(17),s=n(3),a=n(0).TemplateError,l=n(2).Frame,c=n(1).Obj,u={"==":"==","===":"===","!=":"!=","!==":"!==","<":"<",">":">","<=":"<=",">=":">="},f=function(e){var t,n;function i(){return e.apply(this,arguments)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var o=i.prototype;return o.init=function(e,t){this.templateName=e,this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this._scopeClosers="",this.inBlock=!1,this.throwOnUndefined=t},o.fail=function(e,t,n){throw void 0!==t&&(t+=1),void 0!==n&&(n+=1),new a(e,t,n)},o._pushBuffer=function(){var e=this._tmpid();return this.bufferStack.push(this.buffer),this.buffer=e,this._emit("var "+this.buffer+' = "";'),e},o._popBuffer=function(){this.buffer=this.bufferStack.pop()},o._emit=function(e){this.codebuf.push(e)},o._emitLine=function(e){this._emit(e+"\n")},o._emitLines=function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){return e._emitLine(t)}))},o._emitFuncBegin=function(e,t){this.buffer="output",this._scopeClosers="",this._emitLine("function "+t+"(env, context, frame, runtime, cb) {"),this._emitLine("var lineno = "+e.lineno+";"),this._emitLine("var colno = "+e.colno+";"),this._emitLine("var "+this.buffer+' = "";'),this._emitLine("try {")},o._emitFuncEnd=function(e){e||this._emitLine("cb(null, "+this.buffer+");"),this._closeScopeLevels(),this._emitLine("} catch (e) {"),this._emitLine("  cb(runtime.handleError(e, lineno, colno));"),this._emitLine("}"),this._emitLine("}"),this.buffer=null},o._addScopeLevel=function(){this._scopeClosers+="})"},o._closeScopeLevels=function(){this._emitLine(this._scopeClosers+";"),this._scopeClosers=""},o._withScopedSyntax=function(e){var t=this._scopeClosers;this._scopeClosers="",e.call(this),this._closeScopeLevels(),this._scopeClosers=t},o._makeCallback=function(e){var t=this._tmpid();return"function("+t+(e?","+e:"")+") {\nif("+t+") { cb("+t+"); return; }"},o._tmpid=function(){return this.lastId++,"t_"+this.lastId},o._templateName=function(){return null==this.templateName?"undefined":JSON.stringify(this.templateName)},o._compileChildren=function(e,t){var n=this;e.children.forEach((function(e){n.compile(e,t)}))},o._compileAggregate=function(e,t,n,r){var i=this;n&&this._emit(n),e.children.forEach((function(e,n){n>0&&i._emit(","),i.compile(e,t)})),r&&this._emit(r)},o._compileExpression=function(e,t){this.assertType(e,s.Literal,s.Symbol,s.Group,s.Array,s.Dict,s.FunCall,s.Caller,s.Filter,s.LookupVal,s.Compare,s.InlineIf,s.In,s.Is,s.And,s.Or,s.Not,s.Add,s.Concat,s.Sub,s.Mul,s.Div,s.FloorDiv,s.Mod,s.Pow,s.Neg,s.Pos,s.Compare,s.NodeList),this.compile(e,t)},o.assertType=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.some((function(t){return e instanceof t}))||this.fail("assertType: invalid type: "+e.typename,e.lineno,e.colno)},o.compileCallExtension=function(e,t,n){var r=this,i=e.args,o=e.contentArgs,a="boolean"!=typeof e.autoescape||e.autoescape;if(n||this._emit(this.buffer+" += runtime.suppressValue("),this._emit('env.getExtension("'+e.extName+'")["'+e.prop+'"]('),this._emit("context"),(i||o)&&this._emit(","),i&&(i instanceof s.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),i.children.forEach((function(e,n){r._compileExpression(e,t),(n!==i.children.length-1||o.length)&&r._emit(",")}))),o.length&&o.forEach((function(e,n){if(n>0&&r._emit(","),e){r._emitLine("function(cb) {"),r._emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}");var i=r._pushBuffer();r._withScopedSyntax((function(){r.compile(e,t),r._emitLine("cb(null, "+i+");")})),r._popBuffer(),r._emitLine("return "+i+";"),r._emitLine("}")}else r._emit("null")})),n){var l=this._tmpid();this._emitLine(", "+this._makeCallback(l)),this._emitLine(this.buffer+" += runtime.suppressValue("+l+", "+a+" && env.opts.autoescape);"),this._addScopeLevel()}else this._emit(")"),this._emit(", "+a+" && env.opts.autoescape);\n")},o.compileCallExtensionAsync=function(e,t){this.compileCallExtension(e,t,!0)},o.compileNodeList=function(e,t){this._compileChildren(e,t)},o.compileLiteral=function(e){if("string"==typeof e.value){var t=e.value.replace(/\\/g,"\\\\");t=(t=(t=(t=(t=t.replace(/"/g,'\\"')).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t")).replace(/\u2028/g,"\\u2028"),this._emit('"'+t+'"')}else null===e.value?this._emit("null"):this._emit(e.value.toString())},o.compileSymbol=function(e,t){var n=e.value,r=t.lookup(n);r?this._emit(r):this._emit('runtime.contextOrFrameLookup(context, frame, "'+n+'")')},o.compileGroup=function(e,t){this._compileAggregate(e,t,"(",")")},o.compileArray=function(e,t){this._compileAggregate(e,t,"[","]")},o.compileDict=function(e,t){this._compileAggregate(e,t,"{","}")},o.compilePair=function(e,t){var n=e.key,r=e.value;n instanceof s.Symbol?n=new s.Literal(n.lineno,n.colno,n.value):n instanceof s.Literal&&"string"==typeof n.value||this.fail("compilePair: Dict keys must be strings or names",n.lineno,n.colno),this.compile(n,t),this._emit(": "),this._compileExpression(r,t)},o.compileInlineIf=function(e,t){this._emit("("),this.compile(e.cond,t),this._emit("?"),this.compile(e.body,t),this._emit(":"),null!==e.else_?this.compile(e.else_,t):this._emit('""'),this._emit(")")},o.compileIn=function(e,t){this._emit("runtime.inOperator("),this.compile(e.left,t),this._emit(","),this.compile(e.right,t),this._emit(")")},o.compileIs=function(e,t){var n=e.right.name?e.right.name.value:e.right.value;this._emit('env.getTest("'+n+'").call(context, '),this.compile(e.left,t),e.right.args&&(this._emit(","),this.compile(e.right.args,t)),this._emit(") === true")},o._binOpEmitter=function(e,t,n){this.compile(e.left,t),this._emit(n),this.compile(e.right,t)},o.compileOr=function(e,t){return this._binOpEmitter(e,t," || ")},o.compileAnd=function(e,t){return this._binOpEmitter(e,t," && ")},o.compileAdd=function(e,t){return this._binOpEmitter(e,t," + ")},o.compileConcat=function(e,t){return this._binOpEmitter(e,t,' + "" + ')},o.compileSub=function(e,t){return this._binOpEmitter(e,t," - ")},o.compileMul=function(e,t){return this._binOpEmitter(e,t," * ")},o.compileDiv=function(e,t){return this._binOpEmitter(e,t," / ")},o.compileMod=function(e,t){return this._binOpEmitter(e,t," % ")},o.compileNot=function(e,t){this._emit("!"),this.compile(e.target,t)},o.compileFloorDiv=function(e,t){this._emit("Math.floor("),this.compile(e.left,t),this._emit(" / "),this.compile(e.right,t),this._emit(")")},o.compilePow=function(e,t){this._emit("Math.pow("),this.compile(e.left,t),this._emit(", "),this.compile(e.right,t),this._emit(")")},o.compileNeg=function(e,t){this._emit("-"),this.compile(e.target,t)},o.compilePos=function(e,t){this._emit("+"),this.compile(e.target,t)},o.compileCompare=function(e,t){var n=this;this.compile(e.expr,t),e.ops.forEach((function(e){n._emit(" "+u[e.type]+" "),n.compile(e.expr,t)}))},o.compileLookupVal=function(e,t){this._emit("runtime.memberLookup(("),this._compileExpression(e.target,t),this._emit("),"),this._compileExpression(e.val,t),this._emit(")")},o._getNodeName=function(e){switch(e.typename){case"Symbol":return e.value;case"FunCall":return"the return value of ("+this._getNodeName(e.name)+")";case"LookupVal":return this._getNodeName(e.target)+'["'+this._getNodeName(e.val)+'"]';case"Literal":return e.value.toString();default:return"--expression--"}},o.compileFunCall=function(e,t){this._emit("(lineno = "+e.lineno+", colno = "+e.colno+", "),this._emit("runtime.callWrap("),this._compileExpression(e.name,t),this._emit(', "'+this._getNodeName(e.name).replace(/"/g,'\\"')+'", context, '),this._compileAggregate(e.args,t,"[","])"),this._emit(")")},o.compileFilter=function(e,t){var n=e.name;this.assertType(n,s.Symbol),this._emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this._emit(")")},o.compileFilterAsync=function(e,t){var n=e.name,r=e.symbol.value;this.assertType(n,s.Symbol),t.set(r,r),this._emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this._emitLine(", "+this._makeCallback(r)),this._addScopeLevel()},o.compileKeywordArgs=function(e,t){this._emit("runtime.makeKeywordArgs("),this.compileDict(e,t),this._emit(")")},o.compileSet=function(e,t){var n=this,r=[];e.targets.forEach((function(e){var i=e.value,o=t.lookup(i);null==o&&(o=n._tmpid(),n._emitLine("var "+o+";")),r.push(o)})),e.value?(this._emit(r.join(" = ")+" = "),this._compileExpression(e.value,t),this._emitLine(";")):(this._emit(r.join(" = ")+" = "),this.compile(e.body,t),this._emitLine(";")),e.targets.forEach((function(e,t){var i=r[t],o=e.value;n._emitLine('frame.set("'+o+'", '+i+", true);"),n._emitLine("if(frame.topLevel) {"),n._emitLine('context.setVariable("'+o+'", '+i+");"),n._emitLine("}"),"_"!==o.charAt(0)&&(n._emitLine("if(frame.topLevel) {"),n._emitLine('context.addExport("'+o+'", '+i+");"),n._emitLine("}"))}))},o.compileSwitch=function(e,t){var n=this;this._emit("switch ("),this.compile(e.expr,t),this._emit(") {"),e.cases.forEach((function(e,r){n._emit("case "),n.compile(e.cond,t),n._emit(": "),n.compile(e.body,t),e.body.children.length&&n._emitLine("break;")})),e.default&&(this._emit("default:"),this.compile(e.default,t)),this._emit("}")},o.compileIf=function(e,t,n){var r=this;this._emit("if("),this._compileExpression(e.cond,t),this._emitLine(") {"),this._withScopedSyntax((function(){r.compile(e.body,t),n&&r._emit("cb()")})),e.else_?(this._emitLine("}\nelse {"),this._withScopedSyntax((function(){r.compile(e.else_,t),n&&r._emit("cb()")}))):n&&(this._emitLine("}\nelse {"),this._emit("cb()")),this._emitLine("}")},o.compileIfAsync=function(e,t){this._emit("(function(cb) {"),this.compileIf(e,t,!0),this._emit("})("+this._makeCallback()),this._addScopeLevel()},o._emitLoopBindings=function(e,t,n,r){var i=this;[{name:"index",val:n+" + 1"},{name:"index0",val:n},{name:"revindex",val:r+" - "+n},{name:"revindex0",val:r+" - "+n+" - 1"},{name:"first",val:n+" === 0"},{name:"last",val:n+" === "+r+" - 1"},{name:"length",val:r}].forEach((function(e){i._emitLine('frame.set("loop.'+e.name+'", '+e.val+");")}))},o.compileFor=function(e,t){var n=this,r=this._tmpid(),i=this._tmpid(),o=this._tmpid();if(t=t.push(),this._emitLine("frame = frame.push();"),this._emit("var "+o+" = "),this._compileExpression(e.arr,t),this._emitLine(";"),this._emit("if("+o+") {"),this._emitLine(o+" = runtime.fromIterator("+o+");"),e.name instanceof s.Array){this._emitLine("var "+r+";"),this._emitLine("if(runtime.isArray("+o+")) {"),this._emitLine("var "+i+" = "+o+".length;"),this._emitLine("for("+r+"=0; "+r+" < "+o+".length; "+r+"++) {"),e.name.children.forEach((function(i,s){var a=n._tmpid();n._emitLine("var "+a+" = "+o+"["+r+"]["+s+"];"),n._emitLine('frame.set("'+i+'", '+o+"["+r+"]["+s+"]);"),t.set(e.name.children[s].value,a)})),this._emitLoopBindings(e,o,r,i),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}"),this._emitLine("} else {");var a=e.name.children,l=a[0],c=a[1],u=this._tmpid(),f=this._tmpid();t.set(l.value,u),t.set(c.value,f),this._emitLine(r+" = -1;"),this._emitLine("var "+i+" = runtime.keys("+o+").length;"),this._emitLine("for(var "+u+" in "+o+") {"),this._emitLine(r+"++;"),this._emitLine("var "+f+" = "+o+"["+u+"];"),this._emitLine('frame.set("'+l.value+'", '+u+");"),this._emitLine('frame.set("'+c.value+'", '+f+");"),this._emitLoopBindings(e,o,r,i),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}"),this._emitLine("}")}else{var p=this._tmpid();t.set(e.name.value,p),this._emitLine("var "+i+" = "+o+".length;"),this._emitLine("for(var "+r+"=0; "+r+" < "+o+".length; "+r+"++) {"),this._emitLine("var "+p+" = "+o+"["+r+"];"),this._emitLine('frame.set("'+e.name.value+'", '+p+");"),this._emitLoopBindings(e,o,r,i),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}")}this._emitLine("}"),e.else_&&(this._emitLine("if (!"+i+") {"),this.compile(e.else_,t),this._emitLine("}")),this._emitLine("frame = frame.pop();")},o._compileAsyncLoop=function(e,t,n){var r=this,i=this._tmpid(),o=this._tmpid(),a=this._tmpid(),l=n?"asyncAll":"asyncEach";if(t=t.push(),this._emitLine("frame = frame.push();"),this._emit("var "+a+" = runtime.fromIterator("),this._compileExpression(e.arr,t),this._emitLine(");"),e.name instanceof s.Array){var c=e.name.children.length;this._emit("runtime."+l+"("+a+", "+c+", function("),e.name.children.forEach((function(e){r._emit(e.value+",")})),this._emit(i+","+o+",next) {"),e.name.children.forEach((function(e){var n=e.value;t.set(n,n),r._emitLine('frame.set("'+n+'", '+n+");")}))}else{var u=e.name.value;this._emitLine("runtime."+l+"("+a+", 1, function("+u+", "+i+", "+o+",next) {"),this._emitLine('frame.set("'+u+'", '+u+");"),t.set(u,u)}this._emitLoopBindings(e,a,i,o),this._withScopedSyntax((function(){var o;n&&(o=r._pushBuffer()),r.compile(e.body,t),r._emitLine("next("+i+(o?","+o:"")+");"),n&&r._popBuffer()}));var f=this._tmpid();this._emitLine("}, "+this._makeCallback(f)),this._addScopeLevel(),n&&this._emitLine(this.buffer+" += "+f+";"),e.else_&&(this._emitLine("if (!"+a+".length) {"),this.compile(e.else_,t),this._emitLine("}")),this._emitLine("frame = frame.pop();")},o.compileAsyncEach=function(e,t){this._compileAsyncLoop(e,t)},o.compileAsyncAll=function(e,t){this._compileAsyncLoop(e,t,!0)},o._compileMacro=function(e,t){var n=this,r=[],i=null,o="macro_"+this._tmpid(),a=void 0!==t;e.args.children.forEach((function(t,o){o===e.args.children.length-1&&t instanceof s.Dict?i=t:(n.assertType(t,s.Symbol),r.push(t))}));var c,u=[].concat(r.map((function(e){return"l_"+e.value})),["kwargs"]),f=r.map((function(e){return'"'+e.value+'"'})),p=(i&&i.children||[]).map((function(e){return'"'+e.key.value+'"'}));c=a?t.push(!0):new l,this._emitLines("var "+o+" = runtime.makeMacro(","["+f.join(", ")+"], ","["+p.join(", ")+"], ","function ("+u.join(", ")+") {","var callerFrame = frame;","frame = "+(a?"frame.push(true);":"new runtime.Frame();"),"kwargs = kwargs || {};",'if (Object.prototype.hasOwnProperty.call(kwargs, "caller")) {','frame.set("caller", kwargs.caller); }'),r.forEach((function(e){n._emitLine('frame.set("'+e.value+'", l_'+e.value+");"),c.set(e.value,"l_"+e.value)})),i&&i.children.forEach((function(e){var t=e.key.value;n._emit('frame.set("'+t+'", '),n._emit('Object.prototype.hasOwnProperty.call(kwargs, "'+t+'")'),n._emit(' ? kwargs["'+t+'"] : '),n._compileExpression(e.value,c),n._emit(");")}));var h=this._pushBuffer();return this._withScopedSyntax((function(){n.compile(e.body,c)})),this._emitLine("frame = "+(a?"frame.pop();":"callerFrame;")),this._emitLine("return new runtime.SafeString("+h+");"),this._emitLine("});"),this._popBuffer(),o},o.compileMacro=function(e,t){var n=this._compileMacro(e),r=e.name.value;t.set(r,n),t.parent?this._emitLine('frame.set("'+r+'", '+n+");"):("_"!==e.name.value.charAt(0)&&this._emitLine('context.addExport("'+r+'");'),this._emitLine('context.setVariable("'+r+'", '+n+");"))},o.compileCaller=function(e,t){this._emit("(function (){");var n=this._compileMacro(e,t);this._emit("return "+n+";})()")},o._compileGetTemplate=function(e,t,n,r){var i=this._tmpid(),o=this._templateName(),s=this._makeCallback(i),a=n?"true":"false",l=r?"true":"false";return this._emit("env.getTemplate("),this._compileExpression(e.template,t),this._emitLine(", "+a+", "+o+", "+l+", "+s),i},o.compileImport=function(e,t){var n=e.target.value,r=this._compileGetTemplate(e,t,!1,!1);this._addScopeLevel(),this._emitLine(r+".getExported("+(e.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(r)),this._addScopeLevel(),t.set(n,r),t.parent?this._emitLine('frame.set("'+n+'", '+r+");"):this._emitLine('context.setVariable("'+n+'", '+r+");")},o.compileFromImport=function(e,t){var n=this,r=this._compileGetTemplate(e,t,!1,!1);this._addScopeLevel(),this._emitLine(r+".getExported("+(e.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(r)),this._addScopeLevel(),e.names.children.forEach((function(e){var i,o,a=n._tmpid();e instanceof s.Pair?(i=e.key.value,o=e.value.value):o=i=e.value,n._emitLine("if(Object.prototype.hasOwnProperty.call("+r+', "'+i+'")) {'),n._emitLine("var "+a+" = "+r+"."+i+";"),n._emitLine("} else {"),n._emitLine("cb(new Error(\"cannot import '"+i+"'\")); return;"),n._emitLine("}"),t.set(o,a),t.parent?n._emitLine('frame.set("'+o+'", '+a+");"):n._emitLine('context.setVariable("'+o+'", '+a+");")}))},o.compileBlock=function(e){var t=this._tmpid();this.inBlock||this._emit('(parentTemplate ? function(e, c, f, r, cb) { cb(""); } : '),this._emit('context.getBlock("'+e.name.value+'")'),this.inBlock||this._emit(")"),this._emitLine("(env, context, frame, runtime, "+this._makeCallback(t)),this._emitLine(this.buffer+" += "+t+";"),this._addScopeLevel()},o.compileSuper=function(e,t){var n=e.blockName.value,r=e.symbol.value,i=this._makeCallback(r);this._emitLine('context.getSuper(env, "'+n+'", b_'+n+", frame, runtime, "+i),this._emitLine(r+" = runtime.markSafe("+r+");"),this._addScopeLevel(),t.set(r,r)},o.compileExtends=function(e,t){var n=this._tmpid(),r=this._compileGetTemplate(e,t,!0,!1);this._emitLine("parentTemplate = "+r),this._emitLine("for(var "+n+" in parentTemplate.blocks) {"),this._emitLine("context.addBlock("+n+", parentTemplate.blocks["+n+"]);"),this._emitLine("}"),this._addScopeLevel()},o.compileInclude=function(e,t){this._emitLine("var tasks = [];"),this._emitLine("tasks.push("),this._emitLine("function(callback) {");var n=this._compileGetTemplate(e,t,!1,e.ignoreMissing);this._emitLine("callback(null,"+n+");});"),this._emitLine("});");var r=this._tmpid();this._emitLine("tasks.push("),this._emitLine("function(template, callback){"),this._emitLine("template.render(context.getVariables(), frame, "+this._makeCallback(r)),this._emitLine("callback(null,"+r+");});"),this._emitLine("});"),this._emitLine("tasks.push("),this._emitLine("function(result, callback){"),this._emitLine(this.buffer+" += result;"),this._emitLine("callback(null);"),this._emitLine("});"),this._emitLine("env.waterfall(tasks, function(){"),this._addScopeLevel()},o.compileTemplateData=function(e,t){this.compileLiteral(e,t)},o.compileCapture=function(e,t){var n=this,r=this.buffer;this.buffer="output",this._emitLine("(function() {"),this._emitLine('var output = "";'),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("return output;"),this._emitLine("})()"),this.buffer=r},o.compileOutput=function(e,t){var n=this;e.children.forEach((function(r){r instanceof s.TemplateData?r.value&&(n._emit(n.buffer+" += "),n.compileLiteral(r,t),n._emitLine(";")):(n._emit(n.buffer+" += runtime.suppressValue("),n.throwOnUndefined&&n._emit("runtime.ensureDefined("),n.compile(r,t),n.throwOnUndefined&&n._emit(","+e.lineno+","+e.colno+")"),n._emit(", env.opts.autoescape);\n"))}))},o.compileRoot=function(e,t){var n=this;t&&this.fail("compileRoot: root node can't have frame"),t=new l,this._emitFuncBegin(e,"root"),this._emitLine("var parentTemplate = null;"),this._compileChildren(e,t),this._emitLine("if(parentTemplate) {"),this._emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this._emitLine("} else {"),this._emitLine("cb(null, "+this.buffer+");"),this._emitLine("}"),this._emitFuncEnd(!0),this.inBlock=!0;var r=[],i=e.findAll(s.Block);i.forEach((function(e,t){var i=e.name.value;if(-1!==r.indexOf(i))throw new Error('Block "'+i+'" defined more than once.');r.push(i),n._emitFuncBegin(e,"b_"+i);var o=new l;n._emitLine("var frame = frame.push(true);"),n.compile(e.body,o),n._emitFuncEnd()})),this._emitLine("return {"),i.forEach((function(e,t){var r="b_"+e.name.value;n._emitLine(r+": "+r+",")})),this._emitLine("root: root\n};")},o.compile=function(e,t){var n=this["compile"+e.typename];n?n.call(this,e,t):this.fail("compile: Cannot compile node: "+e.typename,e.lineno,e.colno)},o.getCode=function(){return this.codebuf.join("")},i}(c);e.exports={compile:function(e,t,n,r,s){void 0===s&&(s={});var a=new f(r,s.throwOnUndefined),l=(n||[]).map((function(e){return e.preprocess})).filter((function(e){return!!e})).reduce((function(e,t){return t(e)}),e);return a.compile(o.transform(i.parse(l,n,s),t,r)),a.getCode()},Compiler:f}},function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}var i=n(4),o=n(1).EmitterObj;e.exports=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var s=o.prototype;return s.resolve=function(e,t){return i.resolve(i.dirname(e),t)},s.isRelative=function(e){return 0===e.indexOf("./")||0===e.indexOf("../")},o}(o)},function(e,t,n){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}var o=n(12),s=n(15),a=n(0),l=n(5),c=n(18),u=n(10),f=u.FileSystemLoader,p=u.WebLoader,h=u.PrecompiledLoader,d=n(20),m=n(21),y=n(1),g=y.Obj,v=y.EmitterObj,b=n(2),w=b.handleError,_=b.Frame,k=n(22);function x(e,t,n){o((function(){e(t,n)}))}var O={type:"code",obj:{root:function(e,t,n,r,i){try{i(null,"")}catch(e){i(w(e,null,null))}}}},S=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(e,t){var n=this;t=this.opts=t||{},this.opts.dev=!!t.dev,this.opts.autoescape=null==t.autoescape||t.autoescape,this.opts.throwOnUndefined=!!t.throwOnUndefined,this.opts.trimBlocks=!!t.trimBlocks,this.opts.lstripBlocks=!!t.lstripBlocks,this.loaders=[],e?this.loaders=a.isArray(e)?e:[e]:f?this.loaders=[new f("views")]:p&&(this.loaders=[new p("/views")]),"undefined"!=typeof window&&window.nunjucksPrecompiled&&this.loaders.unshift(new h(window.nunjucksPrecompiled)),this._initLoaders(),this.globals=m(),this.filters={},this.tests={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],a._entries(c).forEach((function(e){var t=e[0],r=e[1];return n.addFilter(t,r)})),a._entries(d).forEach((function(e){var t=e[0],r=e[1];return n.addTest(t,r)}))},n._initLoaders=function(){var e=this;this.loaders.forEach((function(t){t.cache={},"function"==typeof t.on&&(t.on("update",(function(n,r){t.cache[n]=null,e.emit("update",n,r,t)})),t.on("load",(function(n,r){e.emit("load",n,r,t)})))}))},n.invalidateCache=function(){this.loaders.forEach((function(e){e.cache={}}))},n.addExtension=function(e,t){return t.__name=e,this.extensions[e]=t,this.extensionsList.push(t),this},n.removeExtension=function(e){var t=this.getExtension(e);t&&(this.extensionsList=a.without(this.extensionsList,t),delete this.extensions[e])},n.getExtension=function(e){return this.extensions[e]},n.hasExtension=function(e){return!!this.extensions[e]},n.addGlobal=function(e,t){return this.globals[e]=t,this},n.getGlobal=function(e){if(void 0===this.globals[e])throw new Error("global not found: "+e);return this.globals[e]},n.addFilter=function(e,t,n){var r=t;return n&&this.asyncFilters.push(e),this.filters[e]=r,this},n.getFilter=function(e){if(!this.filters[e])throw new Error("filter not found: "+e);return this.filters[e]},n.addTest=function(e,t){return this.tests[e]=t,this},n.getTest=function(e){if(!this.tests[e])throw new Error("test not found: "+e);return this.tests[e]},n.resolveTemplate=function(e,t,n){return e.isRelative&&t&&e.isRelative(n)&&e.resolve?e.resolve(t,n):n},n.getTemplate=function(e,t,n,r,i){var o,s=this,l=this,c=null;if(e&&e.raw&&(e=e.raw),a.isFunction(n)&&(i=n,n=null,t=t||!1),a.isFunction(t)&&(i=t,t=!1),e instanceof A)c=e;else{if("string"!=typeof e)throw new Error("template names must be a string: "+e);for(var u=0;u<this.loaders.length;u++){var f=this.loaders[u];if(c=f.cache[this.resolveTemplate(f,n,e)])break}}return c?(t&&c.compile(),i?void i(null,c):c):(a.asyncIter(this.loaders,(function(t,r,i,o){function s(e,n){e?o(e):n?(n.loader=t,o(null,n)):i()}e=l.resolveTemplate(t,n,e),t.async?t.getSource(e,s):s(null,t.getSource(e))}),(function(n,a){if(a||n||r||(n=new Error("template not found: "+e)),n){if(i)return void i(n);throw n}var l;a?(l=new A(a.src,s,a.path,t),a.noCache||(a.loader.cache[e]=l)):l=new A(O,s,"",t),i?i(null,l):o=l})),o)},n.express=function(e){return k(this,e)},n.render=function(e,t,n){a.isFunction(t)&&(n=t,t=null);var r=null;return this.getTemplate(e,(function(e,i){if(e&&n)x(n,e);else{if(e)throw e;r=i.render(t,n)}})),r},n.renderString=function(e,t,n,r){return a.isFunction(n)&&(r=n,n={}),new A(e,this,(n=n||{}).path).render(t,r)},n.waterfall=function(e,t,n){return s(e,t,n)},t}(v),E=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(e,t,n){var r=this;this.env=n||new S,this.ctx=a.extend({},e),this.blocks={},this.exported=[],a.keys(t).forEach((function(e){r.addBlock(e,t[e])}))},n.lookup=function(e){return e in this.env.globals&&!(e in this.ctx)?this.env.globals[e]:this.ctx[e]},n.setVariable=function(e,t){this.ctx[e]=t},n.getVariables=function(){return this.ctx},n.addBlock=function(e,t){return this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t),this},n.getBlock=function(e){if(!this.blocks[e])throw new Error('unknown block "'+e+'"');return this.blocks[e][0]},n.getSuper=function(e,t,n,r,i,o){var s=a.indexOf(this.blocks[t]||[],n),l=this.blocks[t][s+1];if(-1===s||!l)throw new Error('no super block available for "'+t+'"');l(e,this,r,i,o)},n.addExport=function(e){this.exported.push(e)},n.getExported=function(){var e=this,t={};return this.exported.forEach((function(n){t[n]=e.ctx[n]})),t},t}(g),A=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(e,t,n,r){if(this.env=t||new S,a.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj;break;default:throw new Error("Unexpected template object type "+e.type+"; expected 'code', or 'string'")}else{if(!a.isString(e))throw new Error("src must be a string or an object describing the source");this.tmplStr=e}if(this.path=n,r)try{this._compile()}catch(e){throw a._prettifyError(this.path,this.env.opts.dev,e)}else this.compiled=!1},n.render=function(e,t,n){var r=this;"function"==typeof e?(n=e,e={}):"function"==typeof t&&(n=t,t=null);var i=!t;try{this.compile()}catch(e){var o=a._prettifyError(this.path,this.env.opts.dev,e);if(n)return x(n,o);throw o}var s=new E(e||{},this.blocks,this.env),l=t?t.push(!0):new _;l.topLevel=!0;var c=null,u=!1;return this.rootRenderFunc(this.env,s,l,b,(function(e,t){if(!u||!n||void 0===t)if(e&&(e=a._prettifyError(r.path,r.env.opts.dev,e),u=!0),n)i?x(n,e,t):n(e,t);else{if(e)throw e;c=t}})),c},n.getExported=function(e,t,n){"function"==typeof e&&(n=e,e={}),"function"==typeof t&&(n=t,t=null);try{this.compile()}catch(e){if(n)return n(e);throw e}var r=t?t.push():new _;r.topLevel=!0;var i=new E(e||{},this.blocks,this.env);this.rootRenderFunc(this.env,i,r,b,(function(e){e?n(e,null):n(null,i.getExported())}))},n.compile=function(){this.compiled||this._compile()},n._compile=function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=l.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts);e=new Function(t)()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},n._getBlocks=function(e){var t={};return a.keys(e).forEach((function(n){"b_"===n.slice(0,2)&&(t[n.slice(2)]=e[n])})),t},t}(g);e.exports={Environment:S,Template:A}},function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}var i=n(9),o=n(3),s=n(1).Obj,a=n(0),l=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var l=s.prototype;return l.init=function(e){this.tokens=e,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},l.nextToken=function(e){var t;if(this.peeked){if(e||this.peeked.type!==i.TOKEN_WHITESPACE)return t=this.peeked,this.peeked=null,t;this.peeked=null}if(t=this.tokens.nextToken(),!e)for(;t&&t.type===i.TOKEN_WHITESPACE;)t=this.tokens.nextToken();return t},l.peekToken=function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},l.pushToken=function(e){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=e},l.error=function(e,t,n){if(void 0===t||void 0===n){var r=this.peekToken()||{};t=r.lineno,n=r.colno}return void 0!==t&&(t+=1),void 0!==n&&(n+=1),new a.TemplateError(e,t,n)},l.fail=function(e,t,n){throw this.error(e,t,n)},l.skip=function(e){var t=this.nextToken();return!(!t||t.type!==e)||(this.pushToken(t),!1)},l.expect=function(e){var t=this.nextToken();return t.type!==e&&this.fail("expected "+e+", got "+t.type,t.lineno,t.colno),t},l.skipValue=function(e,t){var n=this.nextToken();return!(!n||n.type!==e||n.value!==t)||(this.pushToken(n),!1)},l.skipSymbol=function(e){return this.skipValue(i.TOKEN_SYMBOL,e)},l.advanceAfterBlockEnd=function(e){var t;return e||((t=this.peekToken())||this.fail("unexpected end of file"),t.type!==i.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),e=this.nextToken().value),(t=this.nextToken())&&t.type===i.TOKEN_BLOCK_END?"-"===t.value.charAt(0)&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+e+" statement"),t},l.advanceAfterVariableEnd=function(){var e=this.nextToken();e&&e.type===i.TOKEN_VARIABLE_END?this.dropLeadingWhitespace="-"===e.value.charAt(e.value.length-this.tokens.tags.VARIABLE_END.length-1):(this.pushToken(e),this.fail("expected variable end"))},l.parseFor=function(){var e,t,n=this.peekToken();if(this.skipSymbol("for")?(e=new o.For(n.lineno,n.colno),t="endfor"):this.skipSymbol("asyncEach")?(e=new o.AsyncEach(n.lineno,n.colno),t="endeach"):this.skipSymbol("asyncAll")?(e=new o.AsyncAll(n.lineno,n.colno),t="endall"):this.fail("parseFor: expected for{Async}",n.lineno,n.colno),e.name=this.parsePrimary(),e.name instanceof o.Symbol||this.fail("parseFor: variable name expected for loop"),this.peekToken().type===i.TOKEN_COMMA){var r=e.name;for(e.name=new o.Array(r.lineno,r.colno),e.name.addChild(r);this.skip(i.TOKEN_COMMA);){var s=this.parsePrimary();e.name.addChild(s)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',n.lineno,n.colno),e.arr=this.parseExpression(),this.advanceAfterBlockEnd(n.value),e.body=this.parseUntilBlocks(t,"else"),this.skipSymbol("else")&&(this.advanceAfterBlockEnd("else"),e.else_=this.parseUntilBlocks(t)),this.advanceAfterBlockEnd(),e},l.parseMacro=function(){var e=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var t=this.parsePrimary(!0),n=this.parseSignature(),r=new o.Macro(e.lineno,e.colno,t,n);return this.advanceAfterBlockEnd(e.value),r.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),r},l.parseCall=function(){var e=this.peekToken();this.skipSymbol("call")||this.fail("expected call");var t=this.parseSignature(!0)||new o.NodeList,n=this.parsePrimary();this.advanceAfterBlockEnd(e.value);var r=this.parseUntilBlocks("endcall");this.advanceAfterBlockEnd();var i=new o.Symbol(e.lineno,e.colno,"caller"),s=new o.Caller(e.lineno,e.colno,i,t,r),a=n.args.children;return a[a.length-1]instanceof o.KeywordArgs||a.push(new o.KeywordArgs),a[a.length-1].addChild(new o.Pair(e.lineno,e.colno,i,s)),new o.Output(e.lineno,e.colno,[n])},l.parseWithContext=function(){var e=this.peekToken(),t=null;return this.skipSymbol("with")?t=!0:this.skipSymbol("without")&&(t=!1),null!==t&&(this.skipSymbol("context")||this.fail("parseFrom: expected context after with/without",e.lineno,e.colno)),t},l.parseImport=function(){var e=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",e.lineno,e.colno);var t=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',e.lineno,e.colno);var n=this.parseExpression(),r=this.parseWithContext(),i=new o.Import(e.lineno,e.colno,t,n,r);return this.advanceAfterBlockEnd(e.value),i},l.parseFrom=function(){var e=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var t=this.parseExpression();this.skipSymbol("import")||this.fail("parseFrom: expected import",e.lineno,e.colno);for(var n,r=new o.NodeList;;){var s=this.peekToken();if(s.type===i.TOKEN_BLOCK_END){r.children.length||this.fail("parseFrom: Expected at least one import name",e.lineno,e.colno),"-"===s.value.charAt(0)&&(this.dropLeadingWhitespace=!0),this.nextToken();break}r.children.length>0&&!this.skip(i.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",e.lineno,e.colno);var a=this.parsePrimary();if("_"===a.value.charAt(0)&&this.fail("parseFrom: names starting with an underscore cannot be imported",a.lineno,a.colno),this.skipSymbol("as")){var l=this.parsePrimary();r.addChild(new o.Pair(a.lineno,a.colno,a,l))}else r.addChild(a);n=this.parseWithContext()}return new o.FromImport(e.lineno,e.colno,t,r,n)},l.parseBlock=function(){var e=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",e.lineno,e.colno);var t=new o.Block(e.lineno,e.colno);t.name=this.parsePrimary(),t.name instanceof o.Symbol||this.fail("parseBlock: variable name expected",e.lineno,e.colno),this.advanceAfterBlockEnd(e.value),t.body=this.parseUntilBlocks("endblock"),this.skipSymbol("endblock"),this.skipSymbol(t.name.value);var n=this.peekToken();return n||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(n.value),t},l.parseExtends=function(){var e="extends",t=this.peekToken();this.skipSymbol(e)||this.fail("parseTemplateRef: expected "+e);var n=new o.Extends(t.lineno,t.colno);return n.template=this.parseExpression(),this.advanceAfterBlockEnd(t.value),n},l.parseInclude=function(){var e="include",t=this.peekToken();this.skipSymbol(e)||this.fail("parseInclude: expected "+e);var n=new o.Include(t.lineno,t.colno);return n.template=this.parseExpression(),this.skipSymbol("ignore")&&this.skipSymbol("missing")&&(n.ignoreMissing=!0),this.advanceAfterBlockEnd(t.value),n},l.parseIf=function(){var e,t=this.peekToken();this.skipSymbol("if")||this.skipSymbol("elif")||this.skipSymbol("elseif")?e=new o.If(t.lineno,t.colno):this.skipSymbol("ifAsync")?e=new o.IfAsync(t.lineno,t.colno):this.fail("parseIf: expected if, elif, or elseif",t.lineno,t.colno),e.cond=this.parseExpression(),this.advanceAfterBlockEnd(t.value),e.body=this.parseUntilBlocks("elif","elseif","else","endif");var n=this.peekToken();switch(n&&n.value){case"elseif":case"elif":e.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),e.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":e.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected elif, else, or endif, got end of file")}return e},l.parseSet=function(){var e=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",e.lineno,e.colno);for(var t,n=new o.Set(e.lineno,e.colno,[]);(t=this.parsePrimary())&&(n.targets.push(t),this.skip(i.TOKEN_COMMA)););return this.skipValue(i.TOKEN_OPERATOR,"=")?(n.value=this.parseExpression(),this.advanceAfterBlockEnd(e.value)):this.skip(i.TOKEN_BLOCK_END)?(n.body=new o.Capture(e.lineno,e.colno,this.parseUntilBlocks("endset")),n.value=null,this.advanceAfterBlockEnd()):this.fail("parseSet: expected = or block end in set tag",e.lineno,e.colno),n},l.parseSwitch=function(){var e="switch",t="endswitch",n="case",r="default",i=this.peekToken();this.skipSymbol(e)||this.skipSymbol(n)||this.skipSymbol(r)||this.fail('parseSwitch: expected "switch," "case" or "default"',i.lineno,i.colno);var s=this.parseExpression();this.advanceAfterBlockEnd(e),this.parseUntilBlocks(n,r,t);var a,l=this.peekToken(),c=[];do{this.skipSymbol(n);var u=this.parseExpression();this.advanceAfterBlockEnd(e);var f=this.parseUntilBlocks(n,r,t);c.push(new o.Case(l.line,l.col,u,f)),l=this.peekToken()}while(l&&l.value===n);switch(l.value){case r:this.advanceAfterBlockEnd(),a=this.parseUntilBlocks(t),this.advanceAfterBlockEnd();break;case t:this.advanceAfterBlockEnd();break;default:this.fail('parseSwitch: expected "case," "default" or "endswitch," got EOF.')}return new o.Switch(i.lineno,i.colno,s,c,a)},l.parseStatement=function(){var e=this.peekToken();if(e.type!==i.TOKEN_SYMBOL&&this.fail("tag name expected",e.lineno,e.colno),this.breakOnBlocks&&-1!==a.indexOf(this.breakOnBlocks,e.value))return null;switch(e.value){case"raw":return this.parseRaw();case"verbatim":return this.parseRaw("verbatim");case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"call":return this.parseCall();case"import":return this.parseImport();case"from":return this.parseFrom();case"filter":return this.parseFilterStatement();case"switch":return this.parseSwitch();default:if(this.extensions.length)for(var t=0;t<this.extensions.length;t++){var n=this.extensions[t];if(-1!==a.indexOf(n.tags||[],e.value))return n.parse(this,o,i)}this.fail("unknown block tag: "+e.value,e.lineno,e.colno)}},l.parseRaw=function(e){for(var t="end"+(e=e||"raw"),n=new RegExp("([\\s\\S]*?){%\\s*("+e+"|"+t+")\\s*(?=%})%}"),r=1,i="",s=null,a=this.advanceAfterBlockEnd();(s=this.tokens._extractRegex(n))&&r>0;){var l=s[0],c=s[1],u=s[2];u===e?r+=1:u===t&&(r-=1),0===r?(i+=c,this.tokens.backN(l.length-c.length)):i+=l}return new o.Output(a.lineno,a.colno,[new o.TemplateData(a.lineno,a.colno,i)])},l.parsePostfix=function(e){for(var t,n=this.peekToken();n;){if(n.type===i.TOKEN_LEFT_PAREN)e=new o.FunCall(n.lineno,n.colno,e,this.parseSignature());else if(n.type===i.TOKEN_LEFT_BRACKET)(t=this.parseAggregate()).children.length>1&&this.fail("invalid index"),e=new o.LookupVal(n.lineno,n.colno,e,t.children[0]);else{if(n.type!==i.TOKEN_OPERATOR||"."!==n.value)break;this.nextToken();var r=this.nextToken();r.type!==i.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+r.value,r.lineno,r.colno),t=new o.Literal(r.lineno,r.colno,r.value),e=new o.LookupVal(n.lineno,n.colno,e,t)}n=this.peekToken()}return e},l.parseExpression=function(){return this.parseInlineIf()},l.parseInlineIf=function(){var e=this.parseOr();if(this.skipSymbol("if")){var t=this.parseOr(),n=e;(e=new o.InlineIf(e.lineno,e.colno)).body=n,e.cond=t,this.skipSymbol("else")?e.else_=this.parseOr():e.else_=null}return e},l.parseOr=function(){for(var e=this.parseAnd();this.skipSymbol("or");){var t=this.parseAnd();e=new o.Or(e.lineno,e.colno,e,t)}return e},l.parseAnd=function(){for(var e=this.parseNot();this.skipSymbol("and");){var t=this.parseNot();e=new o.And(e.lineno,e.colno,e,t)}return e},l.parseNot=function(){var e=this.peekToken();return this.skipSymbol("not")?new o.Not(e.lineno,e.colno,this.parseNot()):this.parseIn()},l.parseIn=function(){for(var e=this.parseIs();;){var t=this.nextToken();if(!t)break;var n=t.type===i.TOKEN_SYMBOL&&"not"===t.value;if(n||this.pushToken(t),!this.skipSymbol("in")){n&&this.pushToken(t);break}var r=this.parseIs();e=new o.In(e.lineno,e.colno,e,r),n&&(e=new o.Not(e.lineno,e.colno,e))}return e},l.parseIs=function(){var e=this.parseCompare();if(this.skipSymbol("is")){var t=this.skipSymbol("not"),n=this.parseCompare();e=new o.Is(e.lineno,e.colno,e,n),t&&(e=new o.Not(e.lineno,e.colno,e))}return e},l.parseCompare=function(){for(var e=["==","===","!=","!==","<",">","<=",">="],t=this.parseConcat(),n=[];;){var r=this.nextToken();if(!r)break;if(-1===e.indexOf(r.value)){this.pushToken(r);break}n.push(new o.CompareOperand(r.lineno,r.colno,this.parseConcat(),r.value))}return n.length?new o.Compare(n[0].lineno,n[0].colno,t,n):t},l.parseConcat=function(){for(var e=this.parseAdd();this.skipValue(i.TOKEN_TILDE,"~");){var t=this.parseAdd();e=new o.Concat(e.lineno,e.colno,e,t)}return e},l.parseAdd=function(){for(var e=this.parseSub();this.skipValue(i.TOKEN_OPERATOR,"+");){var t=this.parseSub();e=new o.Add(e.lineno,e.colno,e,t)}return e},l.parseSub=function(){for(var e=this.parseMul();this.skipValue(i.TOKEN_OPERATOR,"-");){var t=this.parseMul();e=new o.Sub(e.lineno,e.colno,e,t)}return e},l.parseMul=function(){for(var e=this.parseDiv();this.skipValue(i.TOKEN_OPERATOR,"*");){var t=this.parseDiv();e=new o.Mul(e.lineno,e.colno,e,t)}return e},l.parseDiv=function(){for(var e=this.parseFloorDiv();this.skipValue(i.TOKEN_OPERATOR,"/");){var t=this.parseFloorDiv();e=new o.Div(e.lineno,e.colno,e,t)}return e},l.parseFloorDiv=function(){for(var e=this.parseMod();this.skipValue(i.TOKEN_OPERATOR,"//");){var t=this.parseMod();e=new o.FloorDiv(e.lineno,e.colno,e,t)}return e},l.parseMod=function(){for(var e=this.parsePow();this.skipValue(i.TOKEN_OPERATOR,"%");){var t=this.parsePow();e=new o.Mod(e.lineno,e.colno,e,t)}return e},l.parsePow=function(){for(var e=this.parseUnary();this.skipValue(i.TOKEN_OPERATOR,"**");){var t=this.parseUnary();e=new o.Pow(e.lineno,e.colno,e,t)}return e},l.parseUnary=function(e){var t,n=this.peekToken();return t=this.skipValue(i.TOKEN_OPERATOR,"-")?new o.Neg(n.lineno,n.colno,this.parseUnary(!0)):this.skipValue(i.TOKEN_OPERATOR,"+")?new o.Pos(n.lineno,n.colno,this.parseUnary(!0)):this.parsePrimary(),e||(t=this.parseFilter(t)),t},l.parsePrimary=function(e){var t,n=this.nextToken(),r=null;if(n?n.type===i.TOKEN_STRING?t=n.value:n.type===i.TOKEN_INT?t=parseInt(n.value,10):n.type===i.TOKEN_FLOAT?t=parseFloat(n.value):n.type===i.TOKEN_BOOLEAN?"true"===n.value?t=!0:"false"===n.value?t=!1:this.fail("invalid boolean: "+n.value,n.lineno,n.colno):n.type===i.TOKEN_NONE?t=null:n.type===i.TOKEN_REGEX&&(t=new RegExp(n.value.body,n.value.flags)):this.fail("expected expression, got end of file"),void 0!==t?r=new o.Literal(n.lineno,n.colno,t):n.type===i.TOKEN_SYMBOL?r=new o.Symbol(n.lineno,n.colno,n.value):(this.pushToken(n),r=this.parseAggregate()),e||(r=this.parsePostfix(r)),r)return r;throw this.error("unexpected token: "+n.value,n.lineno,n.colno)},l.parseFilterName=function(){for(var e=this.expect(i.TOKEN_SYMBOL),t=e.value;this.skipValue(i.TOKEN_OPERATOR,".");)t+="."+this.expect(i.TOKEN_SYMBOL).value;return new o.Symbol(e.lineno,e.colno,t)},l.parseFilterArgs=function(e){return this.peekToken().type===i.TOKEN_LEFT_PAREN?this.parsePostfix(e).args.children:[]},l.parseFilter=function(e){for(;this.skip(i.TOKEN_PIPE);){var t=this.parseFilterName();e=new o.Filter(t.lineno,t.colno,t,new o.NodeList(t.lineno,t.colno,[e].concat(this.parseFilterArgs(e))))}return e},l.parseFilterStatement=function(){var e=this.peekToken();this.skipSymbol("filter")||this.fail("parseFilterStatement: expected filter");var t=this.parseFilterName(),n=this.parseFilterArgs(t);this.advanceAfterBlockEnd(e.value);var r=new o.Capture(t.lineno,t.colno,this.parseUntilBlocks("endfilter"));this.advanceAfterBlockEnd();var i=new o.Filter(t.lineno,t.colno,t,new o.NodeList(t.lineno,t.colno,[r].concat(n)));return new o.Output(t.lineno,t.colno,[i])},l.parseAggregate=function(){var e,t=this.nextToken();switch(t.type){case i.TOKEN_LEFT_PAREN:e=new o.Group(t.lineno,t.colno);break;case i.TOKEN_LEFT_BRACKET:e=new o.Array(t.lineno,t.colno);break;case i.TOKEN_LEFT_CURLY:e=new o.Dict(t.lineno,t.colno);break;default:return null}for(;;){var n=this.peekToken().type;if(n===i.TOKEN_RIGHT_PAREN||n===i.TOKEN_RIGHT_BRACKET||n===i.TOKEN_RIGHT_CURLY){this.nextToken();break}if(e.children.length>0&&(this.skip(i.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",t.lineno,t.colno)),e instanceof o.Dict){var r=this.parsePrimary();this.skip(i.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",t.lineno,t.colno);var s=this.parseExpression();e.addChild(new o.Pair(r.lineno,r.colno,r,s))}else{var a=this.parseExpression();e.addChild(a)}}return e},l.parseSignature=function(e,t){var n=this.peekToken();if(!t&&n.type!==i.TOKEN_LEFT_PAREN){if(e)return null;this.fail("expected arguments",n.lineno,n.colno)}n.type===i.TOKEN_LEFT_PAREN&&(n=this.nextToken());for(var r=new o.NodeList(n.lineno,n.colno),s=new o.KeywordArgs(n.lineno,n.colno),a=!1;;){if(n=this.peekToken(),!t&&n.type===i.TOKEN_RIGHT_PAREN){this.nextToken();break}if(t&&n.type===i.TOKEN_BLOCK_END)break;if(a&&!this.skip(i.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",n.lineno,n.colno);else{var l=this.parseExpression();this.skipValue(i.TOKEN_OPERATOR,"=")?s.addChild(new o.Pair(l.lineno,l.colno,l,this.parseExpression())):r.addChild(l)}a=!0}return s.children.length&&r.addChild(s),r},l.parseUntilBlocks=function(){for(var e=this.breakOnBlocks,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.breakOnBlocks=n;var i=this.parse();return this.breakOnBlocks=e,i},l.parseNodes=function(){for(var e,t=[];e=this.nextToken();)if(e.type===i.TOKEN_DATA){var n=e.value,r=this.peekToken(),s=r&&r.value;this.dropLeadingWhitespace&&(n=n.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),r&&(r.type===i.TOKEN_BLOCK_START&&"-"===s.charAt(s.length-1)||r.type===i.TOKEN_VARIABLE_START&&"-"===s.charAt(this.tokens.tags.VARIABLE_START.length)||r.type===i.TOKEN_COMMENT&&"-"===s.charAt(this.tokens.tags.COMMENT_START.length))&&(n=n.replace(/\s*$/,"")),t.push(new o.Output(e.lineno,e.colno,[new o.TemplateData(e.lineno,e.colno,n)]))}else if(e.type===i.TOKEN_BLOCK_START){this.dropLeadingWhitespace=!1;var a=this.parseStatement();if(!a)break;t.push(a)}else if(e.type===i.TOKEN_VARIABLE_START){var l=this.parseExpression();this.dropLeadingWhitespace=!1,this.advanceAfterVariableEnd(),t.push(new o.Output(e.lineno,e.colno,[l]))}else e.type===i.TOKEN_COMMENT?this.dropLeadingWhitespace="-"===e.value.charAt(e.value.length-this.tokens.tags.COMMENT_END.length-1):this.fail("Unexpected token at top-level: "+e.type,e.lineno,e.colno);return t},l.parse=function(){return new o.NodeList(0,0,this.parseNodes())},l.parseAsRoot=function(){return new o.Root(0,0,this.parseNodes())},s}(s);e.exports={parse:function(e,t,n){var r=new l(i.lex(e,n));return void 0!==t&&(r.extensions=t),r.parseAsRoot()},Parser:l}},function(e,t,n){"use strict";var r=n(0),i=" \n\t\r ",o="()[]{}%*-+~/#,:|.<>=!",s="string",a="whitespace",l="data",c="block-start",u="block-end",f="variable-start",p="variable-end",h="comment",d="left-paren",m="right-paren",y="left-bracket",g="right-bracket",v="left-curly",b="right-curly",w="operator",_="comma",k="colon",x="tilde",O="pipe",S="float",E="boolean",A="none",T="symbol",C="regex";function N(e,t,n,r){return{type:e,value:t,lineno:n,colno:r}}var L=function(){function e(e,t){this.str=e,this.index=0,this.len=e.length,this.lineno=0,this.colno=0,this.in_code=!1;var n=(t=t||{}).tags||{};this.tags={BLOCK_START:n.blockStart||"{%",BLOCK_END:n.blockEnd||"%}",VARIABLE_START:n.variableStart||"{{",VARIABLE_END:n.variableEnd||"}}",COMMENT_START:n.commentStart||"{#",COMMENT_END:n.commentEnd||"#}"},this.trimBlocks=!!t.trimBlocks,this.lstripBlocks=!!t.lstripBlocks}var t=e.prototype;return t.nextToken=function(){var e,t=this.lineno,n=this.colno;if(this.in_code){var L=this.current();if(this.isFinished())return null;if('"'===L||"'"===L)return N(s,this._parseString(L),t,n);if(e=this._extract(i))return N(a,e,t,n);if((e=this._extractString(this.tags.BLOCK_END))||(e=this._extractString("-"+this.tags.BLOCK_END)))return this.in_code=!1,this.trimBlocks&&("\n"===(L=this.current())?this.forward():"\r"===L&&(this.forward(),"\n"===(L=this.current())?this.forward():this.back())),N(u,e,t,n);if((e=this._extractString(this.tags.VARIABLE_END))||(e=this._extractString("-"+this.tags.VARIABLE_END)))return this.in_code=!1,N(p,e,t,n);if("r"===L&&"/"===this.str.charAt(this.index+1)){this.forwardN(2);for(var j="";!this.isFinished();){if("/"===this.current()&&"\\"!==this.previous()){this.forward();break}j+=this.current(),this.forward()}for(var P=["g","i","m","y"],I="";!this.isFinished()&&-1!==P.indexOf(this.current());)I+=this.current(),this.forward();return N(C,{body:j,flags:I},t,n)}if(-1!==o.indexOf(L)){this.forward();var M,R=["==","===","!=","!==","<=",">=","//","**"],B=L+this.current();switch(-1!==r.indexOf(R,B)&&(this.forward(),L=B,-1!==r.indexOf(R,B+this.current())&&(L=B+this.current(),this.forward())),L){case"(":M=d;break;case")":M=m;break;case"[":M=y;break;case"]":M=g;break;case"{":M=v;break;case"}":M=b;break;case",":M=_;break;case":":M=k;break;case"~":M=x;break;case"|":M=O;break;default:M=w}return N(M,L,t,n)}if((e=this._extractUntil(i+o)).match(/^[-+]?[0-9]+$/)){if("."===this.current()){this.forward();var D=this._extract("0123456789");return N(S,e+"."+D,t,n)}return N("int",e,t,n)}if(e.match(/^(true|false)$/))return N(E,e,t,n);if("none"===e)return N(A,e,t,n);if("null"===e)return N(A,e,t,n);if(e)return N(T,e,t,n);throw new Error("Unexpected value while parsing: "+e)}var F,$=this.tags.BLOCK_START.charAt(0)+this.tags.VARIABLE_START.charAt(0)+this.tags.COMMENT_START.charAt(0)+this.tags.COMMENT_END.charAt(0);if(this.isFinished())return null;if((e=this._extractString(this.tags.BLOCK_START+"-"))||(e=this._extractString(this.tags.BLOCK_START)))return this.in_code=!0,N(c,e,t,n);if((e=this._extractString(this.tags.VARIABLE_START+"-"))||(e=this._extractString(this.tags.VARIABLE_START)))return this.in_code=!0,N(f,e,t,n);e="";var K=!1;for(this._matches(this.tags.COMMENT_START)&&(K=!0,e=this._extractString(this.tags.COMMENT_START));null!==(F=this._extractUntil($));){if(e+=F,(this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))&&!K){if(this.lstripBlocks&&this._matches(this.tags.BLOCK_START)&&this.colno>0&&this.colno<=e.length){var V=e.slice(-this.colno);if(/^\s+$/.test(V)&&!(e=e.slice(0,-this.colno)).length)return this.nextToken()}break}if(this._matches(this.tags.COMMENT_END)){if(!K)throw new Error("unexpected end of comment");e+=this._extractString(this.tags.COMMENT_END);break}e+=this.current(),this.forward()}if(null===F&&K)throw new Error("expected end of comment, got end of file");return N(K?h:l,e,t,n)},t._parseString=function(e){this.forward();for(var t="";!this.isFinished()&&this.current()!==e;){var n=this.current();if("\\"===n){switch(this.forward(),this.current()){case"n":t+="\n";break;case"t":t+="\t";break;case"r":t+="\r";break;default:t+=this.current()}this.forward()}else t+=n,this.forward()}return this.forward(),t},t._matches=function(e){return this.index+e.length>this.len?null:this.str.slice(this.index,this.index+e.length)===e},t._extractString=function(e){return this._matches(e)?(this.forwardN(e.length),e):null},t._extractUntil=function(e){return this._extractMatching(!0,e||"")},t._extract=function(e){return this._extractMatching(!1,e)},t._extractMatching=function(e,t){if(this.isFinished())return null;var n=t.indexOf(this.current());if(e&&-1===n||!e&&-1!==n){var r=this.current();this.forward();for(var i=t.indexOf(this.current());(e&&-1===i||!e&&-1!==i)&&!this.isFinished();)r+=this.current(),this.forward(),i=t.indexOf(this.current());return r}return""},t._extractRegex=function(e){var t=this.currentStr().match(e);return t?(this.forwardN(t[0].length),t):null},t.isFinished=function(){return this.index>=this.len},t.forwardN=function(e){for(var t=0;t<e;t++)this.forward()},t.forward=function(){this.index++,"\n"===this.previous()?(this.lineno++,this.colno=0):this.colno++},t.backN=function(e){for(var t=0;t<e;t++)this.back()},t.back=function(){if(this.index--,"\n"===this.current()){this.lineno--;var e=this.src.lastIndexOf("\n",this.index-1);this.colno=-1===e?this.index:this.index-e}else this.colno--},t.current=function(){return this.isFinished()?"":this.str.charAt(this.index)},t.currentStr=function(){return this.isFinished()?"":this.str.substr(this.index)},t.previous=function(){return this.str.charAt(this.index-1)},e}();e.exports={lex:function(e,t){return new L(e,t)},TOKEN_STRING:s,TOKEN_WHITESPACE:a,TOKEN_DATA:l,TOKEN_BLOCK_START:c,TOKEN_BLOCK_END:u,TOKEN_VARIABLE_START:f,TOKEN_VARIABLE_END:p,TOKEN_COMMENT:h,TOKEN_LEFT_PAREN:d,TOKEN_RIGHT_PAREN:m,TOKEN_LEFT_BRACKET:y,TOKEN_RIGHT_BRACKET:g,TOKEN_LEFT_CURLY:v,TOKEN_RIGHT_CURLY:b,TOKEN_OPERATOR:w,TOKEN_COMMA:_,TOKEN_COLON:k,TOKEN_TILDE:x,TOKEN_PIPE:O,TOKEN_INT:"int",TOKEN_FLOAT:S,TOKEN_BOOLEAN:E,TOKEN_NONE:A,TOKEN_SYMBOL:T,TOKEN_SPECIAL:"special",TOKEN_REGEX:C}},function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}var i=n(6),o=n(19).PrecompiledLoader,s=function(e){var t,n;function i(t,n){var r;return(r=e.call(this)||this).baseURL=t||".",n=n||{},r.useCache=!!n.useCache,r.async=!!n.async,r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var o=i.prototype;return o.resolve=function(e,t){throw new Error("relative templates not support in the browser yet")},o.getSource=function(e,t){var n,r=this,i=this.useCache;return this.fetch(this.baseURL+"/"+e,(function(o,s){if(o)if(t)t(o.content);else{if(404!==o.status)throw o.content;n=null}else n={src:s,path:e,noCache:!i},r.emit("load",e,n),t&&t(null,n)})),n},o.fetch=function(e,t){if("undefined"==typeof window)throw new Error("WebLoader can only by used in a browser");var n=new XMLHttpRequest,r=!0;n.onreadystatechange=function(){4===n.readyState&&r&&(r=!1,0===n.status||200===n.status?t(null,n.responseText):t({status:n.status,content:n.responseText}))},e+=(-1===e.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),n.open("GET",e,this.async),n.send()},i}(i);e.exports={WebLoader:s,PrecompiledLoader:o}},function(e,t,n){"use strict";var r,i=n(0),o=n(7),s=o.Environment,a=o.Template,l=n(6),c=n(10),u=n(23),f=n(5),p=n(8),h=n(9),d=n(2),m=n(3),y=n(25);function g(e,t){var n;return t=t||{},i.isObject(e)&&(t=e,e=null),c.FileSystemLoader?n=new c.FileSystemLoader(e,{watch:t.watch,noCache:t.noCache}):c.WebLoader&&(n=new c.WebLoader(e,{useCache:t.web&&t.web.useCache,async:t.web&&t.web.async})),r=new s(n,t),t&&t.express&&r.express(t.express),r}e.exports={Environment:s,Template:a,Loader:l,FileSystemLoader:c.FileSystemLoader,NodeResolveLoader:c.NodeResolveLoader,PrecompiledLoader:c.PrecompiledLoader,WebLoader:c.WebLoader,compiler:f,parser:p,lexer:h,runtime:d,lib:i,nodes:m,installJinjaCompat:y,configure:g,reset:function(){r=void 0},compile:function(e,t,n,i){return r||g(),new a(e,t,n,i)},render:function(e,t,n){return r||g(),r.render(e,t,n)},renderString:function(e,t,n){return r||g(),r.renderString(e,t,n)},precompile:u?u.precompile:void 0,precompileString:u?u.precompileString:void 0}},function(e,t,n){"use strict";var r=n(13),i=[],o=[],s=r.makeRequestCallFromTimer((function(){if(o.length)throw o.shift()}));function a(e){var t;(t=i.length?i.pop():new l).task=e,r(t)}function l(){this.task=null}e.exports=a,l.prototype.call=function(){try{this.task.call()}catch(e){a.onerror?a.onerror(e):(o.push(e),s())}finally{this.task=null,i[i.length]=this}}},function(e,t,n){"use strict";(function(t){function n(e){i.length||r(),i[i.length]=e}e.exports=n;var r,i=[],o=0;function s(){for(;o<i.length;){var e=o;if(o+=1,i[e].call(),o>1024){for(var t=0,n=i.length-o;t<n;t++)i[t]=i[t+o];i.length-=o,o=0}}i.length=0,o=0}var a,l,c,u=void 0!==t?t:self,f=u.MutationObserver||u.WebKitMutationObserver;function p(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof f?(a=1,l=new f(s),c=document.createTextNode(""),l.observe(c,{characterData:!0}),r=function(){a=-a,c.data=a}):r=p(s),n.requestFlush=r,n.makeRequestCallFromTimer=p}).call(t,n(14))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r;!function(n){"use strict";var i=function(){var e=Array.prototype.slice.call(arguments);"function"==typeof e[0]&&e[0].apply(null,e.splice(1))},o=function(e){"function"==typeof setImmediate?setImmediate(e):"undefined"!=typeof process&&process.nextTick?process.nextTick(e):setTimeout(e,0)},s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=function(e,t,n){var r=n?o:i;if(t=t||function(){},!s(e)){var a=new Error("First argument to waterfall must be an array of functions");return t(a)}if(!e.length)return t();var l=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),o=e.next();o?i.push(l(o)):i.push(t),r((function(){e.apply(null,i)}))}}};l(function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)}(e))()};void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,i),r(n)},e.once("error",o)),e.once(t,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var i,o,s,a;if(c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,a=l,console&&console.warn&&console.warn(a)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=y(l,c);for(n=0;n<c;++n)o(u[n],this,t)}return!0},a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,s;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";var r=n(3),i=n(0),o=0;function s(){return"hole_"+o++}function a(e,t){for(var n=null,r=0;r<e.length;r++){var i=t(e[r]);i!==e[r]&&(n||(n=e.slice()),n[r]=i)}return n||e}function l(e,t,n){if(!(e instanceof r.Node))return e;if(!n){var i=t(e);if(i&&i!==e)return i}if(e instanceof r.NodeList){var o=a(e.children,(function(e){return l(e,t,n)}));o!==e.children&&(e=new r[e.typename](e.lineno,e.colno,o))}else if(e instanceof r.CallExtension){var s=l(e.args,t,n),c=a(e.contentArgs,(function(e){return l(e,t,n)}));s===e.args&&c===e.contentArgs||(e=new r[e.typename](e.extName,e.prop,s,c))}else{var u=e.fields.map((function(t){return e[t]})),f=a(u,(function(e){return l(e,t,n)}));f!==u&&(e=new r[e.typename](e.lineno,e.colno),f.forEach((function(t,n){e[e.fields[n]]=t})))}return n&&t(e)||e}function c(e,t){return l(e,t,!0)}function u(e,t,n){var o=[],a=c(n?e[n]:e,(function(e){var n;return e instanceof r.Block?e:((e instanceof r.Filter&&-1!==i.indexOf(t,e.name.value)||e instanceof r.CallExtensionAsync)&&(n=new r.Symbol(e.lineno,e.colno,s()),o.push(new r.FilterAsync(e.lineno,e.colno,e.name,e.args,n))),n)}));return n?e[n]=a:e=a,o.length?(o.push(e),new r.NodeList(e.lineno,e.colno,o)):e}e.exports={transform:function(e,t){return function(e,t){return function(e){return c(e,(function(e){if(e instanceof r.If||e instanceof r.For){var t=!1;if(l(e,(function(e){if(e instanceof r.FilterAsync||e instanceof r.IfAsync||e instanceof r.AsyncEach||e instanceof r.AsyncAll||e instanceof r.CallExtensionAsync)return t=!0,e})),t){if(e instanceof r.If)return new r.IfAsync(e.lineno,e.colno,e.cond,e.body,e.else_);if(e instanceof r.For&&!(e instanceof r.AsyncAll))return new r.AsyncEach(e.lineno,e.colno,e.arr,e.name,e.body,e.else_)}}}))}(function(e){return l(e,(function(e){if(e instanceof r.Block){var t=!1,n=s();e.body=l(e.body,(function(e){if(e instanceof r.FunCall&&"super"===e.name.value)return t=!0,new r.Symbol(e.lineno,e.colno,n)})),t&&e.body.children.unshift(new r.Super(0,0,e.name,new r.Symbol(0,0,n)))}}))}(function(e,t){return c(e,(function(e){return e instanceof r.Output?u(e,t):e instanceof r.Set?u(e,t,"value"):e instanceof r.For?u(e,t,"arr"):e instanceof r.If?u(e,t,"cond"):e instanceof r.CallExtension?u(e,t,"args"):void 0}))}(e,t)))}(e,t||[])}}},function(e,t,n){"use strict";var r=n(0),i=n(2);function o(e,t){return null==e||!1===e?t:e}function s(e){return e!=e}function a(e){var t=(e=o(e,"")).toLowerCase();return i.copySafeness(e,t.charAt(0).toUpperCase()+t.slice(1))}function l(e){if(r.isString(e))return e.split("");if(r.isObject(e))return r._entries(e||{}).map((function(e){return{key:e[0],value:e[1]}}));if(r.isArray(e))return e;throw new r.TemplateError("list filter: type not iterable")}function c(e){return function(t,n,i){void 0===n&&(n="truthy");var o=this,s=o.env.getTest(n);return r.toArray(t).filter((function(t){return s.call(o,t,i)===e}))}}function u(e){return i.copySafeness(e,e.replace(/^\s*|\s*$/g,""))}(t=e.exports={}).abs=Math.abs,t.batch=function(e,t,n){var r,i=[],o=[];for(r=0;r<e.length;r++)r%t==0&&o.length&&(i.push(o),o=[]),o.push(e[r]);if(o.length){if(n)for(r=o.length;r<t;r++)o.push(n);i.push(o)}return i},t.capitalize=a,t.center=function(e,t){if(t=t||80,(e=o(e,"")).length>=t)return e;var n=t-e.length,s=r.repeat(" ",n/2-n%2),a=r.repeat(" ",n/2);return i.copySafeness(e,s+e+a)},t.default=function(e,t,n){return n?e||t:void 0!==e?e:t},t.dictsort=function(e,t,n){if(!r.isObject(e))throw new r.TemplateError("dictsort filter: val must be an object");var i,o=[];for(var s in e)o.push([s,e[s]]);if(void 0===n||"key"===n)i=0;else{if("value"!==n)throw new r.TemplateError("dictsort filter: You can only sort by either key or value");i=1}return o.sort((function(e,n){var o=e[i],s=n[i];return t||(r.isString(o)&&(o=o.toUpperCase()),r.isString(s)&&(s=s.toUpperCase())),o>s?1:o===s?0:-1})),o},t.dump=function(e,t){return JSON.stringify(e,null,t)},t.escape=function(e){return e instanceof i.SafeString?e:(e=null==e?"":e,i.markSafe(r.escape(e.toString())))},t.safe=function(e){return e instanceof i.SafeString?e:(e=null==e?"":e,i.markSafe(e.toString()))},t.first=function(e){return e[0]},t.forceescape=function(e){return e=null==e?"":e,i.markSafe(r.escape(e.toString()))},t.groupby=function(e,t){return r.groupBy(e,t,this.env.opts.throwOnUndefined)},t.indent=function(e,t,n){if(""===(e=o(e,"")))return"";t=t||4;var s=e.split("\n"),a=r.repeat(" ",t),l=s.map((function(e,t){return 0!==t||n?""+a+e:e})).join("\n");return i.copySafeness(e,l)},t.join=function(e,t,n){return t=t||"",n&&(e=r.map(e,(function(e){return e[n]}))),e.join(t)},t.last=function(e){return e[e.length-1]},t.length=function(e){var t=o(e,"");return void 0!==t?"function"==typeof Map&&t instanceof Map||"function"==typeof Set&&t instanceof Set?t.size:!r.isObject(t)||t instanceof i.SafeString?t.length:r.keys(t).length:0},t.list=l,t.lower=function(e){return(e=o(e,"")).toLowerCase()},t.nl2br=function(e){return null==e?"":i.copySafeness(e,e.replace(/\r\n|\n/g,"<br />\n"))},t.random=function(e){return e[Math.floor(Math.random()*e.length)]},t.reject=c(!1),t.rejectattr=function(e,t){return e.filter((function(e){return!e[t]}))},t.select=c(!0),t.selectattr=function(e,t){return e.filter((function(e){return!!e[t]}))},t.replace=function(e,t,n,r){var o=e;if(t instanceof RegExp)return e.replace(t,n);void 0===r&&(r=-1);var s="";if("number"==typeof t)t=""+t;else if("string"!=typeof t)return e;if("number"==typeof e&&(e=""+e),"string"!=typeof e&&!(e instanceof i.SafeString))return e;if(""===t)return s=n+e.split("").join(n)+n,i.copySafeness(e,s);var a=e.indexOf(t);if(0===r||-1===a)return e;for(var l=0,c=0;a>-1&&(-1===r||c<r);)s+=e.substring(l,a)+n,l=a+t.length,c++,a=e.indexOf(t,l);return l<e.length&&(s+=e.substring(l)),i.copySafeness(o,s)},t.reverse=function(e){var t;return(t=r.isString(e)?l(e):r.map(e,(function(e){return e}))).reverse(),r.isString(e)?i.copySafeness(e,t.join("")):t},t.round=function(e,t,n){t=t||0;var r=Math.pow(10,t);return("ceil"===n?Math.ceil:"floor"===n?Math.floor:Math.round)(e*r)/r},t.slice=function(e,t,n){for(var r=Math.floor(e.length/t),i=e.length%t,o=[],s=0,a=0;a<t;a++){var l=s+a*r;a<i&&s++;var c=s+(a+1)*r,u=e.slice(l,c);n&&a>=i&&u.push(n),o.push(u)}return o},t.sum=function(e,t,n){return void 0===n&&(n=0),t&&(e=r.map(e,(function(e){return e[t]}))),n+e.reduce((function(e,t){return e+t}),0)},t.sort=i.makeMacro(["value","reverse","case_sensitive","attribute"],[],(function(e,t,n,i){var o=this,s=r.map(e,(function(e){return e})),a=r.getAttrGetter(i);return s.sort((function(e,s){var l=i?a(e):e,c=i?a(s):s;if(o.env.opts.throwOnUndefined&&i&&(void 0===l||void 0===c))throw new TypeError('sort: attribute "'+i+'" resolved to undefined');return!n&&r.isString(l)&&r.isString(c)&&(l=l.toLowerCase(),c=c.toLowerCase()),l<c?t?1:-1:l>c?t?-1:1:0})),s})),t.string=function(e){return i.copySafeness(e,e)},t.striptags=function(e,t){var n,r=u((e=o(e,"")).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,""));return n=t?r.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,"\n").replace(/\n\n\n+/g,"\n\n"):r.replace(/\s+/gi," "),i.copySafeness(e,n)},t.title=function(e){var t=(e=o(e,"")).split(" ").map((function(e){return a(e)}));return i.copySafeness(e,t.join(" "))},t.trim=u,t.truncate=function(e,t,n,r){var s=e;if(t=t||255,(e=o(e,"")).length<=t)return e;if(n)e=e.substring(0,t);else{var a=e.lastIndexOf(" ",t);-1===a&&(a=t),e=e.substring(0,a)}return e+=null!=r?r:"...",i.copySafeness(s,e)},t.upper=function(e){return(e=o(e,"")).toUpperCase()},t.urlencode=function(e){var t=encodeURIComponent;return r.isString(e)?t(e):(r.isArray(e)?e:r._entries(e)).map((function(e){var n=e[0],r=e[1];return t(n)+"="+t(r)})).join("&")};var f=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,p=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,h=/^https?:\/\/.*$/,d=/^www\./,m=/\.(?:org|net|com)(?:\:|\/|$)/;t.urlize=function(e,t,n){s(t)&&(t=1/0);var r=!0===n?' rel="nofollow"':"";return e.split(/(\s+)/).filter((function(e){return e&&e.length})).map((function(e){var n=e.match(f),i=n?n[1]:e,o=i.substr(0,t);return h.test(i)?'<a href="'+i+'"'+r+">"+o+"</a>":d.test(i)?'<a href="http://'+i+'"'+r+">"+o+"</a>":p.test(i)?'<a href="mailto:'+i+'">'+i+"</a>":m.test(i)?'<a href="http://'+i+'"'+r+">"+o+"</a>":e})).join("")},t.wordcount=function(e){var t=(e=o(e,""))?e.match(/\w+/g):null;return t?t.length:null},t.float=function(e,t){var n=parseFloat(e);return s(n)?t:n};var y=i.makeMacro(["value","default","base"],[],(function(e,t,n){void 0===n&&(n=10);var r=parseInt(e,n);return s(r)?t:r}));t.int=y,t.d=t.default,t.e=t.escape},function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}var i=function(e){var t,n;function i(t){var n;return(n=e.call(this)||this).precompiled=t||{},n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n),i.prototype.getSource=function(e){return this.precompiled[e]?{src:{type:"code",obj:this.precompiled[e]},path:e}:null},i}(n(6));e.exports={PrecompiledLoader:i}},function(e,t,n){"use strict";var r=n(2).SafeString;t.callable=function(e){return"function"==typeof e},t.defined=function(e){return void 0!==e},t.divisibleby=function(e,t){return e%t==0},t.escaped=function(e){return e instanceof r},t.equalto=function(e,t){return e===t},t.eq=t.equalto,t.sameas=t.equalto,t.even=function(e){return e%2==0},t.falsy=function(e){return!e},t.ge=function(e,t){return e>=t},t.greaterthan=function(e,t){return e>t},t.gt=t.greaterthan,t.le=function(e,t){return e<=t},t.lessthan=function(e,t){return e<t},t.lt=t.lessthan,t.lower=function(e){return e.toLowerCase()===e},t.ne=function(e,t){return e!==t},t.null=function(e){return null===e},t.number=function(e){return"number"==typeof e},t.odd=function(e){return e%2==1},t.string=function(e){return"string"==typeof e},t.truthy=function(e){return!!e},t.undefined=function(e){return void 0===e},t.upper=function(e){return e.toUpperCase()===e},t.iterable=function(e){return"undefined"!=typeof Symbol?!!e[Symbol.iterator]:Array.isArray(e)||"string"==typeof e},t.mapping=function(e){var t=null!=e&&"object"==typeof e&&!Array.isArray(e);return Set?t&&!(e instanceof Set):t}},function(e,t,n){"use strict";function r(e){var t=-1;return{current:null,reset:function(){t=-1,this.current=null},next:function(){return++t>=e.length&&(t=0),this.current=e[t],this.current}}}e.exports=function(){return{range:function(e,t,n){void 0===t?(t=e,e=0,n=1):n||(n=1);var r=[];if(n>0)for(var i=e;i<t;i+=n)r.push(i);else for(var o=e;o>t;o+=n)r.push(o);return r},cycler:function(){return r(Array.prototype.slice.call(arguments))},joiner:function(e){return function(e){e=e||",";var t=!0;return function(){var n=t?"":e;return t=!1,n}}(e)}}}},function(e,t,n){var r=n(4);e.exports=function(e,t){function n(e,t){if(this.name=e,this.path=e,this.defaultEngine=t.defaultEngine,this.ext=r.extname(e),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}return n.prototype.render=function(t,n){e.render(this.name,t,n)},t.set("view",n),t.set("nunjucksEnv",e),e}},function(e,t,n){"use strict";var r=n(4),i=n(4),o=n(0)._prettifyError,s=n(5),a=n(7).Environment,l=n(24);function c(e,t){return!!Array.isArray(t)&&t.some((function(t){return e.match(t)}))}function u(e,t){(t=t||{}).isString=!0;var n=t.env||new a([]),r=t.wrapper||l;if(!t.name)throw new Error('the "name" option is required when compiling a string');return r([f(e,t.name,n)],t)}function f(e,t,n){var r,i=(n=n||new a([])).asyncFilters,l=n.extensionsList;t=t.replace(/\\/g,"/");try{r=s.compile(e,i,l,t,n.opts)}catch(e){throw o(t,!1,e)}return{name:t,template:r}}e.exports={precompile:function(e,t){var n=(t=t||{}).env||new a([]),o=t.wrapper||l;if(t.isString)return u(e,t);var s=r.existsSync(e)&&r.statSync(e),p=[],h=[];if(s.isFile())p.push(f(r.readFileSync(e,"utf-8"),t.name||e,n));else if(s.isDirectory()){!function n(o){r.readdirSync(o).forEach((function(s){var a=i.join(o,s),l=a.substr(i.join(e,"/").length),u=r.statSync(a);u&&u.isDirectory()?c(l+="/",t.exclude)||n(a):c(l,t.include)&&h.push(a)}))}(e);for(var d=0;d<h.length;d++){var m=h[d].replace(i.join(e,"/"),"");try{p.push(f(r.readFileSync(h[d],"utf-8"),m,n))}catch(e){if(!t.force)throw e;console.error(e)}}}return o(p,t)},precompileString:u}},function(e,t,n){"use strict";e.exports=function(e,t){var n="";t=t||{};for(var r=0;r<e.length;r++){var i=JSON.stringify(e[r].name);n+="(function() {(window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["+i+"] = (function() {\n"+e[r].template+"\n})();\n",t.asFunction&&(n+="return function(ctx, cb) { return nunjucks.render("+i+", ctx, cb); }\n"),n+="})();\n"}return n}},function(e,t,n){e.exports=function(){"use strict";var e,t,n=this.runtime,r=this.lib,i=this.compiler.Compiler,o=this.parser.Parser,s=this.nodes,a=this.lexer,l=n.contextOrFrameLookup,c=n.memberLookup;function u(e){return{index:e.index,lineno:e.lineno,colno:e.colno}}if(i&&(e=i.prototype.assertType),o&&(t=o.prototype.parseAggregate),n.contextOrFrameLookup=function(e,t,n){var r=l.apply(this,arguments);if(void 0!==r)return r;switch(n){case"True":return!0;case"False":return!1;case"None":return null;default:return}},s&&i&&o){var f=s.Node.extend("Slice",{fields:["start","stop","step"],init:function(e,t,n,r,i){n=n||new s.Literal(e,t,null),r=r||new s.Literal(e,t,null),i=i||new s.Literal(e,t,1),this.parent(e,t,n,r,i)}});i.prototype.assertType=function(t){t instanceof f||e.apply(this,arguments)},i.prototype.compileSlice=function(e,t){this._emit("("),this._compileExpression(e.start,t),this._emit("),("),this._compileExpression(e.stop,t),this._emit("),("),this._compileExpression(e.step,t),this._emit(")")},o.prototype.parseAggregate=function(){var e=this,n=u(this.tokens);n.colno--,n.index--;try{return t.apply(this)}catch(t){var i=u(this.tokens),o=function(){return r._assign(e.tokens,i),t};r._assign(this.tokens,n),this.peeked=!1;var l=this.peekToken();if(l.type!==a.TOKEN_LEFT_BRACKET)throw o();this.nextToken();for(var c=new f(l.lineno,l.colno),p=!1,h=0;h<=c.fields.length&&!this.skip(a.TOKEN_RIGHT_BRACKET);h++){if(h===c.fields.length){if(!p)break;this.fail("parseSlice: too many slice components",l.lineno,l.colno)}this.skip(a.TOKEN_COLON)?p=!0:(c[c.fields[h]]=this.parseExpression(),p=this.skip(a.TOKEN_COLON)||p)}if(!p)throw o();return new s.Array(l.lineno,l.colno,[c])}}}function p(e,t,r,i){e=e||[],null===t&&(t=i<0?e.length-1:0),null===r?r=i<0?-1:e.length:r<0&&(r+=e.length),t<0&&(t+=e.length);for(var o=[],s=t;!(s<0||s>e.length||i>0&&s>=r||i<0&&s<=r);s+=i)o.push(n.memberLookup(e,s));return o}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var d={pop:function(e){if(void 0===e)return this.pop();if(e>=this.length||e<0)throw new Error("KeyError");return this.splice(e,1)},append:function(e){return this.push(e)},remove:function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return this.splice(t,1);throw new Error("ValueError")},count:function(e){for(var t=0,n=0;n<this.length;n++)this[n]===e&&t++;return t},index:function(e){var t;if(-1===(t=this.indexOf(e)))throw new Error("ValueError");return t},find:function(e){return this.indexOf(e)},insert:function(e,t){return this.splice(e,0,t)}},m={items:function(){return r._entries(this)},values:function(){return r._values(this)},keys:function(){return r.keys(this)},get:function(e,t){var n=this[e];return void 0===n&&(n=t),n},has_key:function(e){return h(this,e)},pop:function(e,t){var n=this[e];if(void 0===n&&void 0!==t)n=t;else{if(void 0===n)throw new Error("KeyError");delete this[e]}return n},popitem:function(){var e=r.keys(this);if(!e.length)throw new Error("KeyError");var t=e[0],n=this[t];return delete this[t],[t,n]},setdefault:function(e,t){return void 0===t&&(t=null),e in this||(this[e]=t),this[e]},update:function(e){return r._assign(this,e),null}};return m.iteritems=m.items,m.itervalues=m.values,m.iterkeys=m.keys,n.memberLookup=function(e,t,n){return 4===arguments.length?p.apply(this,arguments):(e=e||{},r.isArray(e)&&h(d,t)?d[t].bind(e):r.isObject(e)&&h(m,t)?m[t].bind(e):c.apply(this,arguments))},function(){n.contextOrFrameLookup=l,n.memberLookup=c,i&&(i.prototype.assertType=e),o&&(o.prototype.parseAggregate=t)}}}])},e.exports=t()}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}};return e[t].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(i),r.d(i,{Component:()=>m,ComponentAttribute:()=>o,ComponentAttributeDefinition:()=>E,ComponentDefinition:()=>v,ComponentDrawOption:()=>T,ComponentLink:()=>I,ComponentLinkDefinition:()=>B,DefaultData:()=>co,DefaultDrawer:()=>qi,DefaultMetadata:()=>zi,DefaultParser:()=>Wi,DefaultPlugin:()=>ho,DefaultRender:()=>Ji,FileInformation:()=>l,FileInput:()=>q,ParseError:()=>oo});var n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,value:null,type:null,definition:null};t(this,n);var r=e.name,i=e.value,o=e.type,s=e.definition;this.name=r||null,this.value=null!=i?i:null,this.type=o||null,this.definition=s||null}var r,i;return r=n,i=[{key:"hasError",value:function(){return null===this.definition?null===this.value||("array"===this.type.toLowerCase()?!Array.isArray(this.value):e(this.value)!==this.type.toLowerCase()):this.__typeOfValueValidation()||this.__ruleValueValidation()||this.__ruleMinAndMaxValidation()||this.__ruleRegexValidation()}},{key:"__typeOfValueValidation",value:function(){var t=this.type.toLowerCase();return"array"===t?"Link"===this.definition.type?!Array.isArray(this.value)||this.value.some((function(e){return"string"!=typeof e})):!Array.isArray(this.value):"object"===t?"[object Object]"!==Object.prototype.toString.call(this.value):e(this.value)!==t}},{key:"__ruleValueValidation",value:function(){return this.definition.rules.values&&!this.definition.rules.values.includes(this.value)}},{key:"__ruleMinAndMaxValidation",value:function(){var e="number"==typeof this.value?this.value:this.value.length;return null!==this.definition.rules.min&&e<this.definition.rules.min||null!==this.definition.rules.max&&e>this.definition.rules.max}},{key:"__ruleRegexValidation",value:function(){return null!==this.definition.rules.regex&&!new RegExp(this.definition.rules.regex).test(this.value)}}],i&&function(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===e(o)?o:String(o)),i)}var o}(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),n}();const o=n;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}const l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:null};a(this,e);var n=t.path;this.path=n||null}var t,n;return t=e,(n=[{key:"fileName",get:function(){return this.path?this.path.replace(/^.*[\\/]/,""):null}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,e);var t,n,r,i,s=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(i){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null,name:null,definition:null,drawOption:null,attributes:[]};u(this,a),e=s.call(this,t);var n=t.id,r=t.name,i=t.definition,o=t.drawOption,l=t.attributes;return e.__class="Component",e.id=n||null,e.name=r||null,e.definition=i||null,e.drawOption=o||null,e.attributes=l||[],e}return t=a,n=[{key:"setReferenceAttribute",value:function(e){var t=this.definition.definedAttributes.find((function(t){return t.containerRef===e.definition.type}));if(t){var n=this.attributes.filter((function(e){var n=e.definition;return(null==n?void 0:n.name)===t.name}));n.length>0?n.forEach((function(t){t.value=e.id})):this.attributes.push(new o({name:t.name,value:e.id,type:"String",definition:t}))}}},{key:"removeAllReferenceAttributes",value:function(e){this.attributes=e?this.attributes.filter((function(t){var n=t.definition,r=t.value;return!("Reference"===n.type&&n.containerRef===e.definition.type&&r===e.id)})):this.attributes.filter((function(e){return"Reference"!==e.definition.type}))}},{key:"setLinkAttribute",value:function(e){var t=this.definition.definedAttributes.find((function(t){return t.name===e.definition.attributeRef})),n=this.attributes.find((function(e){var n=e.definition;return"Link"===n.type&&t.name===n.name}));n&&!n.value.includes(e.target)?n.value.push(e.target):n||this.attributes.push(new o({name:t.name,definition:t,type:"Array",value:[e.target]}))}},{key:"removeLinkAttribute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.attributes=this.attributes.filter((function(n){if(t&&n.name!==t)return!0;if(n.definition&&"Link"===n.definition.type){var r=n.value.findIndex((function(t){return t===e}));return r>=0&&n.value.splice(r,1),0!==n.value.length}return!0}))}},{key:"getAttributeByName",value:function(e){return this.__getAttributeByName(this.attributes,e)}},{key:"__getAttributeByName",value:function(e,t){for(var n=0;n<e.length;n+=1){if(e[n].name===t)return e[n];if("Object"===e[n].type){var r=this.__getAttributeByName(e[n].value,t);if(r)return r}}return null}},{key:"getContainerId",value:function(){var e=this.attributes.find((function(e){var t=e.definition;return t&&"Reference"===t.type}));return e?e.value:null}},{key:"hasError",value:function(){return this.checkRequiredAttributes()||this.checkAttributesErrors()}},{key:"checkRequiredAttributes",value:function(){var e=this;return this.definition.definedAttributes.filter((function(e){return e.required})).some((function(t){var n=e.getAttributeByName(t.name);return!n||null===n.value||void 0===n.value||"Array"===n.type&&0===n.value.length||"Object"===n.type&&0===Object.keys(n.value).length||"String"===n.type&&""===n.value.trim()}))}},{key:"checkAttributesErrors",value:function(){return this.attributes.some((function(e){return e.hasError()}))}},{key:"getDefinedAttributesByType",value:function(e){return this.definition.definedAttributes.filter((function(t){return t.type===e}))}}],n&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===c(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(l);const m=d;function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var g=function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:null,icon:null,model:null,displayName:null,description:null,url:null,parentTypes:[],childrenTypes:[],definedAttributes:[],isContainer:!1,displayType:null,preventChildrenMovement:!1,childrenPerLine:null};y(this,e);var n=t.type,r=t.icon,i=t.model,o=t.displayName,s=t.description,a=t.url,l=t.parentTypes,c=t.childrenTypes,u=t.definedAttributes,f=t.isContainer,p=t.displayType,h=t.preventChildrenMovement,d=t.childrenPerLine;this.type=n||null,this.icon=r||null,this.model=i||null,this.displayName=o||null,this.description=s||null,this.url=a||null,this.parentTypes=l||[],this.childrenTypes=c||[],this.definedAttributes=u||[],this.isContainer=void 0!==f&&f,this.displayType=p||null,this.preventChildrenMovement=null!=h&&h,this.childrenPerLine=null!=d?d:null}));const v=g;function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===b(t)?t:String(t)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var S=function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,type:null,displayName:null,description:null,url:null,linkType:null,linkRef:[],linkColor:"black",linkWidth:2,linkDashStyle:null,containerRef:null,required:!1,definedAttributes:[],rules:{values:null,min:null,max:null,regex:null}};O(this,e);var n=t.name,r=t.type,i=t.displayName,o=t.description,s=t.url,a=t.linkType,l=t.linkRef,c=t.linkColor,u=t.linkWidth,f=t.linkDashStyle,p=t.containerRef,h=t.definedAttributes,d=t.required,m=t.rules;this.name=n||null,this.type=r||null,this.displayName=i||null,this.description=o||null,this.url=s||null,this.linkType=a||null,this.linkRef=l||[],this.linkColor=c||"black",this.linkWidth=u||2,this.linkDashStyle=f||null,this.containerRef=p||null,this.definedAttributes=h||[],this.required=d||!1,this.rules=_({values:null,min:null,max:null,regex:null},m)}));const E=S;function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}const T=function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:null,y:null,width:null,height:null,needsResizing:!1,needsPositioning:!1};A(this,e);var n=t.x,r=t.y,i=t.width,o=t.height,s=t.needsResizing,a=t.needsPositioning;this.x=n||null,this.y=r||null,this.width=i||null,this.height=o||null,this.needsResizing=s||!1,this.needsPositioning=a||!1}));function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function j(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}const I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(n);if(r){var i=P(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return j(this,e)});function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{source:null,target:null,definition:null};N(this,o),e=i.call(this);var n=t.source,r=t.target,s=t.definition;return e.__class="Link",e.source=n||null,e.target=r||null,e.definition=s||null,e}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(l);function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var R=function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{attributeRef:null,sourceRef:null,targetRef:null,type:null,color:"black",width:2,dashStyle:null};M(this,e);var n=t.attributeRef,r=t.sourceRef,i=t.targetRef,o=t.type,s=t.color,a=t.width,l=t.dashStyle;this.attributeRef=n||null,this.sourceRef=r||null,this.targetRef=i||null,this.type=o||null,this.color=s||"black",this.width=a||2,this.dashStyle=l||null}));const B=R;function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function K(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}const q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=V(n);if(r){var i=V(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return K(this,e)});function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:null,name:null,content:null};F(this,o),e=i.call(this,t);var n=t.content;return e.content=n||null,e}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(l);class U extends Map{constructor(e,t=H){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(Y(this,e))}has(e){return super.has(Y(this,e))}set(e,t){return super.set(G(this,e),t)}delete(e){return super.delete(W(this,e))}}class z extends Set{constructor(e,t=H){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(Y(this,e))}add(e){return super.add(G(this,e))}delete(e){return super.delete(W(this,e))}}function Y({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function G({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function W({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function H(e){return null!==e&&"object"==typeof e?e.valueOf():e}function J(e){return e}function X(){}function Q(e){return null==e?X:function(){return this.querySelector(e)}}function Z(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function ee(){return[]}function te(e){return null==e?ee:function(){return this.querySelectorAll(e)}}function ne(e){return function(){return this.matches(e)}}function re(e){return function(t){return t.matches(e)}}var ie=Array.prototype.find;function oe(){return this.firstElementChild}var se=Array.prototype.filter;function ae(){return Array.from(this.children)}function le(e){return new Array(e.length)}function ce(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function ue(e){return function(){return e}}function fe(e,t,n,r,i,o){for(var s,a=0,l=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new ce(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function pe(e,t,n,r,i,o,s){var a,l,c,u=new Map,f=t.length,p=o.length,h=new Array(f);for(a=0;a<f;++a)(l=t[a])&&(h[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<p;++a)c=s.call(e,o[a],a,o)+"",(l=u.get(c))?(r[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new ce(e,o[a]);for(a=0;a<f;++a)(l=t[a])&&u.get(h[a])===l&&(i[a]=l)}function he(e){return e.__data__}function de(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function me(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}ce.prototype={constructor:ce,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var ye="http://www.w3.org/1999/xhtml";const ge={svg:"http://www.w3.org/2000/svg",xhtml:ye,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ve(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),ge.hasOwnProperty(t)?{space:ge[t],local:e}:e}function be(e){return function(){this.removeAttribute(e)}}function we(e){return function(){this.removeAttributeNS(e.space,e.local)}}function _e(e,t){return function(){this.setAttribute(e,t)}}function ke(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function xe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Oe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Se(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ee(e){return function(){this.style.removeProperty(e)}}function Ae(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Te(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ce(e,t){return e.style.getPropertyValue(t)||Se(e).getComputedStyle(e,null).getPropertyValue(t)}function Ne(e){return function(){delete this[e]}}function Le(e,t){return function(){this[e]=t}}function je(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Pe(e){return e.trim().split(/^|\s+/)}function Ie(e){return e.classList||new Me(e)}function Me(e){this._node=e,this._names=Pe(e.getAttribute("class")||"")}function Re(e,t){for(var n=Ie(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Be(e,t){for(var n=Ie(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function De(e){return function(){Re(this,e)}}function Fe(e){return function(){Be(this,e)}}function $e(e,t){return function(){(t.apply(this,arguments)?Re:Be)(this,e)}}function Ke(){this.textContent=""}function Ve(e){return function(){this.textContent=e}}function qe(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Ue(){this.innerHTML=""}function ze(e){return function(){this.innerHTML=e}}function Ye(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Ge(){this.nextSibling&&this.parentNode.appendChild(this)}function We(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function He(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ye&&t.documentElement.namespaceURI===ye?t.createElement(e):t.createElementNS(n,e)}}function Je(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Xe(e){var t=ve(e);return(t.local?Je:He)(t)}function Qe(){return null}function Ze(){var e=this.parentNode;e&&e.removeChild(this)}function et(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function nt(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function rt(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function it(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function ot(e,t,n){var r=Se(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function st(e,t){return function(){return ot(this,e,t)}}function at(e,t){return function(){return ot(this,e,t.apply(this,arguments))}}Me.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var lt=[null];function ct(e,t){this._groups=e,this._parents=t}function ut(){return new ct([[document.documentElement]],lt)}ct.prototype=ut.prototype={constructor:ct,select:function(e){"function"!=typeof e&&(e=Q(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=t[i],l=a.length,c=r[i]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=e.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new ct(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return Z(e.apply(this,arguments))}}(e):te(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s,a=t[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(e.call(s,s.__data__,c,a)),i.push(s));return new ct(r,i)},selectChild:function(e){return this.select(null==e?oe:function(e){return function(){return ie.call(this.children,e)}}("function"==typeof e?e:re(e)))},selectChildren:function(e){return this.selectAll(null==e?ae:function(e){return function(){return se.call(this.children,e)}}("function"==typeof e?e:re(e)))},filter:function(e){"function"!=typeof e&&(e=ne(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new ct(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,he);var n=t?pe:fe,r=this._parents,i=this._groups;"function"!=typeof e&&(e=ue(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],f=i[c],p=f.length,h=de(e.call(u,u&&u.__data__,c,r)),d=h.length,m=a[c]=new Array(d),y=s[c]=new Array(d),g=l[c]=new Array(p);n(u,f,m,y,g,h,t);for(var v,b,w=0,_=0;w<d;++w)if(v=m[w]){for(w>=_&&(_=w+1);!(b=y[_])&&++_<d;);v._next=b||null}}return(s=new ct(s,r))._enter=a,s._exit=l,s},enter:function(){return new ct(this._enter||this._groups.map(le),this._parents)},exit:function(){return new ct(this._exit||this._groups.map(le),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c,u=n[l],f=r[l],p=u.length,h=a[l]=new Array(p),d=0;d<p;++d)(c=u[d]||f[d])&&(h[d]=c);for(;l<i;++l)a[l]=n[l];return new ct(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=me);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new ct(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],s=0,a=o.length;s<a;++s)(i=o[s])&&e.call(i,i.__data__,s,o);return this},attr:function(e,t){var n=ve(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?we:be:"function"==typeof t?n.local?Oe:xe:n.local?ke:_e)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Ee:"function"==typeof t?Te:Ae)(e,t,null==n?"":n)):Ce(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Ne:"function"==typeof t?je:Le)(e,t)):this.node()[e]},classed:function(e,t){var n=Pe(e+"");if(arguments.length<2){for(var r=Ie(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?$e:t?De:Fe)(n,t))},text:function(e){return arguments.length?this.each(null==e?Ke:("function"==typeof e?qe:Ve)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Ue:("function"==typeof e?Ye:ze)(e)):this.node().innerHTML},raise:function(){return this.each(Ge)},lower:function(){return this.each(We)},append:function(e){var t="function"==typeof e?e:Xe(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:Xe(e),r=null==t?Qe:"function"==typeof t?t:Q(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ze)},clone:function(e){return this.select(e?tt:et)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=nt(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?it:rt,r=0;r<s;++r)this.each(a(o[r],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?at:st)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};const ft=ut;var pt={value:()=>{}};function ht(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new dt(r)}function dt(e){this._=e}function mt(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function yt(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function gt(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=pt,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}dt.prototype=ht.prototype={constructor:dt,on:function(e,t){var n,r=this._,i=mt(e+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=i[o]).type)r[n]=gt(r[n],e.name,t);else if(null==t)for(n in r)r[n]=gt(r[n],e.name,null);return this}for(;++o<s;)if((n=(e=i[o]).type)&&(n=yt(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new dt(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};const vt=ht;var bt,wt,_t=0,kt=0,xt=0,Ot=0,St=0,Et=0,At="object"==typeof performance&&performance.now?performance:Date,Tt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ct(){return St||(Tt(Nt),St=At.now()+Et)}function Nt(){St=0}function Lt(){this._call=this._time=this._next=null}function jt(e,t,n){var r=new Lt;return r.restart(e,t,n),r}function Pt(){St=(Ot=At.now())+Et,_t=kt=0;try{!function(){Ct(),++_t;for(var e,t=bt;t;)(e=St-t._time)>=0&&t._call.call(void 0,e),t=t._next;--_t}()}finally{_t=0,function(){for(var e,t,n=bt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:bt=t);wt=e,Mt(r)}(),St=0}}function It(){var e=At.now(),t=e-Ot;t>1e3&&(Et-=t,Ot=e)}function Mt(e){_t||(kt&&(kt=clearTimeout(kt)),e-St>24?(e<1/0&&(kt=setTimeout(Pt,e-At.now()-Et)),xt&&(xt=clearInterval(xt))):(xt||(Ot=At.now(),xt=setInterval(It,1e3)),_t=1,Tt(Pt)))}function Rt(e,t,n){var r=new Lt;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}Lt.prototype=jt.prototype={constructor:Lt,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Ct():+n)+(null==t?0:+t),this._next||wt===this||(wt?wt._next=this:bt=this,wt=this),this._call=e,this._time=n,Mt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mt())}};var Bt=vt("start","end","cancel","interrupt"),Dt=[];function Ft(e,t,n,r,i,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(l){var c,u,f,p;if(1!==n.state)return a();for(c in i)if((p=i[c]).name===n.name){if(3===p.state)return Rt(o);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete i[c]):+c<t&&(p.state=6,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete i[c])}if(Rt((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),c=0,u=-1;c<f;++c)(p=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=p);r.length=u+1}}function s(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=jt((function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:Bt,tween:Dt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function $t(e,t){var n=Vt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Kt(e,t){var n=Vt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Vt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function qt(e,t){var n,r,i,o=e.__transition,s=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete e.__transition}}function Ut(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var zt,Yt=180/Math.PI,Gt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Wt(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Yt,skewX:Math.atan(l)*Yt,scaleX:s,scaleY:a}}function Ht(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,r,i,o,s,a){if(e!==i||r!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:Ut(e,i)},{i:l-2,x:Ut(r,o)})}else(i||o)&&s.push("translate("+i+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Ut(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Ut(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,s.skewX,a,l),function(e,t,n,r,o,s){if(e!==n||t!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Ut(e,n)},{i:a-2,x:Ut(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,r=l.length;++n<r;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var Jt=Ht((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Gt:Wt(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Xt=Ht((function(e){return null==e?Gt:(zt||(zt=document.createElementNS("http://www.w3.org/2000/svg","g")),zt.setAttribute("transform",e),(e=zt.transform.baseVal.consolidate())?Wt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Gt)}),", ",")",")");function Qt(e,t){var n,r;return function(){var i=Kt(this,e),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}i.tween=r}}function Zt(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Kt(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function en(e,t,n){var r=e._id;return e.each((function(){var e=Kt(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Vt(e,r).value[t]}}function tn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function nn(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function rn(){}var on=.7,sn=1/on,an="\\s*([+-]?\\d+)\\s*",ln="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",un=/^#([0-9a-f]{3,8})$/,fn=new RegExp(`^rgb\\(${an},${an},${an}\\)$`),pn=new RegExp(`^rgb\\(${cn},${cn},${cn}\\)$`),hn=new RegExp(`^rgba\\(${an},${an},${an},${ln}\\)$`),dn=new RegExp(`^rgba\\(${cn},${cn},${cn},${ln}\\)$`),mn=new RegExp(`^hsl\\(${ln},${cn},${cn}\\)$`),yn=new RegExp(`^hsla\\(${ln},${cn},${cn},${ln}\\)$`),gn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function vn(){return this.rgb().formatHex()}function bn(){return this.rgb().formatRgb()}function wn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=un.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?_n(t):3===n?new Sn(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?kn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?kn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=fn.exec(e))?new Sn(t[1],t[2],t[3],1):(t=pn.exec(e))?new Sn(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=hn.exec(e))?kn(t[1],t[2],t[3],t[4]):(t=dn.exec(e))?kn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=mn.exec(e))?Ln(t[1],t[2]/100,t[3]/100,1):(t=yn.exec(e))?Ln(t[1],t[2]/100,t[3]/100,t[4]):gn.hasOwnProperty(e)?_n(gn[e]):"transparent"===e?new Sn(NaN,NaN,NaN,0):null}function _n(e){return new Sn(e>>16&255,e>>8&255,255&e,1)}function kn(e,t,n,r){return r<=0&&(e=t=n=NaN),new Sn(e,t,n,r)}function xn(e){return e instanceof rn||(e=wn(e)),e?new Sn((e=e.rgb()).r,e.g,e.b,e.opacity):new Sn}function On(e,t,n,r){return 1===arguments.length?xn(e):new Sn(e,t,n,null==r?1:r)}function Sn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function En(){return`#${Nn(this.r)}${Nn(this.g)}${Nn(this.b)}`}function An(){const e=Tn(this.opacity);return`${1===e?"rgb(":"rgba("}${Cn(this.r)}, ${Cn(this.g)}, ${Cn(this.b)}${1===e?")":`, ${e})`}`}function Tn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Cn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Nn(e){return((e=Cn(e))<16?"0":"")+e.toString(16)}function Ln(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Pn(e,t,n,r)}function jn(e){if(e instanceof Pn)return new Pn(e.h,e.s,e.l,e.opacity);if(e instanceof rn||(e=wn(e)),!e)return new Pn;if(e instanceof Pn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=t===o?(n-r)/a+6*(n<r):n===o?(r-t)/a+2:(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Pn(s,a,l,e.opacity)}function Pn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function In(e){return(e=(e||0)%360)<0?e+360:e}function Mn(e){return Math.max(0,Math.min(1,e||0))}function Rn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Bn(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}tn(rn,wn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:vn,formatHex:vn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return jn(this).formatHsl()},formatRgb:bn,toString:bn}),tn(Sn,On,nn(rn,{brighter(e){return e=null==e?sn:Math.pow(sn,e),new Sn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?on:Math.pow(on,e),new Sn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Sn(Cn(this.r),Cn(this.g),Cn(this.b),Tn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:En,formatHex:En,formatHex8:function(){return`#${Nn(this.r)}${Nn(this.g)}${Nn(this.b)}${Nn(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:An,toString:An})),tn(Pn,(function(e,t,n,r){return 1===arguments.length?jn(e):new Pn(e,t,n,null==r?1:r)}),nn(rn,{brighter(e){return e=null==e?sn:Math.pow(sn,e),new Pn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?on:Math.pow(on,e),new Pn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Sn(Rn(e>=240?e-240:e+120,i,r),Rn(e,i,r),Rn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Pn(In(this.h),Mn(this.s),Mn(this.l),Tn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Tn(this.opacity);return`${1===e?"hsl(":"hsla("}${In(this.h)}, ${100*Mn(this.s)}%, ${100*Mn(this.l)}%${1===e?")":`, ${e})`}`}}));const Dn=e=>()=>e;function Fn(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Dn(isNaN(e)?t:e)}const $n=function e(t){var n=function(e){return 1==(e=+e)?Fn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Dn(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=On(e)).r,(t=On(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),s=Fn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function Kn(e){return function(t){var n,r,i=t.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=On(t[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=e(o),s=e(s),a=e(a),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=a(e),r+""}}}Kn((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return Bn((n-r/t)*t,s,i,o,a)}})),Kn((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return Bn((n-r/t)*t,i,o,s,a)}}));var Vn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qn=new RegExp(Vn.source,"g");function Un(e,t){var n,r,i,o=Vn.lastIndex=qn.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=Vn.exec(e))&&(r=qn.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Ut(n,r)})),o=qn.lastIndex;return o<t.length&&(i=t.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function zn(e,t){var n;return("number"==typeof t?Ut:t instanceof wn?$n:(n=wn(t))?(t=n,$n):Un)(e,t)}function Yn(e){return function(){this.removeAttribute(e)}}function Gn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Wn(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Hn(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Jn(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttribute(e)}}function Xn(e,t,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,l));this.removeAttributeNS(e.space,e.local)}}function Qn(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Zn(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function er(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Zn(e,i)),n}return i._value=t,i}function tr(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Qn(e,i)),n}return i._value=t,i}function nr(e,t){return function(){$t(this,e).delay=+t.apply(this,arguments)}}function rr(e,t){return t=+t,function(){$t(this,e).delay=t}}function ir(e,t){return function(){Kt(this,e).duration=+t.apply(this,arguments)}}function or(e,t){return t=+t,function(){Kt(this,e).duration=t}}function sr(e,t){if("function"!=typeof t)throw new Error;return function(){Kt(this,e).ease=t}}function ar(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?$t:Kt;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}var lr=ft.prototype.constructor;function cr(e){return function(){this.style.removeProperty(e)}}function ur(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function fr(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&ur(e,o,n)),r}return o._value=t,o}function pr(e){return function(t){this.textContent=e.call(this,t)}}function hr(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&pr(r)),t}return r._value=e,r}var dr=0;function mr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function yr(){return++dr}var gr=ft.prototype;mr.prototype=function(e){return ft().transition(e)}.prototype={constructor:mr,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Q(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,c=r[s],u=c.length,f=o[s]=new Array(u),p=0;p<u;++p)(a=c[p])&&(l=e.call(a,a.__data__,p,c))&&("__data__"in a&&(l.__data__=a.__data__),f[p]=l,Ft(f[p],t,n,p,f,Vt(a,n)));return new mr(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=te(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,c=r[a],u=c.length,f=0;f<u;++f)if(l=c[f]){for(var p,h=e.call(l,l.__data__,f,c),d=Vt(l,n),m=0,y=h.length;m<y;++m)(p=h[m])&&Ft(p,t,n,m,h,d);o.push(h),s.push(l)}return new mr(o,s,t,n)},selectChild:gr.selectChild,selectChildren:gr.selectChildren,filter:function(e){"function"!=typeof e&&(e=ne(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new mr(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,c=t[a],u=n[a],f=c.length,p=s[a]=new Array(f),h=0;h<f;++h)(l=c[h]||u[h])&&(p[h]=l);for(;a<r;++a)s[a]=t[a];return new mr(s,this._parents,this._name,this._id)},selection:function(){return new lr(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=yr(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=Vt(s,t);Ft(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new mr(r,this._parents,e,n)},call:gr.call,nodes:gr.nodes,node:gr.node,size:gr.size,empty:gr.empty,each:gr.each,on:function(e,t){var n=this._id;return arguments.length<2?Vt(this.node(),n).on.on(e):this.each(ar(n,e,t))},attr:function(e,t){var n=ve(e),r="transform"===n?Xt:zn;return this.attrTween(e,"function"==typeof t?(n.local?Xn:Jn)(n,r,en(this,"attr."+e,t)):null==t?(n.local?Gn:Yn)(n):(n.local?Hn:Wn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=ve(e);return this.tween(n,(r.local?er:tr)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?Jt:zn;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=Ce(this,e),s=(this.style.removeProperty(e),Ce(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}(e,r)).on("end.style."+e,cr(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var s=Ce(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=Ce(this,e)),s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a))}}(e,r,en(this,"style."+e,t))).each(function(e,t){var n,r,i,o,s="style."+t,a="end."+s;return function(){var l=Kt(this,e),c=l.on,u=null==l.value[s]?o||(o=cr(t)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var s=Ce(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,fr(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(en(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,hr(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=Vt(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?Qt:Zt)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?nr:rr)(t,e)):Vt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?ir:or)(t,e)):Vt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(sr(t,e)):Vt(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;Kt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=Kt(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t})),0===i&&o()}))},[Symbol.iterator]:gr[Symbol.iterator]};var vr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function br(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}ft.prototype.interrupt=function(e){return this.each((function(){qt(this,e)}))},ft.prototype.transition=function(e){var t,n;e instanceof mr?(t=e._id,e=e._name):(t=yr(),(n=vr).time=Ct(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&Ft(s,e,t,c,a,n||br(s,t));return new mr(r,this._parents,e,t)};const{abs:wr,max:_r,min:kr}=Math;function xr(e){return{type:e}}function Or(e){return"string"==typeof e?new ct([[document.querySelector(e)]],[document.documentElement]):new ct([[e]],lt)}function Sr(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}["w","e"].map(xr),["n","s"].map(xr),["n","w","e","s","nw","ne","sw","se"].map(xr);const Er={passive:!1},Ar={capture:!0,passive:!1};function Tr(e){e.stopImmediatePropagation()}function Cr(e){e.preventDefault(),e.stopImmediatePropagation()}function Nr(e){var t=e.document.documentElement,n=Or(e).on("dragstart.drag",Cr,Ar);"onselectstart"in t?n.on("selectstart.drag",Cr,Ar):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Lr(e,t){var n=e.document.documentElement,r=Or(e).on("dragstart.drag",null);t&&(r.on("click.drag",Cr,Ar),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const jr=e=>()=>e;function Pr(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}function Ir(e){return!e.ctrlKey&&!e.button}function Mr(){return this.parentNode}function Rr(e,t){return null==t?{x:e.x,y:e.y}:t}function Br(){return navigator.maxTouchPoints||"ontouchstart"in this}function Dr(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function Fr(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=Kr)):void 0===t&&(t=$r);for(var n,r,i,o,s,a=new Ur(e),l=[a];n=l.pop();)if((i=t(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,o=s-1;o>=0;--o)l.push(r=i[o]=new Ur(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(qr)}function $r(e){return e.children}function Kr(e){return Array.isArray(e)?e[1]:null}function Vr(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function qr(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Ur(e){this.data=e,this.depth=this.height=0,this.parent=null}function zr(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Yr(e,t,n,r,i){for(var o,s=e.children,a=-1,l=s.length,c=e.value&&(r-t)/e.value;++a<l;)(o=s[a]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*c}function Gr(e,t,n,r,i){for(var o,s=e.children,a=-1,l=s.length,c=e.value&&(i-n)/e.value;++a<l;)(o=s[a]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*c}Pr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e},Ur.prototype=Fr.prototype={constructor:Ur,count:function(){return this.eachAfter(Dr)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,o=this,s=[o],a=[],l=-1;o=s.pop();)if(a.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);for(;o=a.pop();)e.call(t,o,++l,this);return this},eachBefore:function(e,t){for(var n,r,i=this,o=[i],s=-1;i=o.pop();)if(e.call(t,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return Fr(this).eachBefore(Vr)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,o=[i];do{for(e=o.reverse(),o=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n])}while(o.length)}};const Wr=function e(t){function n(e,n,r,i,o){!function(e,t,n,r,i,o){for(var s,a,l,c,u,f,p,h,d,m,y,g=[],v=t.children,b=0,w=0,_=v.length,k=t.value;b<_;){l=i-n,c=o-r;do{u=v[w++].value}while(!u&&w<_);for(f=p=u,y=u*u*(m=Math.max(c/l,l/c)/(k*e)),d=Math.max(p/y,y/f);w<_;++w){if(u+=a=v[w].value,a<f&&(f=a),a>p&&(p=a),y=u*u*m,(h=Math.max(p/y,y/f))>d){u-=a;break}d=h}g.push(s={value:u,dice:l<c,children:v.slice(b,w)}),s.dice?Yr(s,n,r,i,k?r+=c*u/k:o):Gr(s,n,r,k?n+=l*u/k:i,o),k-=u,b=w}}(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}((1+Math.sqrt(5))/2);function Hr(e){if("function"!=typeof e)throw new Error;return e}function Jr(){return 0}function Xr(e){return function(){return e}}function Qr(e){return"string"==typeof e?new ct([document.querySelectorAll(e)],[document.documentElement]):new ct([Z(e)],lt)}var Zr=Array.prototype.slice;function ei(e){return function(){return e}}const ti=Math.PI,ni=2*ti,ri=1e-6,ii=ni-ri;function oi(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class si{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?oi:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return oi;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,a=n-e,l=r-t,c=o-e,u=s-t,f=c*c+u*u;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(f>ri)if(Math.abs(u*a-l*c)>ri&&i){let p=n-o,h=r-s,d=a*a+l*l,m=p*p+h*h,y=Math.sqrt(d),g=Math.sqrt(f),v=i*Math.tan((ti-Math.acos((d+f-m)/(2*y*g)))/2),b=v/g,w=v/y;Math.abs(b-1)>ri&&this._append`L${e+b*c},${t+b*u}`,this._append`A${i},${i},0,0,${+(u*p>c*h)},${this._x1=e+w*a},${this._y1=t+w*l}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(r),a=n*Math.sin(r),l=e+s,c=t+a,u=1^o,f=o?r-i:i-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>ri||Math.abs(this._y1-c)>ri)&&this._append`L${l},${c}`,n&&(f<0&&(f=f%ni+ni),f>ii?this._append`A${n},${n},0,1,${u},${e-s},${t-a}A${n},${n},0,1,${u},${this._x1=l},${this._y1=c}`:f>ri&&this._append`A${n},${n},0,${+(f>=ti)},${u},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function ai(e){return e[0]}function li(e){return e[1]}function ci(e){return e.source}function ui(e){return e.target}class fi{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function pi(e){return new fi(e,!0)}function hi(e){return new fi(e,!1)}function di(e){return((e=Math.exp(e))+1/e)/2}const mi=function e(t,n,r){function i(e,i){var o,s,a=e[0],l=e[1],c=e[2],u=i[0],f=i[1],p=i[2],h=u-a,d=f-l,m=h*h+d*d;if(m<1e-12)s=Math.log(p/c)/t,o=function(e){return[a+e*h,l+e*d,c*Math.exp(t*e*s)]};else{var y=Math.sqrt(m),g=(p*p-c*c+r*m)/(2*c*n*y),v=(p*p-c*c-r*m)/(2*p*n*y),b=Math.log(Math.sqrt(g*g+1)-g),w=Math.log(Math.sqrt(v*v+1)-v);s=(w-b)/t,o=function(e){var r,i=e*s,o=di(b),u=c/(n*y)*(o*(r=t*i+b,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[a+u*h,l+u*d,c*o/di(t*i+b)]}}return o.duration=1e3*s*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4),yi=e=>()=>e;function gi(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function vi(e,t,n){this.k=e,this.x=t,this.y=n}vi.prototype={constructor:vi,scale:function(e){return 1===e?this:new vi(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new vi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bi=new vi(1,0,0);function wi(e){for(;!e.__zoom;)if(!(e=e.parentNode))return bi;return e.__zoom}function _i(e){e.stopImmediatePropagation()}function ki(e){e.preventDefault(),e.stopImmediatePropagation()}function xi(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function Oi(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Si(){return this.__zoom||bi}function Ei(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ai(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ti(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}wi.prototype=vi.prototype;var Ci=r(985),Ni=r.n(Ci);const Li='<svg viewBox="0 0 24 24"><path fill="black" d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" /></svg>';function ji(e){return ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ji(e)}function Pi(e){return function(e){if(Array.isArray(e))return Fi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Di(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){Ri(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ri(e,t,n){return(t=Ki(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||Di(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Di(e,t){if(e){if("string"==typeof e)return Fi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fi(e,t):void 0}}function Fi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ki(e){var t=function(e,t){if("object"!==ji(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ji(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ji(t)?t:String(t)}var Vi=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{SelectEvent:null,UpdateEvent:null},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"root",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};$i(this,e),this.pluginData=t,this.rootId=i,this.resources=n,this.width=void 0!==o.width?o.width:1280,this.height=void 0!==o.height?o.height:1280,this.minWidth=void 0!==o.minWidth?o.minWidth:230,this.minHeight=void 0!==o.minHeight?o.minHeight:50,this.padding=void 0!==o.padding?o.padding:30,this.margin=void 0!==o.margin?o.margin:6,this.lineLengthPerDepth=void 0!==o.lineLengthPerDepth?o.lineLengthPerDepth:[5,1],this.actionMenuButtonSize=o.actionMenuButtonSize||24,this.actions={selection:{current:null,style:"2px solid hsl(205, 100%, 50%)",offset:"3px"},linkCreation:{source:null,target:null,creating:!1},drag:{offsetX:0,offsetY:0,state:!1,target:null}},this.setEvents(r)}var t,n;return t=e,n=[{key:"screenToSVG",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=n||this.svg.node(),i=new DOMPoint(e,t);return i.matrixTransform(r.getScreenCTM().inverse())}},{key:"SVGToScreen",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=n||this.svg.node(),i=new DOMPoint(e,t);return i.matrixTransform(r.getScreenCTM())}},{key:"setEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{SelectEvent:null,UpdateEvent:null};this.events={SelectEvent:e.SelectEvent||null,UpdateEvent:e.UpdateEvent||null}}},{key:"emitUpdateEvent",value:function(){var e;null!==(e=this.events)&&void 0!==e&&e.UpdateEvent&&this.events.UpdateEvent.next()}},{key:"__getVerticalCoefficient",value:function(e){var t,n,r,i,o,s,a=this,l=this.getLineLengthForDepth(e.depth,null===(t=e.parent)||void 0===t||null===(n=t.data)||void 0===n||null===(r=n.definition)||void 0===r?void 0:r.childrenPerLine);if((null===(i=e.children)||void 0===i?void 0:i.length)>0){var c,u,f=Math.ceil(e.children.filter((function(e){var t,n;return null==e||null===(t=e.data)||void 0===t||null===(n=t.definition)||void 0===n?void 0:n.isContainer})).reduce((function(e,t){return e+a.__getVerticalCoefficient(t)}),0));return e.children.filter((function(e){var t,n;return!(null!==(t=e.data)&&void 0!==t&&null!==(n=t.definition)&&void 0!==n&&n.isContainer)})).reduce((function(e,t){return e+t.value}),0)/l+f+(null!==(c=e.data)&&void 0!==c&&null!==(u=c.definition)&&void 0!==u&&u.isContainer?1:0)}return(l===1/0?1:e.value/l)+(null!==(o=e.data)&&void 0!==o&&null!==(s=o.definition)&&void 0!==s&&s.isContainer?1:0)}},{key:"getLineLengthForDepth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t||this.lineLengthPerDepth[Math.min(e,this.lineLengthPerDepth.length-1)]}},{key:"setDisabledStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".component",t="#".concat(this.rootId," ").concat(e||".component");Qr(t).classed("disabled",!0)}},{key:"unsetAllDisabledStyles",value:function(){Qr("#".concat(this.rootId," .disabled")).classed("disabled",!1)}},{key:"dragHandler",value:function(e,t){this.hideActionMenu();var n=document.elementsFromPoint(t.sourceEvent.x,t.sourceEvent.y).find((function(e){return t.subject.data.id!==e.dataset.parentId&&(e.classList.contains("container-background")||e.classList.contains("container"))})),r=Or("#".concat(t.subject.data.id)).attr("cursor","grabbing");Or("#root-components").append((function(){return r.node()}));var i=this.screenToSVG(t.sourceEvent.clientX,t.sourceEvent.clientY,this.svg.select(".container").node());if(Or(e).attr("transform",t.subject.transform="translate(".concat(i.x-this.actions.drag.offsetX,",\n        ").concat(i.y-this.actions.drag.offsetY,")")),t.subject.x=i.x-this.actions.drag.offsetX,t.subject.y=i.y-this.actions.drag.offsetY,t.subject.data.definition){var o=t.subject.data.definition.parentTypes.map((function(e){return":not(.".concat(e,")")})).join("");this.setDisabledStyle(".component:not(#".concat(t.subject.data.id,")").concat(o))}return this.drawLinks(),n}},{key:"setupDragBehavior",value:function(){var e=this,t=null,n=!1,r=this.dragHandler.bind(this);return function(){var e,t,n,r,i=Ir,o=Mr,s=Rr,a=Br,l={},c=vt("start","drag","end"),u=0,f=0;function p(e){e.on("mousedown.drag",h).filter(a).on("touchstart.drag",y).on("touchmove.drag",g,Er).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(s,a){if(!r&&i.call(this,s,a)){var l=b(this,o.call(this,s,a),s,a,"mouse");l&&(Or(s.view).on("mousemove.drag",d,Ar).on("mouseup.drag",m,Ar),Nr(s.view),Tr(s),n=!1,e=s.clientX,t=s.clientY,l("start",s))}}function d(r){if(Cr(r),!n){var i=r.clientX-e,o=r.clientY-t;n=i*i+o*o>f}l.mouse("drag",r)}function m(e){Or(e.view).on("mousemove.drag mouseup.drag",null),Lr(e.view,n),Cr(e),l.mouse("end",e)}function y(e,t){if(i.call(this,e,t)){var n,r,s=e.changedTouches,a=o.call(this,e,t),l=s.length;for(n=0;n<l;++n)(r=b(this,a,e,t,s[n].identifier,s[n]))&&(Tr(e),r("start",e,s[n]))}}function g(e){var t,n,r=e.changedTouches,i=r.length;for(t=0;t<i;++t)(n=l[r[t].identifier])&&(Cr(e),n("drag",e,r[t]))}function v(e){var t,n,i=e.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<o;++t)(n=l[i[t].identifier])&&(Tr(e),n("end",e,i[t]))}function b(e,t,n,r,i,o){var a,f,h,d=c.copy(),m=Sr(o||n,t);if(null!=(h=s.call(e,new Pr("beforestart",{sourceEvent:n,target:p,identifier:i,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:d}),r)))return a=h.x-m[0]||0,f=h.y-m[1]||0,function n(o,s,c){var y,g=m;switch(o){case"start":l[i]=n,y=u++;break;case"end":delete l[i],--u;case"drag":m=Sr(c||s,t),y=u}d.call(o,e,new Pr(o,{sourceEvent:s,subject:h,target:p,identifier:i,active:y,x:m[0]+a,y:m[1]+f,dx:m[0]-g[0],dy:m[1]-g[1],dispatch:d}),r)}}return p.filter=function(e){return arguments.length?(i="function"==typeof e?e:jr(!!e),p):i},p.container=function(e){return arguments.length?(o="function"==typeof e?e:jr(e),p):o},p.subject=function(e){return arguments.length?(s="function"==typeof e?e:jr(e),p):s},p.touchable=function(e){return arguments.length?(a="function"==typeof e?e:jr(!!e),p):a},p.on=function(){var e=c.on.apply(c,arguments);return e===c?p:e},p.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,p):Math.sqrt(f)},p}().subject((function(e){return Or(document.elementsFromPoint(e.sourceEvent.x,e.sourceEvent.y).find((function(e){return e.classList.contains("component-hitbox")}))).datum()})).on("start",(function(t){e.actions.drag.offsetX=t.x-t.subject.x0,e.actions.drag.offsetY=t.y-t.subject.y0})).on("drag",(function(e){t=r(this,e),n=!0})).on("end",(function(r){n&&e.handleDropEvent(r,t)}))}},{key:"__markAsNeedingResize",value:function(e){e.data.drawOption&&(e.data.drawOption.needsResizing=!0),e.parent&&this.__markAsNeedingResize(e.parent)}},{key:"handleDropEvent",value:function(e,t){var n,r,i=this.pluginData.getComponentById(e.subject.parent.data.id),o=t?Or(t):null;if(o!==i&&((null==i?void 0:i.id)!==(null==o||null===(n=o.datum().data)||void 0===n?void 0:n.id)||null!=i&&null!==(r=i.definition)&&void 0!==r&&r.preventChildrenMovement))e.subject.parent&&this.__markAsNeedingResize(e.subject.parent),e.subject.data.drawOption=null,o?this.changeParent(o,e):e.subject.data.removeAllReferenceAttributes();else{var s=e.x,a=e.y,l=e.subject.x1-e.subject.x0,c=e.subject.y1-e.subject.y0;e.subject.data.drawOption=new T({x:s-this.actions.drag.offsetX,y:a-this.actions.drag.offsetY,width:l,height:c})}this.emitUpdateEvent(),this.draw(this.rootId)}},{key:"changeParent",value:function(e,t){var n,r=e.attr("data-parentId"),i=this.pluginData.getComponentById(r),o=Or("#".concat(r)).datum();if(i.definition.childrenTypes.includes(t.subject.data.definition.type)&&(t.subject.data.setReferenceAttribute(i),this.__markAsNeedingResize(o),"workflow"===(null==i||null===(n=i.definition)||void 0===n?void 0:n.displayType))){var s,a,l=this.findInsertionPosition(o,t);if(l)this.pluginData.insertComponentAfter(t.subject.data.id,null===(a=l.data)||void 0===a?void 0:a.id);else if((null===(s=o.children)||void 0===s?void 0:s.length)>0){var c;this.pluginData.insertComponentBefore(t.subject.data.id,null===(c=o.children[0].data)||void 0===c?void 0:c.id)}}}},{key:"findInsertionPosition",value:function(e,t){var n=e.x0-t.subject.parent.x0,r=e.y0-t.subject.parent.y0,i=t.x-n,o=t.y-r;if(!e.children)return null;var s=e.children.filter((function(e){var n,r,i;return(null===(n=e.data)||void 0===n?void 0:n.id)!==(null===(r=t.subject)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.id)})).filter((function(e){return e.y0<=o&&e.y1>=o}));if(s.length>0){var a=s.reduce((function(e,t){var n=i-t.x1;return n>0&&n<e.distanceLeft?(e.distanceLeft=n,e.componentLeft=t):n<=0&&Math.abs(n)<e.distanceRight&&(e.distanceRight=Math.abs(n),e.componentRight=t),e}),{distanceLeft:1/0,distanceRight:1/0,componentLeft:null,componentRight:null});return this.__fillMissingBracket(e,a,t.subject),this.__isInverted(e,a.componentLeft,a.componentRight)?a.componentRight:a.componentLeft}return e.children.reduce((function(e,t){var n=o-t.y1;return n>0&&n<=e.distance&&(e={distance:n,component:t}),e}),{distance:1/0,component:null}).component}},{key:"__fillMissingBracket",value:function(e,t,n){var r;if((null===(r=e.children)||void 0===r?void 0:r.length)>1&&!t.componentLeft&&t.componentRight){var i=e.children.findIndex((function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.id)===(null==n||null===(r=n.data)||void 0===r?void 0:r.id)})),o=e.children.findIndex((function(e){var n,r;return(null===(n=e.data)||void 0===n?void 0:n.id)===(null===(r=t.componentRight.data)||void 0===r?void 0:r.id)})),s=i===o-1?o-2:o-1;s>=0&&(t.componentLeft=e.children[s])}}},{key:"__isInverted",value:function(e,t,n){var r=e.children.findIndex((function(e){var n;return e.data.id===(null==t||null===(n=t.data)||void 0===n?void 0:n.id)})),i=e.children.findIndex((function(e){var t;return e.data.id===(null==n||null===(t=n.data)||void 0===t?void 0:t.id)}));return!!(-1===r&&i===e.children.length-1||r>=0&&i>=0&&r>i)}},{key:"createRenderingContext",value:function(){Or("#".concat(this.rootId,">svg")).empty()?(this.svg=Or("#".concat(this.rootId)).append("svg").attr("viewBox",[0,0,this.width,this.height]).attr("preserveAspectRatio","xMinYMin meet").style("font","10px sans-serif"),this.svg.append("g").attr("class","container").attr("height","100%").attr("width","100%").attr("x",0).attr("y",0)):this.svg=Or("#".concat(this.rootId)).select("svg")}},{key:"draw",value:function(e){this.rootId=e,this.createRenderingContext(),this.__unselectComponent(),this.drawComponents(),this.drawLinks(),this.setViewPortAction()}},{key:"clickHandler",value:function(e){e.stopPropagation(),this.__selectComponent(Or(e.currentTarget))}},{key:"drawComponents",value:function(){var e=this;this.shadowRoot={children:this.pluginData.components,id:"__shadowRoot",name:""};var t=this.buildTree(),n=this.clickHandler.bind(this),r=this.setupDragBehavior(),i=this.svg.select(".container").selectAll("g").data(t,(function(e){return e})).join("g").attr("id",(function(e){return Bi(e,1)[0]})).selectAll("g").data((function(e){return Bi(e,2)[1]})).join("g").attr("id",(function(e){return e.data.id})).on("click",n).call(r).attr("x",(function(e){return e.x0})).attr("y",(function(e){return e.y0})).attr("transform",(function(e){var t=e.x0,n=e.y0;return"translate(".concat(t,",").concat(n,")")}));i.filter((function(e){return"__shadowRoot"!==e.data.id})).attr("class",(function(e){var t=e.data;return"component\n        component-".concat(t.definition.model,"\n        ").concat(t.definition.type)})).html((function(t){var n=t.data;return Ni().renderString(e.resources.models[n.definition.model],Mi(Mi({},n),{},{hasError:n.hasError()}))})).select("svg").attr("id",(function(e){var t=e.data;return"svg-".concat(t.id)})).attr("height",(function(t){return e.getComponentHeight(t)})).attr("width",(function(t){return e.getComponentWidth(t)})),i.select(".component-icon").html((function(t){var n=t.data;return e.resources.icons[n.definition.icon]})),i.select("rect").filter((function(e){var t,n;return null===(t=e.data)||void 0===t||null===(n=t.definition)||void 0===n?void 0:n.isContainer})).attr("height",(function(t){return e.getComponentHeight(t)})).attr("width",(function(t){return e.getComponentWidth(t)})),i.select(".component-container").attr("height",(function(t){return e.getComponentHeight(t)-e.minHeight-e.margin})).attr("width",(function(t){return e.getComponentWidth(t)-2*e.margin})).attr("x",(function(){return e.margin})).attr("y",(function(){return e.minHeight})).filter((function(e){return e.children})).append((function(e){var t=e.data;return Or("#group-".concat(t.id)).node()})),i.select(".component-container>rect").attr("data-parentId",(function(e){return e.data.id}))}},{key:"initializeComponentDrawOptions",value:function(e){var t,n,r,i,o=Math.min(e.value,this.getLineLengthForDepth(e.depth,null===(t=e.data.definition)||void 0===t?void 0:t.childrenPerLine)),s=Math.ceil(this.__getVerticalCoefficient(e)),a=o*(this.minWidth+2*this.margin)+2*e.height*this.padding+(o-1)*(this.padding+2*this.margin),l=s*this.minHeight+e.height*this.padding+(s-1)*(this.padding+this.margin);!e.data.drawOption||null!==(n=e.parent)&&void 0!==n&&null!==(r=n.data)&&void 0!==r&&null!==(i=r.definition)&&void 0!==i&&i.preventChildrenMovement?e.data.drawOption=new T({needsPositioning:!0,width:a,height:l}):(e.data.drawOption.width=a,e.data.drawOption.height=l)}},{key:"buildTree",value:function(){var e=this,t=function(){var e=Wr,t=!1,n=1,r=1,i=[0],o=Jr,s=Jr,a=Jr,l=Jr,c=Jr;function u(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),i=[0],t&&e.eachBefore(zr),e}function f(t){var n=i[t.depth],r=t.x0+n,u=t.y0+n,f=t.x1-n,p=t.y1-n;f<r&&(r=f=(r+f)/2),p<u&&(u=p=(u+p)/2),t.x0=r,t.y0=u,t.x1=f,t.y1=p,t.children&&(n=i[t.depth+1]=o(t)/2,r+=c(t)-n,u+=s(t)-n,(f-=a(t)-n)<r&&(r=f=(r+f)/2),(p-=l(t)-n)<u&&(u=p=(u+p)/2),e(t,r,u,f,p))}return u.round=function(e){return arguments.length?(t=!!e,u):t},u.size=function(e){return arguments.length?(n=+e[0],r=+e[1],u):[n,r]},u.tile=function(t){return arguments.length?(e=Hr(t),u):e},u.padding=function(e){return arguments.length?u.paddingInner(e).paddingOuter(e):u.paddingInner()},u.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:Xr(+e),u):o},u.paddingOuter=function(e){return arguments.length?u.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):u.paddingTop()},u.paddingTop=function(e){return arguments.length?(s="function"==typeof e?e:Xr(+e),u):s},u.paddingRight=function(e){return arguments.length?(a="function"==typeof e?e:Xr(+e),u):a},u.paddingBottom=function(e){return arguments.length?(l="function"==typeof e?e:Xr(+e),u):l},u.paddingLeft=function(e){return arguments.length?(c="function"==typeof e?e:Xr(+e),u):c},u}().size([this.width,this.height]).tile((function(t){var n,r,i=t.children.filter((function(e){var n,r;return!e.data.drawOption||(null===(n=t.data)||void 0===n||null===(r=n.definition)||void 0===r?void 0:r.preventChildrenMovement)})),o=t.children.filter((function(e){var n,r;return e.data.drawOption&&!(null!==(n=t.data)&&void 0!==n&&null!==(r=n.definition)&&void 0!==r&&r.preventChildrenMovement)}));i.forEach((function(t){return e.initializeComponentDrawOptions(t)}));var s=e.__buildLines(o.concat(i),t.depth);e.setupTiles(s.map((function(e){return e.items=e.items.filter((function(e){return e})),e})),"workflow"===(null===(n=t.data)||void 0===n||null===(r=n.definition)||void 0===r?void 0:r.displayType))})).round(!0),n=Fr(this.shadowRoot,(function(t){var n=t.id;return e.pluginData.getChildren("__shadowRoot"===n?null:n)}));return n.count(),t(n),function(e,...t){return function(e,t,n,r){return function e(i,o){if(o>=r.length)return n(i);const s=new U,a=r[o++];let l=-1;for(const e of i){const t=a(e,++l,i),n=s.get(t);n?n.push(e):s.set(t,[e])}for(const[t,n]of s)s.set(t,e(n,o));return t(s)}(e,0)}(e,Array.from,J,t)}(n,(function(e){var t=e.parent;return t&&"__shadowRoot"!==t.data.id?"group-".concat(t.data.id):"root-components"})).filter((function(e){return"root-__shadowRoot"!==Bi(e,1)[0]}))}},{key:"getAnchorPoint",value:function(e,t){if(e.empty()||t.empty())return null;var n,r=e.node().getBoundingClientRect(),i=this.getSelectionCenter(e),o=this.getSelectionCenter(t),s=this.getBearing(this.screenToSVG(i.x,i.y,this.svg.select(".container").node()),this.screenToSVG(o.x,o.y,this.svg.select(".container").node())),a={y:r.top,x:r.x+r.width/2},l={y:r.bottom,x:r.x+r.width/2},c={x:r.left,y:r.top+r.height/2},u={x:r.right,y:r.top+r.height/2};n=s<45||s>=315?l:s>=45&&s<135?u:s>=135&&s<225?a:c;var f=this.screenToSVG(n.x,n.y);return[f.x,f.y]}},{key:"drawLinks",value:function(){var e=this,t=this.pluginData.getLinks();if(t){var n=this.svg.selectAll(".link");n.data(t,(function(e){return e})).join("path").filter((function(e){var t=e.source,n=e.target;return!Or("#".concat(t)).empty()&&!Or("#".concat(n)).empty()})).classed("link",!0).attr("d",(function(t){return e.getLinkGenerator(t)(t)})).attr("id",(function(e){var t=e.definition,n=e.source,r=e.target;return"link-".concat(t.sourceRef,"-").concat(t.attributeRef,"-").concat(n,"-").concat(r)})).attr("fill","none").attr("stroke",(function(e){return e.definition.color})).attr("stroke-width",(function(e){return e.definition.width})).attr("stroke-dasharray",(function(e){return e.definition.dashStyle||"none"})).attr("cursor","pointer").on("click",(function(t){return e.clickHandler(t)})),n.raise()}}},{key:"getSelectionCenter",value:function(e){var t=e.node().getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}},{key:"getBearing",value:function(e,t){var n=t.x-e.x,r=t.y-e.y,i=n/Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),o=r/Math.sqrt(Math.pow(n,2)+Math.pow(r,2));return(Math.atan2(i,o)*(180/Math.PI)+360)%360}},{key:"getLinkGenerator",value:function(e){var t=Or("#".concat(e.source)),n=Or("#".concat(e.target)),r=this.getAnchorPoint(t,n),i=this.getAnchorPoint(n,t),o=this.getSelectionCenter(t),s=this.getSelectionCenter(n),a=this.getBearing(this.screenToSVG(o.x,o.y,this.svg.select(".container").node()),this.screenToSVG(s.x,s.y,this.svg.select(".container").node()));return function(e){let t=ci,n=ui,r=ai,i=li,o=null,s=null,a=function(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new si(t)}(l);function l(){let l;const c=Zr.call(arguments),u=t.apply(this,c),f=n.apply(this,c);if(null==o&&(s=e(l=a())),s.lineStart(),c[0]=u,s.point(+r.apply(this,c),+i.apply(this,c)),c[0]=f,s.point(+r.apply(this,c),+i.apply(this,c)),s.lineEnd(),l)return s=null,l+""||null}return l.source=function(e){return arguments.length?(t=e,l):t},l.target=function(e){return arguments.length?(n=e,l):n},l.x=function(e){return arguments.length?(r="function"==typeof e?e:ei(+e),l):r},l.y=function(e){return arguments.length?(i="function"==typeof e?e:ei(+e),l):i},l.context=function(t){return arguments.length?(null==t?o=s=null:s=e(o=t),l):o},l}(a<45||a>=315||a>=135&&a<225?hi:pi).source((function(){return r})).target((function(){return i}))}},{key:"getComponentHeight",value:function(e){if("__shadowRoot"===e.id)return 0;var t=this.minHeight+this.padding+this.margin,n=e.children?e.children.map((function(e){return e.y1+t})):[0];return e.data.drawOption.height=Math.max.apply(Math,[this.minHeight+e.data.definition.isContainer*t].concat(Pi(n))),e.data.drawOption.height}},{key:"getComponentWidth",value:function(e){if("__shadowRoot"===e.id)return 0;var t=e.children?e.children.map((function(e){return e.x1})):[0];return e.data.drawOption.width=Math.max.apply(Math,[this.minWidth].concat(Pi(t)))+!!e.children*(this.padding+this.margin),e.data.drawOption.width}},{key:"setupTiles",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={x1:0,y1:0};e.forEach((function(e){e.items=e.items.map((function(e){return e.data.drawOption||(e.data.drawOption=new T({needsPositioning:!0,needsResizing:!0})),e})).map((function(e){return e.data.drawOption.needsResizing&&(t.initializeComponentDrawOptions(e),e.data.drawOption.needsResizing=!1),e})).sort((function(e,t){return e.data.drawOption.needsPositioning&&!t.data.drawOption.needsPositioning?1:e.data.drawOption.needsPositioning||t.data.drawOption.needsPositioning?0:e.data.drawOption.x-t.data.drawOption.x}))}));var i=Math.max.apply(Math,Pi(e.map((function(e){return e.items.reduce((function(e,t){return e+t.data.drawOption.width}),0)+(e.items.length+1)*t.padding}))));e.forEach((function(e,o){var s={x1:0,x0:i,y0:e.band+t.padding};if(e.items.forEach((function(e){e.data.drawOption.needsPositioning&&(e.data.drawOption.x=n&&o%2?s.x0-e.data.drawOption.width-t.padding:s.x1+t.padding,e.data.drawOption.y=r.y1+t.padding,e.data.drawOption.needsPositioning=!1),e.x0=e.data.drawOption.x,e.y0=e.data.drawOption.y,s=e,e.x1=e.x0+e.data.drawOption.width,e.y1=e.y0+e.data.drawOption.height})),e.items.length>0){var a=Math.max.apply(Math,Pi(e.items.map((function(e){return e.value}))));r=e.items.find((function(e){return e.value===a}))}}))}},{key:"__buildLines",value:function(e,t){var n=this,r=[],i=0,o=r[i];return e.forEach((function(e){if(r=r.sort((function(e,t){return e.band-t.band})),e.data.drawOption&&!e.data.drawOption.needsPositioning)-1===(i=r.findIndex((function(t){return t.band===100*Math.floor(e.data.drawOption.y/100)})))&&(r.push({total:0,band:100*Math.floor(e.data.drawOption.y/100),items:[]}),i=r.length-1);else{for(i=0;i<r.length&&r[i].items.length>=n.getLineLengthForDepth(t,null===(s=e.parent)||void 0===s||null===(a=s.data)||void 0===a||null===(l=a.definition)||void 0===l?void 0:l.childrenPerLine);){var s,a,l;i+=1}i===r.length&&r.push({total:0,band:i>0?r[i-1].band+100:0,items:[]})}(o=r[i]).total+=e.value,o.items.push(e)})),r.sort((function(e,t){return e.band-t.band}))}},{key:"setViewPortAction",value:function(){var e=this;this.svg.on("click",(function(){e.__unselectComponent(),e.cancelLinkCreationInteraction()}));var t=this.drawLinks.bind(this);this.svg.call(function(){var e,t,n,r=xi,i=Oi,o=Ti,s=Ei,a=Ai,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,f=mi,p=vt("start","zoom","end"),h=500,d=0,m=10;function y(e){e.property("__zoom",Si).on("wheel.zoom",x,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",S).filter(a).on("touchstart.zoom",E).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",T).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new vi(t,e.x,e.y)}function v(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new vi(e.k,r,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function w(e,t,n,r){e.on("start.zoom",(function(){_(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){_(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,o=arguments,s=_(e,o).event(r),a=i.apply(e,o),l=null==n?b(a):"function"==typeof n?n.apply(e,o):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,p="function"==typeof t?t.apply(e,o):t,h=f(u.invert(l).concat(c/u.k),p.invert(l).concat(c/p.k));return function(e){if(1===e)e=p;else{var t=h(e),n=c/t[2];e=new vi(n,l[0]-t[0]*n,l[1]-t[1]*n)}s.zoom(null,e)}}))}function _(e,t,n){return!n&&e.__zooming||new k(e,t)}function k(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=i.apply(e,t),this.taps=0}function x(e,...t){if(r.apply(this,arguments)){var n=_(this,t).event(e),i=this.__zoom,a=Math.max(l[0],Math.min(l[1],i.k*Math.pow(2,s.apply(this,arguments)))),u=Sr(e);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=i.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(i.k===a)return;n.mouse=[u,i.invert(u)],qt(this),n.start()}ki(e),n.wheel=setTimeout(f,150),n.zoom("mouse",o(v(g(i,a),n.mouse[0],n.mouse[1]),n.extent,c))}function f(){n.wheel=null,n.end()}}function O(e,...t){if(!n&&r.apply(this,arguments)){var i=e.currentTarget,s=_(this,t,!0).event(e),a=Or(e.view).on("mousemove.zoom",p,!0).on("mouseup.zoom",h,!0),l=Sr(e,i),u=e.clientX,f=e.clientY;Nr(e.view),_i(e),s.mouse=[l,this.__zoom.invert(l)],qt(this),s.start()}function p(e){if(ki(e),!s.moved){var t=e.clientX-u,n=e.clientY-f;s.moved=t*t+n*n>d}s.event(e).zoom("mouse",o(v(s.that.__zoom,s.mouse[0]=Sr(e,i),s.mouse[1]),s.extent,c))}function h(e){a.on("mousemove.zoom mouseup.zoom",null),Lr(e.view,s.moved),ki(e),s.event(e).end()}}function S(e,...t){if(r.apply(this,arguments)){var n=this.__zoom,s=Sr(e.changedTouches?e.changedTouches[0]:e,this),a=n.invert(s),l=n.k*(e.shiftKey?.5:2),f=o(v(g(n,l),s,a),i.apply(this,t),c);ki(e),u>0?Or(this).transition().duration(u).call(w,f,s,e):Or(this).call(y.transform,f,s,e)}}function E(n,...i){if(r.apply(this,arguments)){var o,s,a,l,c=n.touches,u=c.length,f=_(this,i,n.changedTouches.length===u).event(n);for(_i(n),s=0;s<u;++s)l=[l=Sr(a=c[s],this),this.__zoom.invert(l),a.identifier],f.touch0?f.touch1||f.touch0[2]===l[2]||(f.touch1=l,f.taps=0):(f.touch0=l,o=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),o&&(f.taps<2&&(t=l[0],e=setTimeout((function(){e=null}),h)),qt(this),f.start())}}function A(e,...t){if(this.__zooming){var n,r,i,s,a=_(this,t).event(e),l=e.changedTouches,u=l.length;for(ki(e),n=0;n<u;++n)i=Sr(r=l[n],this),a.touch0&&a.touch0[2]===r.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===r.identifier&&(a.touch1[0]=i);if(r=a.that.__zoom,a.touch1){var f=a.touch0[0],p=a.touch0[1],h=a.touch1[0],d=a.touch1[1],m=(m=h[0]-f[0])*m+(m=h[1]-f[1])*m,y=(y=d[0]-p[0])*y+(y=d[1]-p[1])*y;r=g(r,Math.sqrt(m/y)),i=[(f[0]+h[0])/2,(f[1]+h[1])/2],s=[(p[0]+d[0])/2,(p[1]+d[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(v(r,i,s),a.extent,c))}}function T(e,...r){if(this.__zooming){var i,o,s=_(this,r).event(e),a=e.changedTouches,l=a.length;for(_i(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),h),i=0;i<l;++i)o=a[i],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=Sr(o,this),Math.hypot(t[0]-o[0],t[1]-o[1])<m)){var c=Or(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return y.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property("__zoom",Si),e!==i?w(e,t,n,r):i.interrupt().each((function(){_(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},y.scaleBy=function(e,t,n,r){y.scaleTo(e,(function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)}),n,r)},y.scaleTo=function(e,t,n,r){y.transform(e,(function(){var e=i.apply(this,arguments),r=this.__zoom,s=null==n?b(e):"function"==typeof n?n.apply(this,arguments):n,a=r.invert(s),l="function"==typeof t?t.apply(this,arguments):t;return o(v(g(r,l),s,a),e,c)}),n,r)},y.translateBy=function(e,t,n,r){y.transform(e,(function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}),null,r)},y.translateTo=function(e,t,n,r,s){y.transform(e,(function(){var e=i.apply(this,arguments),s=this.__zoom,a=null==r?b(e):"function"==typeof r?r.apply(this,arguments):r;return o(bi.translate(a[0],a[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)}),r,s)},k.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Or(this.that).datum();p.call(e,this.that,new gi(e,{sourceEvent:this.sourceEvent,target:y,type:e,transform:this.that.__zoom,dispatch:p}),t)}},y.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:yi(+e),y):s},y.filter=function(e){return arguments.length?(r="function"==typeof e?e:yi(!!e),y):r},y.touchable=function(e){return arguments.length?(a="function"==typeof e?e:yi(!!e),y):a},y.extent=function(e){return arguments.length?(i="function"==typeof e?e:yi([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),y):i},y.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],y):[l[0],l[1]]},y.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],y):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},y.constrain=function(e){return arguments.length?(o=e,y):o},y.duration=function(e){return arguments.length?(u=+e,y):u},y.interpolate=function(e){return arguments.length?(f=e,y):f},y.on=function(){var e=p.on.apply(p,arguments);return e===p?y:e},y.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,y):Math.sqrt(d)},y.tapDistance=function(e){return arguments.length?(m=+e,y):m},y}().on("zoom",(function(e){Or(this).select(".container").attr("transform",e.transform),t()})))}},{key:"__unselectComponent",value:function(){this.actions.selection.current&&(Or("#".concat(this.rootId," .selected")).classed("selected",!1).style("outline",""),this.actions.selection.current=null,this.hideActionMenu())}},{key:"__selectComponent",value:function(e){var t="Link"===e.datum().__class?e.datum():e.datum().data,n=this.actions.selection.current===t;if(this.actions.linkCreation.creating){if(e.node().classList.contains("disabled"))return;this.actions.linkCreation.target=t,this.createLink()}else{var r;if(this.__unselectComponent(),n)return;e.classed("selected",!0).style("outline",this.actions.selection.style).style("outline-offset",this.actions.selection.offset),this.actions.selection.current=t,null!==(r=this.events)&&void 0!==r&&r.SelectEvent&&"Component"===t.__class&&this.events.SelectEvent.next(t),this.initializeActionMenu(e)}}},{key:"createLink",value:function(){var e=this.actions.linkCreation,t=e.source,n=e.target,r=this.pluginData.definitions.links.find((function(e){return e.sourceRef===t.definition.type&&e.targetRef===n.definition.type})),i=new I({source:t.id,target:n.id,definition:r});this.actions.linkCreation.source.setLinkAttribute(i),this.emitUpdateEvent(),this.cancelLinkCreationInteraction(),this.drawLinks()}},{key:"initializeActionMenu",value:function(e){var t,n=this,r=this.svg.select(".container").append("svg").attr("id","action-menu"),i=this.getMenuActions(e),o=null===(t=e.datum().data)||void 0===t?void 0:t.getDefinedAttributesByType("Link"),s=wi(this.svg.select(".container").node());r.append("rect").attr("fill","lightgrey").attr("width",this.actionMenuButtonSize*i.length).attr("height",this.actionMenuButtonSize).attr("rx",5);var a=e.node().getBoundingClientRect(),l=a.bottom,c=a.width,u=a.left,f=this.screenToSVG(u+c/2-this.actionMenuButtonSize*i.length/2*s.k,l+20,this.svg.select(".container").node()),p=f.x,h=f.y;r.attr("x",p).attr("y",h);var d=r.selectAll("svg").data(i).join("svg").attr("id",(function(e){return e.id})).attr("width",this.actionMenuButtonSize).attr("height",this.actionMenuButtonSize).attr("x",(function(e,t){return n.actionMenuButtonSize*t})).attr("preserveAspectRatio","xMinYMin meet").attr("cursor",(function(e){return"create-linkable-component"!==e.id&&"create-link"!==e.id||0!==o.length?"pointer":"not-allowed"})).on("click",(function(e,t){e.stopPropagation(),t.handler.bind(n)(e,t)}));d.append("rect").classed("bg-button",!0).attr("fill","lightgrey").attr("rx",5).style("width",this.actionMenuButtonSize).style("height",this.actionMenuButtonSize),d.on("mouseenter",(function(){Or(this).select(".bg-button").attr("fill",(function(e){return"create-linkable-component"!==e.id&&"create-link"!==e.id||0!==o.length?"grey":"lightgrey"}))})).on("mouseleave",(function(){Or(this).select(".bg-button").attr("fill","lightgrey")})),d.append("g").attr("x",0).attr("y",0).html((function(e){return e.icon})).select("svg").attr("opacity",(function(e){return"create-linkable-component"!==e.id&&"create-link"!==e.id||0!==o.length?1:.2})).attr("width","80%").attr("height","80%").attr("x","10%").attr("y","10%"),r.selectAll("button").style("width","30px").style("height","30px").style("border","none")}},{key:"initializeCreateLinkableComponentMenu",value:function(e){var t,n=this;null===(t=Or("#linkable-menu"))||void 0===t||t.remove();var r=0,i=document.querySelector("#action-menu"),o=this.svg.select(".container").append("svg").attr("id","linkable-menu");o.append("rect").attr("rx",5).attr("fill","lightgrey").attr("height","100%").attr("width","100%");var s=o.selectAll(".linkable-button").data(e).join("svg").classed("linkable-button",!0);s.attr("class",(function(e){return"linkable-button ".concat(e.type)})),s.attr("width","100%").attr("rx",5).attr("width","100%").attr("height",30).attr("y",(function(e,t){return 30*t})),s.append("rect").attr("rx",5).attr("fill","lightgrey").attr("height","100%").attr("width","100%"),s.append("svg").html((function(e){return n.resources.icons[e.icon]})).attr("x",5).attr("y",5).attr("width",20).attr("height",20).attr("viewBox",(function(){var e=Or(this).select("svg"),t=e.attr("width").replace("px",""),n=e.attr("height").replace("px","");return"0 0 ".concat(t," ").concat(n)})).attr("background-color","white"),s.append("text").attr("x",30).attr("y",18).text((function(e){return e.type})),s.selectAll("text").each((function(){var e=this.getBBox().width;e>r&&(r=e)})),o.attr("width",r+20+15).attr("height",30*e.length).attr("x",(function(){return parseInt(i.getAttribute("x"),10)+i.getBBox().width/2-parseInt(this.getAttribute("width"),10)/2})).attr("y",parseInt(i.getAttribute("y"),10)+i.getBBox().height+10),s.on("mouseenter",(function(){Or(this).select("rect").attr("fill","grey").attr("cursor","pointer")})).on("mouseleave",(function(){Or(this).select("rect").attr("fill","lightgrey").attr("cursor","default")})).on("click",(function(e,t){n.actions.linkCreation.source=n.actions.selection.current;var r=n.pluginData.addComponent(t);n.pluginData.getComponentById(r).path=n.actions.linkCreation.source.path,n.draw(n.rootId),n.actions.linkCreation.target=Or("#".concat(r)).datum().data,n.createLink()}))}},{key:"startLinkCreationInteraction",value:function(){if(this.actions.selection.current){var e=this.pluginData.getComponentById(this.actions.selection.current.id),t=e.definition.definedAttributes.filter((function(e){return"Link"===e.type})).map((function(e){return":not(.".concat(e.linkRef,")")})).join("");this.actions.linkCreation.creating=!0,this.actions.linkCreation.source=e,this.setDisabledStyle(".component:not(#".concat(e.id,")").concat(t))}}},{key:"getMenuActions",value:function(e){return e.classed("component")?[{id:"create-linkable-component",icon:'<svg viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>',handler:function(){var t,n=null===(t=e.datum().data)||void 0===t?void 0:t.getDefinedAttributesByType("Link").map((function(e){return e.linkRef})),r=this.pluginData.definitions.components.filter((function(e){return n.includes(e.type)}));r.length>0&&this.initializeCreateLinkableComponentMenu(r)}},{id:"create-link",icon:'<svg viewBox="0 0 24 24"><g><path fill="black" d="M19,15.18V7c0-2.21-1.79-4-4-4s-4,1.79-4,4v10c0,1.1-0.9,2-2,2s-2-0.9-2-2V8.82C8.16,8.4,9,7.3,9,6c0-1.66-1.34-3-3-3 S3,4.34,3,6c0,1.3,0.84,2.4,2,2.82V17c0,2.21,1.79,4,4,4s4-1.79,4-4V7c0-1.1,0.9-2,2-2s2,0.9,2,2v8.18c-1.16,0.41-2,1.51-2,2.82 c0,1.66,1.34,3,3,3s3-1.34,3-3C21,16.7,20.16,15.6,19,15.18z M6,7C5.45,7,5,6.55,5,6s0.45-1,1-1s1,0.45,1,1S6.55,7,6,7z M18,19 c-0.55,0-1-0.45-1-1s0.45-1,1-1s1,0.45,1,1S18.55,19,18,19z"/></svg>',handler:function(){this.startLinkCreationInteraction()}},{id:"remove-component",icon:Li,handler:function(){this.pluginData.removeComponentById(this.actions.selection.current.id),this.emitUpdateEvent(),this.draw(this.rootId)}}]:[{id:"remove-link",icon:Li,handler:function(){this.pluginData.removeLink(this.actions.selection.current),this.emitUpdateEvent(),this.draw(this.rootId)}}]}},{key:"cancelLinkCreationInteraction",value:function(){this.actions.linkCreation.creating=!1,this.actions.linkCreation.source=null,this.actions.linkCreation.target=null,this.unsetAllDisabledStyles()}},{key:"hideActionMenu",value:function(){Or("#action-menu").remove(),Or("#linkable-menu").remove()}}],n&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ki(r.key),r)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const qi=Vi;function Ui(e){return Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(e)}const zi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pluginData=t||null}var t,n;return t=e,(n=[{key:"validate",value:function(){return!0}},{key:"parse",value:function(){this.pluginData.definitions={components:[],links:[]}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==Ui(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ui(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Yi(e){return Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yi(e)}var Gi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pluginData=t||null}var t,n;return t=e,n=[{key:"parse",value:function(){this.pluginData.components=[],this.pluginData.parseErrors=[]}},{key:"parseConfiguration",value:function(e){var t=this;if(null!=e.content){var n=JSON.parse(e.content);n[this.pluginData.name]&&Object.keys(n[this.pluginData.name]).forEach((function(e){var r=t.pluginData.getComponentById(e);r&&n[t.pluginData.name][e]&&(r.drawOption=new T(n[t.pluginData.name][e]))}))}}},{key:"isParsable",value:function(e){return null!=e}}],n&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==Yi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Yi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Yi(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const Wi=Gi;function Hi(e){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hi(e)}const Ji=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pluginData=t||null}var t,n;return t=e,n=[{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.reduce((function(e,t){return e[t.path]="",e}),{});return this.renderFiles().forEach((function(e){t[e.path]=e.content})),Object.keys(t).map((function(e){return new q({path:e,content:t[e]})}))}},{key:"renderFiles",value:function(){return[]}},{key:"renderConfiguration",value:function(e){var t={};this.pluginData.components.filter((function(e){return e.drawOption})).forEach((function(e){t[e.id]=e.drawOption}));var n=JSON.parse(e.content)||{};n[this.pluginData.name]=t,e.content=JSON.stringify(n,(function(e,t){return null===t?void 0:t}),2)}}],n&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==Hi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Hi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Hi(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xi(e){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xi(e)}function Qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zi(e,t){if(t&&("object"===Xi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function eo(e){var t="function"==typeof Map?new Map:void 0;return eo=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return to(e,arguments,io(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ro(r,e)},eo(e)}function to(e,t,n){return to=no()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&ro(i,n.prototype),i},to.apply(null,arguments)}function no(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ro(e,t){return ro=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ro(e,t)}function io(e){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},io(e)}const oo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ro(e,t)}(o,e);var t,n,r,i=(t=o,n=no(),function(){var e,r=io(t);if(n){var i=io(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Zi(this,e)});function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Error happened when trying to parse.",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Error";return Qi(this,o),(e=i.call(this,t)).name="ParseError",e.startLine=n,e.startColumn=r,e.endLine=s,e.endColumn=a,e.severity=l,e}return r=o,Object.defineProperty(r,"prototype",{writable:!1}),r}(eo(Error));function so(e){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},so(e)}function ao(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var lo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,version:null,components:[],definitions:{components:[],links:[]},parseErrors:[],defaultFileName:null};ao(this,e),this.name=t.name||null,this.version=t.version||null,this.components=t.components||[],this.definitions={components:[],links:[]},t.definitions&&(this.definitions.components=t.definitions.components||[],this.definitions.links=t.definitions.links||[]),this.parseErrors=t.parseErrors||[],this.defaultFileName=t.defaultFileName||null}var t,n;return t=e,n=[{key:"coreVersion",get:function(){return"0.13.0"}},{key:"getComponentById",value:function(e){return this.components.find((function(t){return t.id===e}))||null}},{key:"getComponentsByType",value:function(e){return this.components.filter((function(t){var n=t.definition;return n&&n.type===e}))}},{key:"addComponent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultFileName||"",r=this.generateComponentId(e);return this.components.push(new m({id:r,name:r,definition:e,path:"".concat(t).concat(n)})),r}},{key:"generateComponentId",value:function(e){for(var t="".concat(e.type,"_"),n=this.components.map((function(e){return e.id})).filter((function(e){return new RegExp("".concat(t,"\\d+")).test(e)})).map((function(e){return parseInt(e.substring(t.length),10)})),r=1;n.includes(r);)r+=1;return"".concat(t).concat(r)}},{key:"removeComponentById",value:function(e){var t=this;this.getChildren(e).forEach((function(e){return t.removeComponentById(e.id)})),this.components=this.components.filter((function(t){return t.id!==e})),this.components.forEach((function(t){t.removeLinkAttribute(e)}))}},{key:"removeLink",value:function(e){var t=e.source,n=e.target,r=e.definition.attributeRef;this.getComponentById(t).removeLinkAttribute(n,r)}},{key:"getLinks",value:function(){var e=this,t=[];return this.definitions.links.forEach((function(n){e.getComponentsByType(n.sourceRef).forEach((function(e){var r=e.getAttributeByName(n.attributeRef);r&&r.value.forEach((function(r){return t.push(new I({definition:n,source:e.id,target:r}))}))}))})),t.concat(this.getWorkflowLinks())}},{key:"getWorkflowLinks",value:function(){var e=this;return this.components.filter((function(e){var t;return null===(t=e.definition.displayType)||void 0===t?void 0:t.match("workflow")})).reduce((function(t,n){var r=e.getChildren(n.id);if(r.length>1)for(var i=0;i<r.length-1;i+=1)t.push(new I({definition:new B({sourceRef:"__workflow",attributeRef:"__next"}),source:r[i].id,target:r[i+1].id}));return t}),[])}},{key:"initLinkDefinitions",value:function(){var e=this;this.definitions.links=[],this.definitions.components.forEach((function(t){var n=t.type,r=t.definedAttributes;e.__setLinkDefinitions(n,r)}))}},{key:"__setLinkDefinitions",value:function(e,t){var n=this;t.forEach((function(t){if("Link"===t.type){var r=new B({type:t.linkType,attributeRef:t.name,sourceRef:e,targetRef:t.linkRef,color:t.linkColor,width:t.linkWidth,dashStyle:t.linkDashStyle});n.definitions.links.push(r)}else"Object"===t.type&&n.__setLinkDefinitions(e,t.definedAttributes)}))}},{key:"getChildren",value:function(e){return this.components.filter((function(t){return t.getContainerId()===e}))}},{key:"__moveComponentToIndex",value:function(e,t){var n=this.components.findIndex((function(t){return t.id===e}));if(n!==t){var r=this.getComponentById(e),i=Math.max(0,t);i+=i>n,this.components.splice(i,0,r),this.components.splice(n+(i<n),1)}}},{key:"insertComponentBefore",value:function(e,t){var n=this.components.findIndex((function(e){return e.id===t}));-1!==n&&this.__moveComponentToIndex(e,Math.max(0,n-1))}},{key:"insertComponentAfter",value:function(e,t){var n=this.components.findIndex((function(t){return t.id===e})),r=this.components.findIndex((function(e){return e.id===t}));-1!==r&&this.__moveComponentToIndex(e,Math.min(this.components.length-1,r+(r<n)))}}],n&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==so(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==so(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===so(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const co=lo;function uo(e){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uo(e)}function fo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var po=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pluginData:null,pluginDrawer:null,pluginMetadata:null,pluginParser:null,pluginRenderer:null};fo(this,e),this.data=t.pluginData||new co,this.__drawer=t.pluginDrawer||new qi(this.data),this.__metadata=t.pluginMetadata||new zi(this.data),this.__parser=t.pluginParser||new Wi(this.data),this.__renderer=t.pluginRenderer||new Ji(this.data)}var t,n;return t=e,n=[{key:"init",value:function(e){this.__drawer.setEvents(e),this.__metadata.parse(),this.data.initLinkDefinitions()}},{key:"initResources",value:function(e){this.__drawer.resources=e}},{key:"draw",value:function(e){this.__drawer.draw(e)}},{key:"parse",value:function(e,t){this.__parser.parse(t),this.__parser.parseConfiguration(e)}},{key:"isParsable",value:function(e){return this.__parser.isParsable(e)}},{key:"render",value:function(e,t){return this.__renderer.renderConfiguration(e),this.__renderer.render(t).concat(e)}}],n&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=function(e,t){if("object"!==uo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==uo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===uo(i)?i:String(i)),r)}var i}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const ho=po})();var o=t;for(var s in i)o[s]=i[s];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{default:()=>os});var e=n(181);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function l(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}const u=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(p,t);var n,r,s,u,f=(s=p,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(s);if(u){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(){return i(this,p),f.apply(this,arguments)}return n=p,r=[{key:"addComponent",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=(arguments.length>2&&void 0!==arguments[2]||this.defaultFileName,this.generateComponentId(t)),i=new e.Component({id:r,definition:t,path:"".concat(n).concat(r,".yaml")});return"Container"===t.type&&(i.attributes=[this.__createAttribute("isInitContainer",!1,t)]),this.components.push(i),r}},{key:"__createAttribute",value:function(t,n,r){var i=r.definedAttributes.find((function(e){return e.name===t}));return new e.ComponentAttribute({name:t,value:n,type:i.type,definition:i})}}],r&&o(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),p}(e.DefaultData);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function g(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}const b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(n);if(r){var i=v(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return g(this,e)});function o(e,t,n,r,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e,t,n,r,h(h({},s),{},{minHeight:80,minWidth:110,margin:10,padding:20}))}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(e.DefaultDrawer);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function x(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}const S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(n);if(r){var i=O(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return x(this,e)});function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{apiVersion};return _(this,o),(e=i.call(this,t)).apiVersion=t.apiVersion,e}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(e.ComponentDefinition),E={commonAttributes:JSON.parse('[{"name":"metadata","type":"Object","expanded":true,"attributes":[{"name":"namespace","type":"String","description":"Namespace defines the space within which each name must be unique.<br/>An empty namespace is equivalent to the \\"default\\" namespace, but \\"default\\" is the canonical representation.<br/>Not all objects are required to be scoped to a namespace - the value of this field for those objects will be empty.<br/><br/>Must be a DNS_LABEL. Cannot be updated.","url":"http://kubernetes.io/docs/user-guide/namespaces"},{"name":"labels","type":"Object","attributes":[{"name":"app.kubernetes.io/name","type":"String","description":"The name of the application."},{"name":"app.kubernetes.io/instance","type":"String","description":"A unique name identifying the instance of an application."},{"name":"app.kubernetes.io/version","type":"String","description":"The current version of the application (e.g., a <a href=\\"https://semver.org/spec/v1.0.0.html\\">SemVer 1.0</a>, revision hash, etc.)."},{"name":"app.kubernetes.io/component","type":"String","description":"The component within the architecture."},{"name":"app.kubernetes.io/part-of","type":"String","description":"The name of a higher level application this one is part of."},{"name":"app.kubernetes.io/managed-by","type":"String","description":"The tool being used to manage the operation of an application."}]},{"name":"annotations","type":"Object"}]}]'),apiVersions:{"apps/v1":JSON.parse('[{"type":"Deployment","model":"DefaultContainer","icon":"resources/unlabeled/deploy","description":"A Deployment provides declarative updates for Pods and ReplicaSets.<br/><br/>You describe a desired state in a Deployment, and the Deployment Controller changes the actual state to the desired state at a controlled rate.<br/>You can define Deployments to create new ReplicaSets, or to remove existing Deployments and adopt all their resources with new Deployments.","url":"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/","isContainer":true,"attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[{"name":"replicas","type":"Number","description":"Number of desired pods.<br/>This is a pointer to distinguish between explicit zero and not specified.<br/>Defaults to 1."},{"name":"strategy","type":"Object","description":"The deployment strategy to use to replace existing pods with new ones.","attributes":[{"name":"type","type":"String","description":"Type of deployment.<br/>Can be \\"Recreate\\" or \\"RollingUpdate\\".<br/>Default is RollingUpdate.","rules":{"values":["RollingUpdate","Recreate"]}},{"name":"rollingUpdate","type":"Object","description":"Rolling update config params.<br/>Present only if DeploymentStrategyType = RollingUpdate.","expanded":true,"attributes":[{"name":"maxSurge","type":"String","description":"The maximum number of pods that can be scheduled above the desired number of pods.<br/>Value can be an absolute number (ex: 5) or a percentage of desired pods (ex: 10%).<br/>This can not be 0 if MaxUnavailable is 0.<br/>Absolute number is calculated from percentage by rounding up.<br/>Defaults to 25%.<br/>Example: when this is set to 30%, the new ReplicaSet can be scaled up immediately when the rolling update starts, such that the total number of old and new pods do not exceed 130% of desired pods.<br/>Once old pods have been killed, new ReplicaSet can be scaled up further, ensuring that total number of pods running at any time during the update is at most 130% of desired pods."},{"name":"maxUnavailable","type":"String","description":"The maximum number of pods that can be unavailable during the update.<br/>Value can be an absolute number (ex: 5) or a percentage of desired pods (ex: 10%).<br/>Absolute number is calculated from percentage by rounding down.<br/>This can not be 0 if MaxSurge is 0.<br/>Defaults to 25%.<br/>Example: when this is set to 30%, the old ReplicaSet can be scaled down to 70% of desired pods immediately when the rolling update starts.<br/>Once new pods are ready, old ReplicaSet can be scaled down further, followed by scaling up the new ReplicaSet, ensuring that the total number of pods available at all times during the update is at least 70% of desired pods."}]}]},{"name":"revisionHistoryLimit","type":"Number","description":"The number of old ReplicaSets to retain to allow rollback.<br/>This is a pointer to distinguish between explicit zero and not specified.<br/>Defaults to 10."}]}]},{"type":"StatefulSet","model":"DefaultContainer","icon":"resources/unlabeled/sts","description":"StatefulSet is the workload API object used to manage stateful applications.<br/><br/>Manages the deployment and scaling of a set of Pods, and provides guarantees about the ordering and uniqueness of these Pods.<br/><br/>Like a Deployment, a StatefulSet manages Pods that are based on an identical container spec.<br/>Unlike a Deployment, a StatefulSet maintains a sticky identity for each of their Pods.<br/>These pods are created from the same spec, but are not interchangeable: each has a persistent identifier that it maintains across any rescheduling.<br/><br/>If you want to use storage volumes to provide persistence for your workload, you can use a StatefulSet as part of the solution.<br/>Although individual Pods in a StatefulSet are susceptible to failure, the persistent Pod identifiers make it easier to match existing volumes to the new Pods that replace any that have failed.","url":"https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/","isContainer":true,"attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[]}]}]'),"batch/v1":JSON.parse('[{"type":"CronJob","model":"DefaultContainer","icon":"resources/unlabeled/cronjob","description":"A CronJob creates Jobs on a repeating schedule.<br/><br/>CronJob is meant for performing regular scheduled actions such as backups, report generation, and so on.<br/>One CronJob object is like one line of a crontab (cron table) file on a Unix system.<br/>It runs a job periodically on a given schedule, written in Cron format.<br/><br/>CronJobs have limitations and idiosyncrasies.<br/>For example, in certain circumstances, a single CronJob can create multiple concurrent Jobs.<br/>See the limitations below.<br/><br/>When the control plane creates new Jobs and (indirectly) Pods for a CronJob, the .metadata.name of the CronJob is part of the basis for naming those Pods.<br/>The name of a CronJob must be a valid DNS subdomain value, but this can produce unexpected results for the Pod hostnames.<br/>For best compatibility, the name should follow the more restrictive rules for a DNS label.<br/>Even when the name is a DNS subdomain, the name must be no longer than 52 characters.<br/>This is because the CronJob controller will automatically append 11 characters to the name you provide and there is a constraint that the length of a Job name is no more than 63 characters.","url":"https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/","isContainer":true,"attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[]}]},{"type":"Job","model":"DefaultContainer","icon":"resources/unlabeled/job","isContainer":true,"parentTypes":["CronJob"],"attributes":[{"name":"parent","type":"Reference","containerRef":"CronJob"},{"name":"spec","type":"Object","expanded":true,"attributes":[]}]}]'),v1:JSON.parse('[{"type":"Pod","model":"DefaultContainer","icon":"resources/unlabeled/pod","parentTypes":["Deployment","StatefulSet","Job"],"isContainer":true,"childrenPerLine":3,"attributes":[{"name":"parentDeployment","type":"Reference","containerRef":"Deployment"},{"name":"parentStatefulSet","type":"Reference","containerRef":"StatefulSet"},{"name":"parentJob","type":"Reference","containerRef":"Job"},{"name":"spec","type":"Object","expanded":true,"attributes":[{"name":"topologySpreadConstraints","type":"Array","description":"TopologySpreadConstraints describes how a group of pods ought to spread across topology domains.<br/>Scheduler will schedule pods in a way which abides by the constraints.<br/>All topologySpreadConstraints are ANDed.","attributes":[{"name":null,"type":"Object","attributes":[{"name":"maxSkew","type":"Number","required":true},{"name":"minDomains","type":"Number"},{"name":"topologyKey","type":"String","required":true},{"name":"whenUnsatisfiable","type":"String","required":true,"rules":{"values":["DoNotSchedule","ScheduleAnyway"]}},{"name":"labelSelector","type":"Object","attributes":[{"name":"matchLabels","type":"Object","expanded":true},{"name":"matchExpressions","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"key","type":"String","required":true},{"name":"operator","type":"String","required":true},{"name":"values","type":"Array"}]}]}]}]}]}]}]},{"type":"Service","model":"DefaultModel","icon":"resources/unlabeled/svc","attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[{"name":"type","type":"String","description":"type determines how the Service is exposed.<br/>Defaults to ClusterIP.<br/>Valid options are ExternalName, ClusterIP, NodePort, and LoadBalancer.<br/>\\"ClusterIP\\" allocates a cluster-internal IP address for load-balancing to endpoints.<br/>Endpoints are determined by the selector or if that is not specified, by manual construction of an Endpoints object or EndpointSlice objects.<br/>If clusterIP is \\"None\\", no virtual IP is allocated and the endpoints are published as a set of endpoints rather than a virtual IP.<br/>\\"NodePort\\" builds on ClusterIP and allocates a port on every node which routes to the same endpoints as the clusterIP.<br/>\\"LoadBalancer\\" builds on NodePort and creates an external load-balancer (if supported in the current cloud) which routes to the same endpoints as the clusterIP.<br/>\\"ExternalName\\" aliases this service to the specified externalName.<br/>Several other fields do not apply to ExternalName services.","url":"https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types","rules":{"values":["ClusterIP","NodePort","LoadBalancer","ExternalName"]}},{"name":"selector","type":"Link","linkRef":"Pod"},{"name":"ports","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"name","type":"String"},{"name":"protocol","type":"String","rules":{"values":["TCP","UDP","SCTP"]}},{"name":"port","type":"Number","required":true},{"name":"targetPort","type":"String"}]}]}]}]},{"type":"ConfigMap","model":"DefaultModel","icon":"resources/unlabeled/cm","attributes":[{"name":"data","type":"Object","expanded":true},{"name":"binaryData","type":"Object"},{"name":"immutable","type":"Boolean"}]},{"type":"Secret","model":"DefaultModel","icon":"resources/unlabeled/secret","attributes":[{"name":"type","type":"String","rules":{"values":["Opaque","kubernetes.io/service-account-token","kubernetes.io/dockercfg","kubernetes.io/dockerconfigjson","kubernetes.io/basic-auth","kubernetes.io/ssh-auth","kubernetes.io/tls","bootstrap.kubernetes.io/token"]}},{"name":"stringData","type":"Object","expanded":true},{"name":"data","type":"Object"},{"name":"immutable","type":"Boolean"}]},{"type":"PersistentVolumeClaim","model":"DefaultModel","icon":"resources/unlabeled/pvc","attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[{"name":"storageClassName","type":"String"},{"name":"accessModes","type":"Array"},{"name":"volumeMode","type":"String","rules":{"values":["Filesystem","Block"]}},{"name":"ressources","type":"Object","attributes":[{"name":"requests","type":"Object","expanded":true,"attributes":[{"name":"storage","type":"String"}]},{"name":"limits","type":"Object","expanded":true,"attributes":[{"name":"storage","type":"String"}]}]},{"name":"volumeName","type":"String"},{"name":"selector","type":"Object","attributes":[{"name":"matchLabels","type":"Object","expanded":true}]}]}]}]'),"networking.k8s.io/v1":JSON.parse('[{"type":"Ingress","model":"DefaultModel","icon":"resources/unlabeled/ing","attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[{"name":"ingressClassName","type":"String","description":"ingressClassName is the name of an IngressClass cluster resource.<br/>Ingress controller implementations use this field to know whether they should be serving this Ingress resource, by a transitive connection (controller -> IngressClass -> Ingress resource).<br/>Although the `kubernetes.io/ingress.class` annotation (simple constant name) was never formally defined, it was widely supported by Ingress controllers to create a direct binding between Ingress controller and Ingress resources.<br/>Newly created Ingress resources should prefer using the field.<br/>However, even though the annotation is officially deprecated, for backwards compatibility reasons, ingress controllers should still honor that annotation if present."},{"name":"defaultBackend","type":"Object","description":"DefaultBackend is the backend that should handle requests that don\'t match any rule.<br/>If Rules are not specified, DefaultBackend must be specified.<br/>If DefaultBackend is not set, the handling of requests that do not match any of the rules will be up to the Ingress controller.","attributes":[{"name":"service","type":"Object","expanded":true,"attributes":[{"name":"name","type":"Link","linkRef":"Service","required":true},{"name":"port","type":"Object","expanded":true,"attributes":[{"name":"name","type":"String","description":"Name is the name of the port on the Service.<br/>This is a mutually exclusive setting with \\"Number\\"."},{"name":"number","type":"Number","description":"Number is the numerical port number (e.g. 80) on the Service.<br/>This is a mutually exclusive setting with \\"Name\\"."}]}]}]},{"name":"rules","type":"Array","description":"A list of host rules used to configure the Ingress.<br/>If unspecified, or no rule matches, all traffic is sent to the default backend.","attributes":[{"name":null,"type":"Object","attributes":[{"name":"host","type":"String"},{"name":"http","type":"Object","expanded":true,"attributes":[{"name":"paths","type":"Aray","required":true,"attributes":[{"name":null,"type":"Object","attributes":[{"name":"pathType","type":"String","required":true,"rules":{"values":["Exact","Prefix","ImplementationSpecific"]}},{"name":"path","type":"String"},{"name":"backend","type":"Object","required":true,"expanded":true,"attributes":[{"name":"service","type":"Object","expanded":true,"attributes":[{"name":"name","type":"Link","description":"Name is the referenced service.<br/>The service must exist in the same namespace as the Ingress object.","linkRef":"Service","required":true},{"name":"port","type":"Object","expanded":true,"attributes":[{"name":"name","type":"String","description":"Name is the name of the port on the Service.<br/>This is a mutually exclusive setting with \\"Number\\"."},{"name":"number","type":"Number","description":"Number is the numerical port number (e.g. 80) on the Service.<br/>This is a mutually exclusive setting with \\"Name\\"."}]}]}]}]}]}]}]}]},{"name":"tls","type":"Array","description":"TLS configuration.<br/>Currently the Ingress only supports a single TLS port, 443.<br/>If multiple members of this list specify different hosts, they will be multiplexed on the same port according to the hostname specified through the SNI TLS extension, if the ingress controller fulfilling the ingress supports SNI.","attributes":[{"name":null,"type":"Object","attributes":[{"name":"hosts","type":"Array"},{"name":"secretName","type":"String"}]}]}]}]}]'),"autoscaling/v2":JSON.parse('[{"type":"HorizontalPodAutoscaler","model":"DefaultModel","icon":"resources/unlabeled/hpa","attributes":[{"name":"spec","type":"Object","expanded":true,"attributes":[]}]}]'),others:JSON.parse('[{"type":"Container","model":"DefaultContainer","icon":"resources/unlabeled/container","isContainer":true,"parentTypes":["Pod"],"attributes":[{"name":"parent","type":"Reference","containerRef":"Pod","required":true},{"name":"isInitContainer","type":"Boolean"},{"name":"image","type":"String"},{"name":"imagePullPolicy","type":"String","rules":{"values":["Always","IfNotPresent","Never"]}},{"name":"workingDir","type":"String"},{"name":"command","type":"Array","description":"Entrypoint array.<br/>Not executed within a shell.<br/>The container image\'s ENTRYPOINT is used if this is not provided.<br/>Variable references $(VAR_NAME) are expanded using the container\'s environment.<br/>If a variable cannot be resolved, the reference in the input string will be unchanged.<br/>Double $$ are reduced to a single $, which allows for escaping the $(VAR_NAME) syntax: i.e. \\"$$(VAR_NAME)\\" will produce the string literal \\"$(VAR_NAME)\\".<br/>Escaped references will never be expanded, regardless of whether the variable exists or not.<br/>Cannot be updated.","url":"https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#running-a-command-in-a-shell"},{"name":"args","type":"Array","description":"Arguments to the entrypoint.<br/>The container image\'s CMD is used if this is not provided.<br/>Variable references $(VAR_NAME) are expanded using the container\'s environment.<br/>If a variable cannot be resolved, the reference in the input string will be unchanged.<br/>Double $$ are reduced to a single $, which allows for escaping the $(VAR_NAME) syntax: i.e. \\"$$(VAR_NAME)\\" will produce the string literal \\"$(VAR_NAME)\\".<br/>Escaped references will never be expanded, regardless of whether the variable exists or not.<br/>Cannot be updated.","url":"https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#running-a-command-in-a-shell"},{"name":"env","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"name","type":"String","required":true},{"name":"value","type":"String"}]}]},{"name":"envFrom","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"configMapRef","type":"Object","attributes":[{"name":"name","type":"String"},{"name":"optional","type":"Boolean"}]},{"name":"secretRef","type":"Object","attributes":[{"name":"name","type":"String"},{"name":"optional","type":"Boolean"}]},{"name":"prefix","type":"String"}]}]},{"name":"ports","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"name","type":"String"},{"name":"containerPort","type":"String","required":true},{"name":"protocol","type":"String","rules":{"values":["TCP","IDP","SCTP"]}}]}]},{"name":"ressources","type":"Object","attributes":[{"name":"requests","type":"Object","expanded":true,"attributes":[{"name":"memory","type":"String"},{"name":"cpu","type":"String"},{"name":"ephemeral-storage","type":"String"}]},{"name":"limits","type":"Object","expanded":true,"attributes":[{"name":"memory","type":"String"},{"name":"cpu","type":"String"},{"name":"ephemeral-storage","type":"String"}]}]},{"name":"readinessProbe","type":"Object","attributes":[{"name":"initialDelaySeconds","type":"Number"},{"name":"periodSeconds","type":"Number"},{"name":"timeoutSeconds","type":"Number"},{"name":"successThreshold","type":"Number"},{"name":"failureThreshold","type":"Number"},{"name":"terminationGracePeriodSeconds","type":"Number"},{"name":"httpGet","type":"Object","attributes":[{"name":"host","type":"String"},{"name":"port","type":"String","required":false},{"name":"scheme","type":"String","rules":{"values":["HTTP","HTTPS"]}},{"name":"path","type":"String"},{"name":"httpHeaders","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"name","type":"String","required":true},{"name":"value","type":"String","required":true}]}]}]},{"name":"exec","type":"Object","attributes":[{"name":"command","type":"Array"}]},{"name":"tcpSocket","type":"Object","attributes":[{"name":"host","type":"String"},{"name":"port","type":"String","required":false}]},{"name":"grpc","type":"Object","attributes":[{"name":"port","type":"String","required":false},{"name":"service","type":"String"}]}]},{"name":"livenessProbe","type":"Object","attributes":[{"name":"initialDelaySeconds","type":"Number"},{"name":"periodSeconds","type":"Number"},{"name":"timeoutSeconds","type":"Number"},{"name":"successThreshold","type":"Number"},{"name":"failureThreshold","type":"Number"},{"name":"terminationGracePeriodSeconds","type":"Number"},{"name":"httpGet","type":"Object","attributes":[{"name":"host","type":"String"},{"name":"port","type":"String","required":false},{"name":"scheme","type":"String","rules":{"values":["HTTP","HTTPS"]}},{"name":"path","type":"String"},{"name":"httpHeaders","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"name","type":"String","required":true},{"name":"value","type":"String","required":true}]}]}]},{"name":"exec","type":"Object","attributes":[{"name":"command","type":"Array"}]},{"name":"tcpSocket","type":"Object","attributes":[{"name":"host","type":"String"},{"name":"port","type":"String","required":false}]},{"name":"grpc","type":"Object","attributes":[{"name":"port","type":"String","required":false},{"name":"service","type":"String"}]}]}]},{"type":"ConfigMapMount","model":"DefaultModel","icon":"resources/unlabeled/vol","parentTypes":["Container"],"attributes":[{"name":"parent","type":"Reference","containerRef":"Container","required":true},{"name":"configMap","type":"Object","required":true,"expanded":true,"attributes":[{"name":"name","type":"Link","linkRef":"ConfigMap","required":true},{"name":"defaultMode","type":"Number"},{"name":"items","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"key","type":"String","required":true},{"name":"path","type":"String","required":true},{"name":"mode","type":"Number"}]}]},{"name":"optional","type":"Boolean"}]},{"name":"mountPath","type":"String","required":true}]},{"type":"SecretMount","model":"DefaultModel","icon":"resources/unlabeled/vol","parentTypes":["Container"],"attributes":[{"name":"parent","type":"Reference","containerRef":"Container","required":true},{"name":"secret","type":"Object","required":true,"expanded":true,"attributes":[{"name":"secretName","type":"Link","linkRef":"Secret","required":true},{"name":"defaultMode","type":"Number"},{"name":"items","type":"Array","attributes":[{"name":null,"type":"Object","attributes":[{"name":"key","type":"String","required":true},{"name":"path","type":"String","required":true},{"name":"mode","type":"Number"}]}]},{"name":"optional","type":"Boolean"}]},{"name":"mountPath","type":"String","required":true}]},{"type":"PersistentVolumeClaimMount","model":"DefaultModel","icon":"resources/unlabeled/vol","parentTypes":["Container"],"attributes":[{"name":"parent","type":"Reference","containerRef":"Container","required":true},{"name":"persistentVolumeClaim","type":"Object","required":true,"expanded":true,"attributes":[{"name":"claimName","type":"Link","linkRef":"PersistentVolumeClaim","required":true}]},{"name":"mountPath","type":"String","required":true},{"name":"subPath","type":"String"},{"name":"subPathExpr","type":"String"},{"name":"mountPropagation","type":"String","rules":{"values":["None","HostToContainer","Bidirectional"]}},{"name":"readOnly","type":"Boolean"}]}]')}};function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function I(e){var t=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===A(t)?t:String(t)}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function R(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}const F=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(a,t);var n,r,i,o,s=(i=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=D(i);if(o){var n=D(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return R(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).commonAttributes=E.commonAttributes.map(t.getAttributeDefinition,B(t)),t}return n=a,(r=[{key:"validate",value:function(){return!0}},{key:"parse",value:function(){var e=this,t=Object.keys(E.apiVersions).flatMap((function(t){return E.apiVersions[t].map((function(n){return e.getComponentDefinition(t,n)}))}));this.setChildrenTypes(t),this.pluginData.definitions.components=t}},{key:"getComponentDefinition",value:function(e,t){var n=(t.attributes||[]).map(this.getAttributeDefinition,this);return"others"!==e&&(n=[].concat(L(this.commonAttributes),L(n))),new S(C(C({apiVersion:e},t),{},{definedAttributes:n}))}},{key:"getAttributeDefinition",value:function(t){var n=t.attributes||[],r=new e.ComponentAttributeDefinition(C(C({},t),{},{displayName:t.displayName||this.formatDisplayName(t.name),definedAttributes:n.map(this.getAttributeDefinition,this)}));return r.expanded=t.expanded||!1,r}},{key:"setChildrenTypes",value:function(e){var t=e.filter((function(e){return e.parentTypes.length>0})).reduce((function(e,t){return t.parentTypes.forEach((function(n){e[n]=[].concat(L(e[n]||[]),[t.type])})),e}),{});e.filter((function(e){return t[e.type]})).forEach((function(e){e.childrenTypes=t[e.type]}))}},{key:"formatDisplayName",value:function(e){if(!e||e.includes("."))return e;if("spec"===e)return"Specification";var t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}}])&&P(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),a}(e.DefaultMetadata),$=Symbol.for("yaml.alias"),K=Symbol.for("yaml.document"),V=Symbol.for("yaml.map"),q=Symbol.for("yaml.pair"),U=Symbol.for("yaml.scalar"),z=Symbol.for("yaml.seq"),Y=Symbol.for("yaml.node.type"),G=e=>!!e&&"object"==typeof e&&e[Y]===$,W=e=>!!e&&"object"==typeof e&&e[Y]===K,H=e=>!!e&&"object"==typeof e&&e[Y]===V,J=e=>!!e&&"object"==typeof e&&e[Y]===q,X=e=>!!e&&"object"==typeof e&&e[Y]===U,Q=e=>!!e&&"object"==typeof e&&e[Y]===z;function Z(e){if(e&&"object"==typeof e)switch(e[Y]){case V:case z:return!0}return!1}function ee(e){if(e&&"object"==typeof e)switch(e[Y]){case $:case V:case U:case z:return!0}return!1}class te{constructor(e){Object.defineProperty(this,Y,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}}const ne=Symbol("break visit"),re=Symbol("skip children"),ie=Symbol("remove node");function oe(e,t){const n=ce(t);W(e)?se(null,e.contents,n,Object.freeze([e]))===ie&&(e.contents=null):se(null,e,n,Object.freeze([]))}function se(e,t,n,r){const i=ue(e,t,n,r);if(ee(i)||J(i))return fe(e,r,i),se(e,i,n,r);if("symbol"!=typeof i)if(Z(t)){r=Object.freeze(r.concat(t));for(let e=0;e<t.items.length;++e){const i=se(e,t.items[e],n,r);if("number"==typeof i)e=i-1;else{if(i===ne)return ne;i===ie&&(t.items.splice(e,1),e-=1)}}}else if(J(t)){r=Object.freeze(r.concat(t));const e=se("key",t.key,n,r);if(e===ne)return ne;e===ie&&(t.key=null);const i=se("value",t.value,n,r);if(i===ne)return ne;i===ie&&(t.value=null)}return i}async function ae(e,t){const n=ce(t);W(e)?await le(null,e.contents,n,Object.freeze([e]))===ie&&(e.contents=null):await le(null,e,n,Object.freeze([]))}async function le(e,t,n,r){const i=await ue(e,t,n,r);if(ee(i)||J(i))return fe(e,r,i),le(e,i,n,r);if("symbol"!=typeof i)if(Z(t)){r=Object.freeze(r.concat(t));for(let e=0;e<t.items.length;++e){const i=await le(e,t.items[e],n,r);if("number"==typeof i)e=i-1;else{if(i===ne)return ne;i===ie&&(t.items.splice(e,1),e-=1)}}}else if(J(t)){r=Object.freeze(r.concat(t));const e=await le("key",t.key,n,r);if(e===ne)return ne;e===ie&&(t.key=null);const i=await le("value",t.value,n,r);if(i===ne)return ne;i===ie&&(t.value=null)}return i}function ce(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function ue(e,t,n,r){return"function"==typeof n?n(e,t,r):H(t)?n.Map?.(e,t,r):Q(t)?n.Seq?.(e,t,r):J(t)?n.Pair?.(e,t,r):X(t)?n.Scalar?.(e,t,r):G(t)?n.Alias?.(e,t,r):void 0}function fe(e,t,n){const r=t[t.length-1];if(Z(r))r.items[e]=n;else if(J(r))"key"===e?r.key=n:r.value=n;else{if(!W(r)){const e=G(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${e} parent`)}r.contents=n}}oe.BREAK=ne,oe.SKIP=re,oe.REMOVE=ie,ae.BREAK=ne,ae.SKIP=re,ae.REMOVE=ie;const pe={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"};class he{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},he.defaultYaml,e),this.tags=Object.assign({},he.defaultTags,t)}clone(){const e=new he(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new he(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:he.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},he.defaultTags)}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:he.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},he.defaultTags),this.atNextDocument=!1);const n=e.trim().split(/[ \t]+/),r=n.shift();switch(r){case"%TAG":{if(2!==n.length&&(t(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;const[e,r]=n;return this.tags[e]=r,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==n.length)return t(0,"%YAML directive should contain exactly one part"),!1;const[e]=n;return"1.1"===e||"1.2"===e?(this.yaml.version=e,!0):(t(6,`Unsupported YAML version ${e}`,/^\d+\.\d+$/.test(e)),!1)}default:return t(0,`Unknown directive ${r}`,!0),!1}}tagName(e,t){if("!"===e)return"!";if("!"!==e[0])return t(`Not a valid tag: ${e}`),null;if("<"===e[1]){const n=e.slice(2,-1);return"!"===n||"!!"===n?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&t("Verbatim tags must end with a >"),n)}const[,n,r]=e.match(/^(.*!)([^!]*)$/);r||t(`The ${e} tag has no suffix`);const i=this.tags[n];return i?i+decodeURIComponent(r):"!"===n?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,n]of Object.entries(this.tags))if(e.startsWith(n))return t+e.substring(n.length).replace(/[!,[\]{}]/g,(e=>pe[e]));return"!"===e[0]?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags);let r;if(e&&n.length>0&&ee(e.contents)){const t={};oe(e.contents,((e,n)=>{ee(n)&&n.tag&&(t[n.tag]=!0)})),r=Object.keys(t)}else r=[];for(const[i,o]of n)"!!"===i&&"tag:yaml.org,2002:"===o||e&&!r.some((e=>e.startsWith(o)))||t.push(`%TAG ${i} ${o}`);return t.join("\n")}}function de(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const t=JSON.stringify(e);throw new Error(`Anchor must not contain whitespace or control characters: ${t}`)}return!0}function me(e){const t=new Set;return oe(e,{Value(e,n){n.anchor&&t.add(n.anchor)}}),t}function ye(e,t){for(let n=1;;++n){const r=`${e}${n}`;if(!t.has(r))return r}}he.defaultYaml={explicit:!1,version:"1.2"},he.defaultTags={"!!":"tag:yaml.org,2002:"};class ge extends te{constructor(e){super($),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let t;return oe(e,{Node:(e,n)=>{if(n===this)return oe.BREAK;n.anchor===this.source&&(t=n)}}),t}toJSON(e,t){if(!t)return{source:this.source};const{anchors:n,doc:r,maxAliasCount:i}=t,o=this.resolve(r);if(!o){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(e)}const s=n.get(o);if(!s||void 0===s.res)throw new ReferenceError("This should not happen: Alias anchor was not resolved?");if(i>=0&&(s.count+=1,0===s.aliasCount&&(s.aliasCount=ve(r,o,n)),s.count*s.aliasCount>i))throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack");return s.res}toString(e,t,n){const r=`*${this.source}`;if(e){if(de(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(e)}if(e.implicitKey)return`${r} `}return r}}function ve(e,t,n){if(G(t)){const r=t.resolve(e),i=n&&r&&n.get(r);return i?i.count*i.aliasCount:0}if(Z(t)){let r=0;for(const i of t.items){const t=ve(e,i,n);t>r&&(r=t)}return r}if(J(t)){const r=ve(e,t.key,n),i=ve(e,t.value,n);return Math.max(r,i)}return 1}function be(e,t,n){if(Array.isArray(e))return e.map(((e,t)=>be(e,String(t),n)));if(e&&"function"==typeof e.toJSON){if(!n||!X(r=e)&&!Z(r)||!r.anchor)return e.toJSON(t,n);const i={aliasCount:0,count:1,res:void 0};n.anchors.set(e,i),n.onCreate=e=>{i.res=e,delete n.onCreate};const o=e.toJSON(t,n);return n.onCreate&&n.onCreate(o),o}var r;return"bigint"!=typeof e||n?.keep?e:Number(e)}const we=e=>!e||"function"!=typeof e&&"object"!=typeof e;class _e extends te{constructor(e){super(U),this.value=e}toJSON(e,t){return t?.keep?this.value:be(this.value,e,t)}toString(){return String(this.value)}}function ke(e,t,n){if(W(e)&&(e=e.contents),ee(e))return e;if(J(e)){const t=n.schema[V].createNode?.(n.schema,null,n);return t.items.push(e),t}(e instanceof String||e instanceof Number||e instanceof Boolean||"undefined"!=typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:r,onAnchor:i,onTagObj:o,schema:s,sourceObjects:a}=n;let l;if(r&&e&&"object"==typeof e){if(l=a.get(e),l)return l.anchor||(l.anchor=i(e)),new ge(l.anchor);l={anchor:null,node:null},a.set(e,l)}t?.startsWith("!!")&&(t="tag:yaml.org,2002:"+t.slice(2));let c=function(e,t,n){if(t){const e=n.filter((e=>e.tag===t)),r=e.find((e=>!e.format))??e[0];if(!r)throw new Error(`Tag ${t} not found`);return r}return n.find((t=>t.identify?.(e)&&!t.format))}(e,t,s.tags);if(!c){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){const t=new _e(e);return l&&(l.node=t),t}c=e instanceof Map?s[V]:Symbol.iterator in Object(e)?s[z]:s[V]}o&&(o(c),delete n.onTagObj);const u=c?.createNode?c.createNode(n.schema,e,n):new _e(e);return t&&(u.tag=t),l&&(l.node=u),u}function xe(e,t,n){let r=n;for(let e=t.length-1;e>=0;--e){const n=t[e];if("number"==typeof n&&Number.isInteger(n)&&n>=0){const e=[];e[n]=r,r=e}else r=new Map([[n,r]])}return ke(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}_e.BLOCK_FOLDED="BLOCK_FOLDED",_e.BLOCK_LITERAL="BLOCK_LITERAL",_e.PLAIN="PLAIN",_e.QUOTE_DOUBLE="QUOTE_DOUBLE",_e.QUOTE_SINGLE="QUOTE_SINGLE";const Oe=e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done;class Se extends te{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map((t=>ee(t)||J(t)?t.clone(e):t)),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(Oe(e))this.add(t);else{const[n,...r]=e,i=this.get(n,!0);if(Z(i))i.addIn(r,t);else{if(void 0!==i||!this.schema)throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`);this.set(n,xe(this.schema,r,t))}}}deleteIn(e){const[t,...n]=e;if(0===n.length)return this.delete(t);const r=this.get(t,!0);if(Z(r))return r.deleteIn(n);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${n}`)}getIn(e,t){const[n,...r]=e,i=this.get(n,!0);return 0===r.length?!t&&X(i)?i.value:i:Z(i)?i.getIn(r,t):void 0}hasAllNullValues(e){return this.items.every((t=>{if(!J(t))return!1;const n=t.value;return null==n||e&&X(n)&&null==n.value&&!n.commentBefore&&!n.comment&&!n.tag}))}hasIn(e){const[t,...n]=e;if(0===n.length)return this.has(t);const r=this.get(t,!0);return!!Z(r)&&r.hasIn(n)}setIn(e,t){const[n,...r]=e;if(0===r.length)this.set(n,t);else{const e=this.get(n,!0);if(Z(e))e.setIn(r,t);else{if(void 0!==e||!this.schema)throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`);this.set(n,xe(this.schema,r,t))}}}}Se.maxFlowStringSingleLineLength=60;const Ee=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function Ae(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}const Te=(e,t,n)=>e.endsWith("\n")?Ae(n,t):n.includes("\n")?"\n"+Ae(n,t):(e.endsWith(" ")?"":" ")+n,Ce="flow",Ne="block",Le="quoted";function je(e,t,n="flow",{indentAtStart:r,lineWidth:i=80,minContentWidth:o=20,onFold:s,onOverflow:a}={}){if(!i||i<0)return e;const l=Math.max(1+o,1+i-t.length);if(e.length<=l)return e;const c=[],u={};let f,p,h=i-t.length;"number"==typeof r&&(r>i-Math.max(2,o)?c.push(0):h=i-r);let d,m=!1,y=-1,g=-1,v=-1;for(n===Ne&&(y=Pe(e,y),-1!==y&&(h=y+l));d=e[y+=1];){if(n===Le&&"\\"===d){switch(g=y,e[y+1]){case"x":y+=3;break;case"u":y+=5;break;case"U":y+=9;break;default:y+=1}v=y}if("\n"===d)n===Ne&&(y=Pe(e,y)),h=y+l,f=void 0;else{if(" "===d&&p&&" "!==p&&"\n"!==p&&"\t"!==p){const t=e[y+1];t&&" "!==t&&"\n"!==t&&"\t"!==t&&(f=y)}if(y>=h)if(f)c.push(f),h=f+l,f=void 0;else if(n===Le){for(;" "===p||"\t"===p;)p=d,d=e[y+=1],m=!0;const t=y>v+1?y-2:g-1;if(u[t])return e;c.push(t),u[t]=!0,h=t+l,f=void 0}else m=!0}p=d}if(m&&a&&a(),0===c.length)return e;s&&s();let b=e.slice(0,c[0]);for(let r=0;r<c.length;++r){const i=c[r],o=c[r+1]||e.length;0===i?b=`\n${t}${e.slice(0,o)}`:(n===Le&&u[i]&&(b+=`${e[i]}\\`),b+=`\n${t}${e.slice(i+1,o)}`)}return b}function Pe(e,t){let n=e[t+1];for(;" "===n||"\t"===n;){do{n=e[t+=1]}while(n&&"\n"!==n);n=e[t+1]}return t}const Ie=e=>({indentAtStart:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Me=e=>/^(%|---|\.\.\.)/m.test(e);function Re(e,t){const n=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return n;const{implicitKey:r}=t,i=t.options.doubleQuotedMinMultiLineLength,o=t.indent||(Me(e)?"  ":"");let s="",a=0;for(let e=0,t=n[e];t;t=n[++e])if(" "===t&&"\\"===n[e+1]&&"n"===n[e+2]&&(s+=n.slice(a,e)+"\\ ",e+=1,a=e,t="\\"),"\\"===t)switch(n[e+1]){case"u":{s+=n.slice(a,e);const t=n.substr(e+2,4);switch(t){case"0000":s+="\\0";break;case"0007":s+="\\a";break;case"000b":s+="\\v";break;case"001b":s+="\\e";break;case"0085":s+="\\N";break;case"00a0":s+="\\_";break;case"2028":s+="\\L";break;case"2029":s+="\\P";break;default:"00"===t.substr(0,2)?s+="\\x"+t.substr(2):s+=n.substr(e,6)}e+=5,a=e+1}break;case"n":if(r||'"'===n[e+2]||n.length<i)e+=1;else{for(s+=n.slice(a,e)+"\n\n";"\\"===n[e+2]&&"n"===n[e+3]&&'"'!==n[e+4];)s+="\n",e+=2;s+=o," "===n[e+2]&&(s+="\\"),e+=1,a=e+1}break;default:e+=1}return s=a?s+n.slice(a):n,r?s:je(s,o,Le,Ie(t))}function Be(e,t){if(!1===t.options.singleQuote||t.implicitKey&&e.includes("\n")||/[ \t]\n|\n[ \t]/.test(e))return Re(e,t);const n=t.indent||(Me(e)?"  ":""),r="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&\n${n}`)+"'";return t.implicitKey?r:je(r,n,Ce,Ie(t))}function De(e,t){const{singleQuote:n}=t.options;let r;if(!1===n)r=Re;else{const t=e.includes('"'),i=e.includes("'");r=t&&!i?Be:i&&!t?Re:n?Be:Re}return r(e,t)}function Fe({comment:e,type:t,value:n},r,i,o){const{blockQuote:s,commentString:a,lineWidth:l}=r.options;if(!s||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return De(n,r);const c=r.indent||(r.forceBlockIndent||Me(n)?"  ":""),u="literal"===s||"folded"!==s&&t!==_e.BLOCK_FOLDED&&(t===_e.BLOCK_LITERAL||!function(e,t,n){if(!t||t<0)return!1;const r=t-n,i=e.length;if(i<=r)return!1;for(let t=0,n=0;t<i;++t)if("\n"===e[t]){if(t-n>r)return!0;if(n=t+1,i-n<=r)return!1}return!0}(n,l,c.length));if(!n)return u?"|\n":">\n";let f,p;for(p=n.length;p>0;--p){const e=n[p-1];if("\n"!==e&&"\t"!==e&&" "!==e)break}let h=n.substring(p);const d=h.indexOf("\n");-1===d?f="-":n===h||d!==h.length-1?(f="+",o&&o()):f="",h&&(n=n.slice(0,-h.length),"\n"===h[h.length-1]&&(h=h.slice(0,-1)),h=h.replace(/\n+(?!\n|$)/g,`$&${c}`));let m,y=!1,g=-1;for(m=0;m<n.length;++m){const e=n[m];if(" "===e)y=!0;else{if("\n"!==e)break;g=m}}let v=n.substring(0,g<m?g+1:m);v&&(n=n.substring(v.length),v=v.replace(/\n+/g,`$&${c}`));let b=(u?"|":">")+(y?c?"2":"1":"")+f;return e&&(b+=" "+a(e.replace(/ ?[\r\n]+/g," ")),i&&i()),u?`${b}\n${c}${v}${n=n.replace(/\n+/g,`$&${c}`)}${h}`:`${b}\n${c}${je(`${v}${n=n.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`)}${h}`,c,Ne,Ie(r))}`}function $e(e,t,n,r){const{implicitKey:i,inFlow:o}=t,s="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)});let{type:a}=e;a!==_e.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(s.value)&&(a=_e.QUOTE_DOUBLE);const l=e=>{switch(e){case _e.BLOCK_FOLDED:case _e.BLOCK_LITERAL:return i||o?De(s.value,t):Fe(s,t,n,r);case _e.QUOTE_DOUBLE:return Re(s.value,t);case _e.QUOTE_SINGLE:return Be(s.value,t);case _e.PLAIN:return function(e,t,n,r){const{type:i,value:o}=e,{actualString:s,implicitKey:a,indent:l,inFlow:c}=t;if(a&&/[\n[\]{},]/.test(o)||c&&/[[\]{},]/.test(o))return De(o,t);if(!o||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(o))return a||c||!o.includes("\n")?De(o,t):Fe(e,t,n,r);if(!a&&!c&&i!==_e.PLAIN&&o.includes("\n"))return Fe(e,t,n,r);if(""===l&&Me(o))return t.forceBlockIndent=!0,Fe(e,t,n,r);const u=o.replace(/\n+/g,`$&\n${l}`);if(s){const e=e=>e.default&&"tag:yaml.org,2002:str"!==e.tag&&e.test?.test(u),{compat:n,tags:r}=t.doc.schema;if(r.some(e)||n?.some(e))return De(o,t)}return a?u:je(u,l,Ce,Ie(t))}(s,t,n,r);default:return null}};let c=l(a);if(null===c){const{defaultKeyType:e,defaultStringType:n}=t.options,r=i&&e||n;if(c=l(r),null===c)throw new Error(`Unsupported default string type ${r}`)}return c}function Ke(e,t){const n=Object.assign({blockQuote:!0,commentString:Ee,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let r;switch(n.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:e,indent:"",indentStep:"number"==typeof n.indent?" ".repeat(n.indent):"  ",inFlow:r,options:n}}function Ve(e,t,n,r){if(J(e))return e.toString(t,n,r);if(G(e)){if(t.doc.directives)return e.toString(t);if(t.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let i;const o=ee(e)?e:t.doc.createNode(e,{onTagObj:e=>i=e});i||(i=function(e,t){if(t.tag){const n=e.filter((e=>e.tag===t.tag));if(n.length>0)return n.find((e=>e.format===t.format))??n[0]}let n,r;if(X(t)){r=t.value;const i=e.filter((e=>e.identify?.(r)));n=i.find((e=>e.format===t.format))??i.find((e=>!e.format))}else r=t,n=e.find((e=>e.nodeClass&&r instanceof e.nodeClass));if(!n)throw new Error(`Tag not resolved for ${r?.constructor?.name??typeof r} value`);return n}(t.doc.schema.tags,o));const s=function(e,t,{anchors:n,doc:r}){if(!r.directives)return"";const i=[],o=(X(e)||Z(e))&&e.anchor;o&&de(o)&&(n.add(o),i.push(`&${o}`));const s=e.tag?e.tag:t.default?null:t.tag;return s&&i.push(r.directives.tagString(s)),i.join(" ")}(o,i,t);s.length>0&&(t.indentAtStart=(t.indentAtStart??0)+s.length+1);const a="function"==typeof i.stringify?i.stringify(o,t,n,r):X(o)?$e(o,t,n,r):o.toString(t,n,r);return s?X(o)||"{"===a[0]||"["===a[0]?`${s} ${a}`:`${s}\n${t.indent}${a}`:a}function qe(e,t){"debug"!==e&&"warn"!==e||("undefined"!=typeof process&&process.emitWarning?process.emitWarning(t):console.warn(t))}function Ue(e,t,{key:n,value:r}){if(e?.doc.schema.merge&&ze(n))if(r=G(r)?r.resolve(e.doc):r,Q(r))for(const n of r.items)Ye(e,t,n);else if(Array.isArray(r))for(const n of r)Ye(e,t,n);else Ye(e,t,r);else{const i=be(n,"",e);if(t instanceof Map)t.set(i,be(r,i,e));else if(t instanceof Set)t.add(i);else{const o=function(e,t,n){if(null===t)return"";if("object"!=typeof t)return String(t);if(ee(e)&&n&&n.doc){const t=Ke(n.doc,{});t.anchors=new Set;for(const e of n.anchors.keys())t.anchors.add(e.anchor);t.inFlow=!0,t.inStringifyKey=!0;const r=e.toString(t);if(!n.mapKeyWarned){let e=JSON.stringify(r);e.length>40&&(e=e.substring(0,36)+'..."'),qe(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return r}return JSON.stringify(t)}(n,i,e),s=be(r,o,e);o in t?Object.defineProperty(t,o,{value:s,writable:!0,enumerable:!0,configurable:!0}):t[o]=s}}return t}const ze=e=>"<<"===e||X(e)&&"<<"===e.value&&(!e.type||e.type===_e.PLAIN);function Ye(e,t,n){const r=e&&G(n)?n.resolve(e.doc):n;if(!H(r))throw new Error("Merge sources must be maps or map aliases");const i=r.toJSON(null,e,Map);for(const[e,n]of i)t instanceof Map?t.has(e)||t.set(e,n):t instanceof Set?t.add(e):Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0});return t}function Ge(e,t,n){const r=ke(e,void 0,n),i=ke(t,void 0,n);return new We(r,i)}class We{constructor(e,t=null){Object.defineProperty(this,Y,{value:q}),this.key=e,this.value=t}clone(e){let{key:t,value:n}=this;return ee(t)&&(t=t.clone(e)),ee(n)&&(n=n.clone(e)),new We(t,n)}toJSON(e,t){return Ue(t,t?.mapAsMap?new Map:{},this)}toString(e,t,n){return e?.doc?function({key:e,value:t},n,r,i){const{allNullValues:o,doc:s,indent:a,indentStep:l,options:{commentString:c,indentSeq:u,simpleKeys:f}}=n;let p=ee(e)&&e.comment||null;if(f){if(p)throw new Error("With simple keys, key nodes cannot have comments");if(Z(e))throw new Error("With simple keys, collection cannot be used as a key value")}let h=!f&&(!e||p&&null==t&&!n.inFlow||Z(e)||(X(e)?e.type===_e.BLOCK_FOLDED||e.type===_e.BLOCK_LITERAL:"object"==typeof e));n=Object.assign({},n,{allNullValues:!1,implicitKey:!h&&(f||!o),indent:a+l});let d=!1,m=!1,y=Ve(e,n,(()=>d=!0),(()=>m=!0));if(!h&&!n.inFlow&&y.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");h=!0}if(n.inFlow){if(o||null==t)return d&&r&&r(),""===y?"?":h?`? ${y}`:y}else if(o&&!f||null==t&&h)return y=`? ${y}`,p&&!d?y+=Te(y,n.indent,c(p)):m&&i&&i(),y;d&&(p=null),h?(p&&(y+=Te(y,n.indent,c(p))),y=`? ${y}\n${a}:`):(y=`${y}:`,p&&(y+=Te(y,n.indent,c(p))));let g="",v=null;ee(t)?(t.spaceBefore&&(g="\n"),t.commentBefore&&(g+=`\n${Ae(c(t.commentBefore),n.indent)}`),v=t.comment):t&&"object"==typeof t&&(t=s.createNode(t)),n.implicitKey=!1,h||p||!X(t)||(n.indentAtStart=y.length+1),m=!1,u||!(l.length>=2)||n.inFlow||h||!Q(t)||t.flow||t.tag||t.anchor||(n.indent=n.indent.substr(2));let b=!1;const w=Ve(t,n,(()=>b=!0),(()=>m=!0));let _=" ";return g||p?_=""!==w||n.inFlow?`${g}\n${n.indent}`:"\n"===g?"\n\n":g:!h&&Z(t)?("["===w[0]||"{"===w[0])&&!w.includes("\n")||(_=`\n${n.indent}`):""!==w&&"\n"!==w[0]||(_=""),y+=_+w,n.inFlow?b&&r&&r():v&&!b?y+=Te(y,n.indent,c(v)):m&&i&&i(),y}(this,e,t,n):JSON.stringify(this)}}function He(e,t,n){return(t.inFlow??e.flow?Xe:Je)(e,t,n)}function Je({comment:e,items:t},n,{blockItemPrefix:r,flowChars:i,itemIndent:o,onChompKeep:s,onComment:a}){const{indent:l,options:{commentString:c}}=n,u=Object.assign({},n,{indent:o,type:null});let f=!1;const p=[];for(let e=0;e<t.length;++e){const i=t[e];let s=null;if(ee(i))!f&&i.spaceBefore&&p.push(""),Qe(n,p,i.commentBefore,f),i.comment&&(s=i.comment);else if(J(i)){const e=ee(i.key)?i.key:null;e&&(!f&&e.spaceBefore&&p.push(""),Qe(n,p,e.commentBefore,f))}f=!1;let a=Ve(i,u,(()=>s=null),(()=>f=!0));s&&(a+=Te(a,o,c(s))),f&&s&&(f=!1),p.push(r+a)}let h;if(0===p.length)h=i.start+i.end;else{h=p[0];for(let e=1;e<p.length;++e){const t=p[e];h+=t?`\n${l}${t}`:"\n"}}return e?(h+="\n"+Ae(c(e),l),a&&a()):f&&s&&s(),h}function Xe({comment:e,items:t},n,{flowChars:r,itemIndent:i,onComment:o}){const{indent:s,indentStep:a,options:{commentString:l}}=n;i+=a;const c=Object.assign({},n,{indent:i,inFlow:!0,type:null});let u=!1,f=0;const p=[];for(let e=0;e<t.length;++e){const r=t[e];let o=null;if(ee(r))r.spaceBefore&&p.push(""),Qe(n,p,r.commentBefore,!1),r.comment&&(o=r.comment);else if(J(r)){const e=ee(r.key)?r.key:null;e&&(e.spaceBefore&&p.push(""),Qe(n,p,e.commentBefore,!1),e.comment&&(u=!0));const t=ee(r.value)?r.value:null;t?(t.comment&&(o=t.comment),t.commentBefore&&(u=!0)):null==r.value&&e&&e.comment&&(o=e.comment)}o&&(u=!0);let s=Ve(r,c,(()=>o=null));e<t.length-1&&(s+=","),o&&(s+=Te(s,i,l(o))),!u&&(p.length>f||s.includes("\n"))&&(u=!0),p.push(s),f=p.length}let h;const{start:d,end:m}=r;if(0===p.length)h=d+m;else if(u||(u=p.reduce(((e,t)=>e+t.length+2),2)>Se.maxFlowStringSingleLineLength),u){h=d;for(const e of p)h+=e?`\n${a}${s}${e}`:"\n";h+=`\n${s}${m}`}else h=`${d} ${p.join(" ")} ${m}`;return e&&(h+=Te(h,l(e),s),o&&o()),h}function Qe({indent:e,options:{commentString:t}},n,r,i){if(r&&i&&(r=r.replace(/^\n+/,"")),r){const i=Ae(t(r),e);n.push(i.trimStart())}}function Ze(e,t){const n=X(t)?t.value:t;for(const r of e)if(J(r)){if(r.key===t||r.key===n)return r;if(X(r.key)&&r.key.value===n)return r}}class et extends Se{constructor(e){super(V,e),this.items=[]}static get tagName(){return"tag:yaml.org,2002:map"}add(e,t){let n;n=J(e)?e:e&&"object"==typeof e&&"key"in e?new We(e.key,e.value):new We(e,e?.value);const r=Ze(this.items,n.key),i=this.schema?.sortMapEntries;if(r){if(!t)throw new Error(`Key ${n.key} already set`);X(r.value)&&we(n.value)?r.value.value=n.value:r.value=n.value}else if(i){const e=this.items.findIndex((e=>i(n,e)<0));-1===e?this.items.push(n):this.items.splice(e,0,n)}else this.items.push(n)}delete(e){const t=Ze(this.items,e);return!!t&&this.items.splice(this.items.indexOf(t),1).length>0}get(e,t){const n=Ze(this.items,e)?.value;return(!t&&X(n)?n.value:n)??void 0}has(e){return!!Ze(this.items,e)}set(e,t){this.add(new We(e,t),!0)}toJSON(e,t,n){const r=n?new n:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(r);for(const e of this.items)Ue(t,r,e);return r}toString(e,t,n){if(!e)return JSON.stringify(this);for(const e of this.items)if(!J(e))throw new Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),He(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:n,onComment:t})}}const tt={collection:"map",createNode:function(e,t,n){const{keepUndefined:r,replacer:i}=n,o=new et(e),s=(e,s)=>{if("function"==typeof i)s=i.call(t,e,s);else if(Array.isArray(i)&&!i.includes(e))return;(void 0!==s||r)&&o.items.push(Ge(e,s,n))};if(t instanceof Map)for(const[e,n]of t)s(e,n);else if(t&&"object"==typeof t)for(const e of Object.keys(t))s(e,t[e]);return"function"==typeof e.sortMapEntries&&o.items.sort(e.sortMapEntries),o},default:!0,nodeClass:et,tag:"tag:yaml.org,2002:map",resolve:(e,t)=>(H(e)||t("Expected a mapping for this tag"),e)};class nt extends Se{constructor(e){super(z,e),this.items=[]}static get tagName(){return"tag:yaml.org,2002:seq"}add(e){this.items.push(e)}delete(e){const t=rt(e);return"number"==typeof t&&this.items.splice(t,1).length>0}get(e,t){const n=rt(e);if("number"!=typeof n)return;const r=this.items[n];return!t&&X(r)?r.value:r}has(e){const t=rt(e);return"number"==typeof t&&t<this.items.length}set(e,t){const n=rt(e);if("number"!=typeof n)throw new Error(`Expected a valid index, not ${e}.`);const r=this.items[n];X(r)&&we(t)?r.value=t:this.items[n]=t}toJSON(e,t){const n=[];t?.onCreate&&t.onCreate(n);let r=0;for(const e of this.items)n.push(be(e,String(r++),t));return n}toString(e,t,n){return e?He(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:n,onComment:t}):JSON.stringify(this)}}function rt(e){let t=X(e)?e.value:e;return t&&"string"==typeof t&&(t=Number(t)),"number"==typeof t&&Number.isInteger(t)&&t>=0?t:null}const it={collection:"seq",createNode:function(e,t,n){const{replacer:r}=n,i=new nt(e);if(t&&Symbol.iterator in Object(t)){let e=0;for(let o of t){if("function"==typeof r){const n=t instanceof Set?o:String(e++);o=r.call(t,n,o)}i.items.push(ke(o,void 0,n))}}return i},default:!0,nodeClass:nt,tag:"tag:yaml.org,2002:seq",resolve:(e,t)=>(Q(e)||t("Expected a sequence for this tag"),e)},ot={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,t,n,r)=>$e(e,t=Object.assign({actualString:!0},t),n,r)},st={identify:e=>null==e,createNode:()=>new _e(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new _e(null),stringify:({source:e},t)=>"string"==typeof e&&st.test.test(e)?e:t.options.nullStr},at={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new _e("t"===e[0]||"T"===e[0]),stringify:({source:e,value:t},n)=>e&&at.test.test(e)&&t===("t"===e[0]||"T"===e[0])?e:t?n.options.trueStr:n.options.falseStr};function lt({format:e,minFractionDigits:t,tag:n,value:r}){if("bigint"==typeof r)return String(r);const i="number"==typeof r?r:Number(r);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let o=JSON.stringify(r);if(!e&&t&&(!n||"tag:yaml.org,2002:float"===n)&&/^\d/.test(o)){let e=o.indexOf(".");e<0&&(e=o.length,o+=".");let n=t-(o.length-e-1);for(;n-- >0;)o+="0"}return o}const ct={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:lt},ut={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():lt(e)}},ft={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new _e(parseFloat(e)),n=e.indexOf(".");return-1!==n&&"0"===e[e.length-1]&&(t.minFractionDigits=e.length-n-1),t},stringify:lt},pt=e=>"bigint"==typeof e||Number.isInteger(e),ht=(e,t,n,{intAsBigInt:r})=>r?BigInt(e):parseInt(e.substring(t),n);function dt(e,t,n){const{value:r}=e;return pt(r)&&r>=0?n+r.toString(t):lt(e)}const mt={identify:e=>pt(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,n)=>ht(e,2,8,n),stringify:e=>dt(e,8,"0o")},yt={identify:pt,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,n)=>ht(e,0,10,n),stringify:lt},gt={identify:e=>pt(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,n)=>ht(e,2,16,n),stringify:e=>dt(e,16,"0x")},vt=[tt,it,ot,st,at,mt,yt,gt,ct,ut,ft];function bt(e){return"bigint"==typeof e||Number.isInteger(e)}const wt=({value:e})=>JSON.stringify(e),_t=[{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:wt},{identify:e=>null==e,createNode:()=>new _e(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:wt},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:e=>"true"===e,stringify:wt},{identify:bt,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>bt(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:wt}],kt={default:!0,tag:"",test:/^/,resolve:(e,t)=>(t(`Unresolved plain scalar ${JSON.stringify(e)}`),e)},xt=[tt,it].concat(_t,kt),Ot={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if("function"==typeof Buffer)return Buffer.from(e,"base64");if("function"==typeof atob){const t=atob(e.replace(/[\n\r]/g,"")),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:n},r,i,o){const s=n;let a;if("function"==typeof Buffer)a=s instanceof Buffer?s.toString("base64"):Buffer.from(s.buffer).toString("base64");else{if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let e="";for(let t=0;t<s.length;++t)e+=String.fromCharCode(s[t]);a=btoa(e)}}if(t||(t=_e.BLOCK_LITERAL),t!==_e.QUOTE_DOUBLE){const e=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),n=Math.ceil(a.length/e),i=new Array(n);for(let t=0,r=0;t<n;++t,r+=e)i[t]=a.substr(r,e);a=i.join(t===_e.BLOCK_LITERAL?"\n":" ")}return $e({comment:e,type:t,value:a},r,i,o)}};function St(e,t){if(Q(e))for(let n=0;n<e.items.length;++n){let r=e.items[n];if(!J(r)){if(H(r)){r.items.length>1&&t("Each pair must have its own sequence indicator");const e=r.items[0]||new We(new _e(null));if(r.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${r.commentBefore}\n${e.key.commentBefore}`:r.commentBefore),r.comment){const t=e.value??e.key;t.comment=t.comment?`${r.comment}\n${t.comment}`:r.comment}r=e}e.items[n]=J(r)?r:new We(r)}}else t("Expected a sequence for this tag");return e}function Et(e,t,n){const{replacer:r}=n,i=new nt(e);i.tag="tag:yaml.org,2002:pairs";let o=0;if(t&&Symbol.iterator in Object(t))for(let e of t){let s,a;if("function"==typeof r&&(e=r.call(t,String(o++),e)),Array.isArray(e)){if(2!==e.length)throw new TypeError(`Expected [key, value] tuple: ${e}`);s=e[0],a=e[1]}else if(e&&e instanceof Object){const t=Object.keys(e);if(1!==t.length)throw new TypeError(`Expected { key: value } tuple: ${e}`);s=t[0],a=e[s]}else s=e;i.items.push(Ge(s,a,n))}return i}const At={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:St,createNode:Et};class Tt extends nt{constructor(){super(),this.add=et.prototype.add.bind(this),this.delete=et.prototype.delete.bind(this),this.get=et.prototype.get.bind(this),this.has=et.prototype.has.bind(this),this.set=et.prototype.set.bind(this),this.tag=Tt.tag}toJSON(e,t){if(!t)return super.toJSON(e);const n=new Map;t?.onCreate&&t.onCreate(n);for(const e of this.items){let r,i;if(J(e)?(r=be(e.key,"",t),i=be(e.value,r,t)):r=be(e,"",t),n.has(r))throw new Error("Ordered maps must not include duplicate keys");n.set(r,i)}return n}}Tt.tag="tag:yaml.org,2002:omap";const Ct={collection:"seq",identify:e=>e instanceof Map,nodeClass:Tt,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const n=St(e,t),r=[];for(const{key:e}of n.items)X(e)&&(r.includes(e.value)?t(`Ordered maps must not include duplicate keys: ${e.value}`):r.push(e.value));return Object.assign(new Tt,n)},createNode(e,t,n){const r=Et(e,t,n),i=new Tt;return i.items=r.items,i}};function Nt({value:e,source:t},n){return t&&(e?Lt:jt).test.test(t)?t:e?n.options.trueStr:n.options.falseStr}const Lt={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new _e(!0),stringify:Nt},jt={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new _e(!1),stringify:Nt},Pt={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:lt},It={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():lt(e)}},Mt={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new _e(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(-1!==n){const r=e.substring(n+1).replace(/_/g,"");"0"===r[r.length-1]&&(t.minFractionDigits=r.length)}return t},stringify:lt},Rt=e=>"bigint"==typeof e||Number.isInteger(e);function Bt(e,t,n,{intAsBigInt:r}){const i=e[0];if("-"!==i&&"+"!==i||(t+=1),e=e.substring(t).replace(/_/g,""),r){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}const t=BigInt(e);return"-"===i?BigInt(-1)*t:t}const o=parseInt(e,n);return"-"===i?-1*o:o}function Dt(e,t,n){const{value:r}=e;if(Rt(r)){const e=r.toString(t);return r<0?"-"+n+e.substr(1):n+e}return lt(e)}const Ft={identify:Rt,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,n)=>Bt(e,2,2,n),stringify:e=>Dt(e,2,"0b")},$t={identify:Rt,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,n)=>Bt(e,1,8,n),stringify:e=>Dt(e,8,"0")},Kt={identify:Rt,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,n)=>Bt(e,0,10,n),stringify:lt},Vt={identify:Rt,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,n)=>Bt(e,2,16,n),stringify:e=>Dt(e,16,"0x")};class qt extends et{constructor(e){super(e),this.tag=qt.tag}add(e){let t;t=J(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new We(e.key,null):new We(e,null),Ze(this.items,t.key)||this.items.push(t)}get(e,t){const n=Ze(this.items,e);return!t&&J(n)?X(n.key)?n.key.value:n.key:n}set(e,t){if("boolean"!=typeof t)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof t);const n=Ze(this.items,e);n&&!t?this.items.splice(this.items.indexOf(n),1):!n&&t&&this.items.push(new We(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,n){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,n);throw new Error("Set items must all have null values")}}qt.tag="tag:yaml.org,2002:set";const Ut={collection:"map",identify:e=>e instanceof Set,nodeClass:qt,default:!1,tag:"tag:yaml.org,2002:set",resolve(e,t){if(H(e)){if(e.hasAllNullValues(!0))return Object.assign(new qt,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e},createNode(e,t,n){const{replacer:r}=n,i=new qt(e);if(t&&Symbol.iterator in Object(t))for(let e of t)"function"==typeof r&&(e=r.call(t,e,e)),i.items.push(Ge(e,null,n));return i}};function zt(e,t){const n=e[0],r="-"===n||"+"===n?e.substring(1):e,i=e=>t?BigInt(e):Number(e),o=r.replace(/_/g,"").split(":").reduce(((e,t)=>e*i(60)+i(t)),i(0));return"-"===n?i(-1)*o:o}function Yt(e){let{value:t}=e,n=e=>e;if("bigint"==typeof t)n=e=>BigInt(e);else if(isNaN(t)||!isFinite(t))return lt(e);let r="";t<0&&(r="-",t*=n(-1));const i=n(60),o=[t%i];return t<60?o.unshift(0):(t=(t-o[0])/i,o.unshift(t%i),t>=60&&(t=(t-o[0])/i,o.unshift(t))),r+o.map((e=>e<10?"0"+String(e):String(e))).join(":").replace(/000000\d*$/,"")}const Gt={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:n})=>zt(e,n),stringify:Yt},Wt={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>zt(e,!1),stringify:Yt},Ht={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(Ht.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,r,i,o,s,a]=t.map(Number),l=t[7]?Number((t[7]+"00").substr(1,3)):0;let c=Date.UTC(n,r-1,i,o||0,s||0,a||0,l);const u=t[8];if(u&&"Z"!==u){let e=zt(u,!1);Math.abs(e)<30&&(e*=60),c-=6e4*e}return new Date(c)},stringify:({value:e})=>e.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},Jt=[tt,it,ot,st,Lt,jt,Ft,$t,Kt,Vt,Pt,It,Mt,Ot,Ct,At,Ut,Gt,Wt,Ht],Xt=new Map([["core",vt],["failsafe",[tt,it,ot]],["json",xt],["yaml11",Jt],["yaml-1.1",Jt]]),Qt={binary:Ot,bool:at,float:ft,floatExp:ut,floatNaN:ct,floatTime:Wt,int:yt,intHex:gt,intOct:mt,intTime:Gt,map:tt,null:st,omap:Ct,pairs:At,seq:it,set:Ut,timestamp:Ht},Zt={"tag:yaml.org,2002:binary":Ot,"tag:yaml.org,2002:omap":Ct,"tag:yaml.org,2002:pairs":At,"tag:yaml.org,2002:set":Ut,"tag:yaml.org,2002:timestamp":Ht};function en(e,t){let n=Xt.get(t);if(!n){if(!Array.isArray(e)){const e=Array.from(Xt.keys()).filter((e=>"yaml11"!==e)).map((e=>JSON.stringify(e))).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${e} or define customTags array`)}n=[]}if(Array.isArray(e))for(const t of e)n=n.concat(t);else"function"==typeof e&&(n=e(n.slice()));return n.map((e=>{if("string"!=typeof e)return e;const t=Qt[e];if(t)return t;const n=Object.keys(Qt).map((e=>JSON.stringify(e))).join(", ");throw new Error(`Unknown custom tag "${e}"; use one of ${n}`)}))}const tn=(e,t)=>e.key<t.key?-1:e.key>t.key?1:0;class nn{constructor({compat:e,customTags:t,merge:n,resolveKnownTags:r,schema:i,sortMapEntries:o,toStringDefaults:s}){this.compat=Array.isArray(e)?en(e,"compat"):e?en(null,e):null,this.merge=!!n,this.name="string"==typeof i&&i||"core",this.knownTags=r?Zt:{},this.tags=en(t,this.name),this.toStringOptions=s??null,Object.defineProperty(this,V,{value:tt}),Object.defineProperty(this,U,{value:ot}),Object.defineProperty(this,z,{value:it}),this.sortMapEntries="function"==typeof o?o:!0===o?tn:null}clone(){const e=Object.create(nn.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function rn(e,t,n,r){if(r&&"object"==typeof r)if(Array.isArray(r))for(let t=0,n=r.length;t<n;++t){const n=r[t],i=rn(e,r,String(t),n);void 0===i?delete r[t]:i!==n&&(r[t]=i)}else if(r instanceof Map)for(const t of Array.from(r.keys())){const n=r.get(t),i=rn(e,r,t,n);void 0===i?r.delete(t):i!==n&&r.set(t,i)}else if(r instanceof Set)for(const t of Array.from(r)){const n=rn(e,r,t,t);void 0===n?r.delete(t):n!==t&&(r.delete(t),r.add(n))}else for(const[t,n]of Object.entries(r)){const i=rn(e,r,t,n);void 0===i?delete r[t]:i!==n&&(r[t]=i)}return e.call(t,n,r)}class on{constructor(e,t,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Y,{value:K});let r=null;"function"==typeof t||Array.isArray(t)?r=t:void 0===n&&t&&(n=t,t=void 0);const i=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},n);this.options=i;let{version:o}=i;n?._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new he({version:o}),this.setSchema(o,n),this.contents=void 0===e?null:this.createNode(e,r,n)}clone(){const e=Object.create(on.prototype,{[Y]:{value:K}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=ee(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){sn(this.contents)&&this.contents.add(e)}addIn(e,t){sn(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const n=me(this);e.anchor=!t||n.has(t)?ye(t||"a",n):t}return new ge(e.anchor)}createNode(e,t,n){let r;if("function"==typeof t)e=t.call({"":e},"",e),r=t;else if(Array.isArray(t)){const e=e=>"number"==typeof e||e instanceof String||e instanceof Number,n=t.filter(e).map(String);n.length>0&&(t=t.concat(n)),r=t}else void 0===n&&t&&(n=t,t=void 0);const{aliasDuplicateObjects:i,anchorPrefix:o,flow:s,keepUndefined:a,onTagObj:l,tag:c}=n??{},{onAnchor:u,setAnchors:f,sourceObjects:p}=function(e,t){const n=[],r=new Map;let i=null;return{onAnchor:r=>{n.push(r),i||(i=me(e));const o=ye(t,i);return i.add(o),o},setAnchors:()=>{for(const e of n){const t=r.get(e);if("object"!=typeof t||!t.anchor||!X(t.node)&&!Z(t.node)){const t=new Error("Failed to resolve repeated object (this should not happen)");throw t.source=e,t}t.node.anchor=t.anchor}},sourceObjects:r}}(this,o||"a"),h=ke(e,c,{aliasDuplicateObjects:i??!0,keepUndefined:a??!1,onAnchor:u,onTagObj:l,replacer:r,schema:this.schema,sourceObjects:p});return s&&Z(h)&&(h.flow=!0),f(),h}createPair(e,t,n={}){const r=this.createNode(e,null,n),i=this.createNode(t,null,n);return new We(r,i)}delete(e){return!!sn(this.contents)&&this.contents.delete(e)}deleteIn(e){return Oe(e)?null!=this.contents&&(this.contents=null,!0):!!sn(this.contents)&&this.contents.deleteIn(e)}get(e,t){return Z(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return Oe(e)?!t&&X(this.contents)?this.contents.value:this.contents:Z(this.contents)?this.contents.getIn(e,t):void 0}has(e){return!!Z(this.contents)&&this.contents.has(e)}hasIn(e){return Oe(e)?void 0!==this.contents:!!Z(this.contents)&&this.contents.hasIn(e)}set(e,t){null==this.contents?this.contents=xe(this.schema,[e],t):sn(this.contents)&&this.contents.set(e,t)}setIn(e,t){Oe(e)?this.contents=t:null==this.contents?this.contents=xe(this.schema,Array.from(e),t):sn(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){let n;switch("number"==typeof e&&(e=String(e)),e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new he({version:"1.1"}),n={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new he({version:e}),n={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{const t=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${t}`)}}if(t.schema instanceof Object)this.schema=t.schema;else{if(!n)throw new Error("With a null YAML version, the { schema: Schema } option is required");this.schema=new nn(Object.assign(n,t))}}toJS({json:e,jsonArg:t,mapAsMap:n,maxAliasCount:r,onAnchor:i,reviver:o}={}){const s={anchors:new Map,doc:this,keep:!e,mapAsMap:!0===n,mapKeyWarned:!1,maxAliasCount:"number"==typeof r?r:100,stringify:Ve},a=be(this.contents,t??"",s);if("function"==typeof i)for(const{count:e,res:t}of s.anchors.values())i(t,e);return"function"==typeof o?rn(o,{"":a},"",a):a}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return function(e,t){const n=[];let r=!0===t.directives;if(!1!==t.directives&&e.directives){const t=e.directives.toString(e);t?(n.push(t),r=!0):e.directives.docStart&&(r=!0)}r&&n.push("---");const i=Ke(e,t),{commentString:o}=i.options;if(e.commentBefore){1!==n.length&&n.unshift("");const t=o(e.commentBefore);n.unshift(Ae(t,""))}let s=!1,a=null;if(e.contents){if(ee(e.contents)){if(e.contents.spaceBefore&&r&&n.push(""),e.contents.commentBefore){const t=o(e.contents.commentBefore);n.push(Ae(t,""))}i.forceBlockIndent=!!e.comment,a=e.contents.comment}const t=a?void 0:()=>s=!0;let l=Ve(e.contents,i,(()=>a=null),t);a&&(l+=Te(l,"",o(a))),"|"!==l[0]&&">"!==l[0]||"---"!==n[n.length-1]?n.push(l):n[n.length-1]=`--- ${l}`}else n.push(Ve(e.contents,i));if(e.directives?.docEnd)if(e.comment){const t=o(e.comment);t.includes("\n")?(n.push("..."),n.push(Ae(t,""))):n.push(`... ${t}`)}else n.push("...");else{let t=e.comment;t&&s&&(t=t.replace(/^\n+/,"")),t&&(s&&!a||""===n[n.length-1]||n.push(""),n.push(Ae(o(t),"")))}return n.join("\n")+"\n"}(this,e)}}function sn(e){if(Z(e))return!0;throw new Error("Expected a YAML collection as document contents")}class an extends Error{constructor(e,t,n,r){super(),this.name=e,this.code=n,this.message=r,this.pos=t}}class ln extends an{constructor(e,t,n){super("YAMLParseError",e,t,n)}}class cn extends an{constructor(e,t,n){super("YAMLWarning",e,t,n)}}const un=(e,t)=>n=>{if(-1===n.pos[0])return;n.linePos=n.pos.map((e=>t.linePos(e)));const{line:r,col:i}=n.linePos[0];n.message+=` at line ${r}, column ${i}`;let o=i-1,s=e.substring(t.lineStarts[r-1],t.lineStarts[r]).replace(/[\n\r]+$/,"");if(o>=60&&s.length>80){const e=Math.min(o-39,s.length-79);s="…"+s.substring(e),o-=e-1}if(s.length>80&&(s=s.substring(0,79)+"…"),r>1&&/^ *$/.test(s.substring(0,o))){let n=e.substring(t.lineStarts[r-2],t.lineStarts[r-1]);n.length>80&&(n=n.substring(0,79)+"…\n"),s=n+s}if(/[^ ]/.test(s)){let e=1;const t=n.linePos[1];t&&t.line===r&&t.col>i&&(e=Math.min(t.col-i,80-o));const a=" ".repeat(o)+"^".repeat(e);n.message+=`:\n\n${s}\n${a}\n`}};function fn(e,{flow:t,indicator:n,next:r,offset:i,onError:o,startOnNewline:s}){let a=!1,l=s,c=s,u="",f="",p=!1,h=!1,d=!1,m=null,y=null,g=null,v=null,b=null;for(const r of e)switch(d&&("space"!==r.type&&"newline"!==r.type&&"comma"!==r.type&&o(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),d=!1),r.type){case"space":!t&&l&&"doc-start"!==n&&"\t"===r.source[0]&&o(r,"TAB_AS_INDENT","Tabs are not allowed as indentation"),c=!0;break;case"comment":{c||o(r,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const e=r.source.substring(1)||" ";u?u+=f+e:u=e,f="",l=!1;break}case"newline":l?u?u+=r.source:a=!0:f+=r.source,l=!0,p=!0,(m||y)&&(h=!0),c=!0;break;case"anchor":m&&o(r,"MULTIPLE_ANCHORS","A node can have at most one anchor"),r.source.endsWith(":")&&o(r.offset+r.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),m=r,null===b&&(b=r.offset),l=!1,c=!1,d=!0;break;case"tag":y&&o(r,"MULTIPLE_TAGS","A node can have at most one tag"),y=r,null===b&&(b=r.offset),l=!1,c=!1,d=!0;break;case n:(m||y)&&o(r,"BAD_PROP_ORDER",`Anchors and tags must be after the ${r.source} indicator`),v&&o(r,"UNEXPECTED_TOKEN",`Unexpected ${r.source} in ${t??"collection"}`),v=r,l=!1,c=!1;break;case"comma":if(t){g&&o(r,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),g=r,l=!1,c=!1;break}default:o(r,"UNEXPECTED_TOKEN",`Unexpected ${r.type} token`),l=!1,c=!1}const w=e[e.length-1],_=w?w.offset+w.source.length:i;return d&&r&&"space"!==r.type&&"newline"!==r.type&&"comma"!==r.type&&("scalar"!==r.type||""!==r.source)&&o(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:g,found:v,spaceBefore:a,comment:u,hasNewline:p,hasNewlineAfterProp:h,anchor:m,tag:y,end:_,start:b??_}}function pn(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes("\n"))return!0;if(e.end)for(const t of e.end)if("newline"===t.type)return!0;return!1;case"flow-collection":for(const t of e.items){for(const e of t.start)if("newline"===e.type)return!0;if(t.sep)for(const e of t.sep)if("newline"===e.type)return!0;if(pn(t.key)||pn(t.value))return!0}return!1;default:return!0}}function hn(e,t,n){if("flow-collection"===t?.type){const r=t.end[0];r.indent!==e||"]"!==r.source&&"}"!==r.source||!pn(t)||n(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function dn(e,t,n){const{uniqueKeys:r}=e.options;if(!1===r)return!1;const i="function"==typeof r?r:(t,n)=>t===n||X(t)&&X(n)&&t.value===n.value&&!("<<"===t.value&&e.schema.merge);return t.some((e=>i(e.key,n)))}const mn="All mapping items must start at the same column";function yn(e,t,n,r){let i="";if(e){let o=!1,s="";for(const a of e){const{source:e,type:l}=a;switch(l){case"space":o=!0;break;case"comment":{n&&!o&&r(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const t=e.substring(1)||" ";i?i+=s+t:i=t,s="";break}case"newline":i&&(s+=e),o=!0;break;default:r(a,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}t+=e.length}}return{comment:i,offset:t}}const gn="Block collections are not allowed within flow collections",vn=e=>e&&("block-map"===e.type||"block-seq"===e.type);function bn(e){let t,n;try{t=new RegExp("(.*?)(?<![ \t])[ \t]*\r?\n","sy"),n=new RegExp("[ \t]*(.*?)(?:(?<![ \t])[ \t]*)?\r?\n","sy")}catch(e){t=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let r=t.exec(e);if(!r)return e;let i=r[1],o=" ",s=t.lastIndex;for(n.lastIndex=s;r=n.exec(e);)""===r[1]?"\n"===o?i+=o:o="\n":(i+=o+r[1],o=" "),s=n.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=s,r=a.exec(e),i+o+(r?.[1]??"")}function wn(e,t){let n="",r=e[t+1];for(;!(" "!==r&&"\t"!==r&&"\n"!==r&&"\r"!==r||"\r"===r&&"\n"!==e[t+2]);)"\n"===r&&(n+="\n"),r=e[(t+=1)+1];return n||(n=" "),{fold:n,offset:t}}const _n={0:"\0",a:"",b:"\b",e:"",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","\t":"\t"};function kn(e,t,n,r){const i=e.substr(t,n),o=i.length===n&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(o)){const i=e.substr(t-2,n+2);return r(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${i}`),i}return String.fromCodePoint(o)}function xn(e,t,n,r){const{value:i,type:o,comment:s,range:a}="block-scalar"===t.type?function(e,t,n){const r=e.offset,i=function({offset:e,props:t},n,r){if("block-scalar-header"!==t[0].type)return r(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=t[0],o=i[0];let s=0,a="",l=-1;for(let t=1;t<i.length;++t){const n=i[t];if(a||"-"!==n&&"+"!==n){const r=Number(n);!s&&r?s=r:-1===l&&(l=e+t)}else a=n}-1!==l&&r(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let c=!1,u="",f=i.length;for(let e=1;e<t.length;++e){const i=t[e];switch(i.type){case"space":c=!0;case"newline":f+=i.source.length;break;case"comment":n&&!c&&r(i,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=i.source.length,u=i.source.substring(1);break;case"error":r(i,"UNEXPECTED_TOKEN",i.message),f+=i.source.length;break;default:{r(i,"UNEXPECTED_TOKEN",`Unexpected token in block scalar header: ${i.type}`);const e=i.source;e&&"string"==typeof e&&(f+=e.length)}}}return{mode:o,indent:s,chomp:a,comment:u,length:f}}(e,t,n);if(!i)return{value:"",type:null,comment:"",range:[r,r,r]};const o=">"===i.mode?_e.BLOCK_FOLDED:_e.BLOCK_LITERAL,s=e.source?function(e){const t=e.split(/\n( *)/),n=t[0],r=n.match(/^( *)/),i=[r?.[1]?[r[1],n.slice(r[1].length)]:["",n]];for(let e=1;e<t.length;e+=2)i.push([t[e],t[e+1]]);return i}(e.source):[];let a=s.length;for(let e=s.length-1;e>=0;--e){const t=s[e][1];if(""!==t&&"\r"!==t)break;a=e}if(0===a){const t="+"===i.chomp&&s.length>0?"\n".repeat(Math.max(1,s.length-1)):"";let n=r+i.length;return e.source&&(n+=e.source.length),{value:t,type:o,comment:i.comment,range:[r,n,n]}}let l=e.indent+i.indent,c=e.offset+i.length,u=0;for(let e=0;e<a;++e){const[t,r]=s[e];if(""!==r&&"\r"!==r){if(t.length<l){const e="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";n(c+t.length,"MISSING_CHAR",e)}0===i.indent&&(l=t.length),u=e;break}0===i.indent&&t.length>l&&(l=t.length),c+=t.length+r.length+1}for(let e=s.length-1;e>=a;--e)s[e][0].length>l&&(a=e+1);let f="",p="",h=!1;for(let e=0;e<u;++e)f+=s[e][0].slice(l)+"\n";for(let e=u;e<a;++e){let[t,r]=s[e];c+=t.length+r.length+1;const a="\r"===r[r.length-1];if(a&&(r=r.slice(0,-1)),r&&t.length<l){const e="Block scalar lines must not be less indented than their "+(i.indent?"explicit indentation indicator":"first line");n(c-r.length-(a?2:1),"BAD_INDENT",e),t=""}o===_e.BLOCK_LITERAL?(f+=p+t.slice(l)+r,p="\n"):t.length>l||"\t"===r[0]?(" "===p?p="\n":h||"\n"!==p||(p="\n\n"),f+=p+t.slice(l)+r,p="\n",h=!0):""===r?"\n"===p?f+="\n":p="\n":(f+=p+r,p=" ",h=!1)}switch(i.chomp){case"-":break;case"+":for(let e=a;e<s.length;++e)f+="\n"+s[e][0].slice(l);"\n"!==f[f.length-1]&&(f+="\n");break;default:f+="\n"}const d=r+i.length+e.source.length;return{value:f,type:o,comment:i.comment,range:[r,d,d]}}(t,e.options.strict,r):function(e,t,n){const{offset:r,type:i,source:o,end:s}=e;let a,l;const c=(e,t,i)=>n(r+e,t,i);switch(i){case"scalar":a=_e.PLAIN,l=function(e,t){let n="";switch(e[0]){case"\t":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":n=`block scalar indicator ${e[0]}`;break;case"@":case"`":n=`reserved character ${e[0]}`}return n&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),bn(e)}(o,c);break;case"single-quoted-scalar":a=_e.QUOTE_SINGLE,l=function(e,t){return"'"===e[e.length-1]&&1!==e.length||t(e.length,"MISSING_CHAR","Missing closing 'quote"),bn(e.slice(1,-1)).replace(/''/g,"'")}(o,c);break;case"double-quoted-scalar":a=_e.QUOTE_DOUBLE,l=function(e,t){let n="";for(let r=1;r<e.length-1;++r){const i=e[r];if("\r"!==i||"\n"!==e[r+1])if("\n"===i){const{fold:t,offset:i}=wn(e,r);n+=t,r=i}else if("\\"===i){let i=e[++r];const o=_n[i];if(o)n+=o;else if("\n"===i)for(i=e[r+1];" "===i||"\t"===i;)i=e[1+ ++r];else if("\r"===i&&"\n"===e[r+1])for(i=e[1+ ++r];" "===i||"\t"===i;)i=e[1+ ++r];else if("x"===i||"u"===i||"U"===i){const o={x:2,u:4,U:8}[i];n+=kn(e,r+1,o,t),r+=o}else{const i=e.substr(r-1,2);t(r-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${i}`),n+=i}}else if(" "===i||"\t"===i){const t=r;let o=e[r+1];for(;" "===o||"\t"===o;)o=e[1+ ++r];"\n"===o||"\r"===o&&"\n"===e[r+2]||(n+=r>t?e.slice(t,r+1):i)}else n+=i}return'"'===e[e.length-1]&&1!==e.length||t(e.length,"MISSING_CHAR",'Missing closing "quote'),n}(o,c);break;default:return n(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[r,r+o.length,r+o.length]}}const u=r+o.length,f=yn(s,u,t,n);return{value:l,type:a,comment:f.comment,range:[r,u,f.offset]}}(t,e.options.strict,r),l=n?e.directives.tagName(n.source,(e=>r(n,"TAG_RESOLVE_FAILED",e))):null,c=n&&l?function(e,t,n,r,i){if("!"===n)return e[U];const o=[];for(const t of e.tags)if(!t.collection&&t.tag===n){if(!t.default||!t.test)return t;o.push(t)}for(const e of o)if(e.test?.test(t))return e;const s=e.knownTags[n];return s&&!s.collection?(e.tags.push(Object.assign({},s,{default:!1,test:void 0})),s):(i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,"tag:yaml.org,2002:str"!==n),e[U])}(e.schema,i,l,n,r):"scalar"===t.type?function({directives:e,schema:t},n,r,i){const o=t.tags.find((e=>e.default&&e.test?.test(n)))||t[U];if(t.compat){const s=t.compat.find((e=>e.default&&e.test?.test(n)))??t[U];o.tag!==s.tag&&i(r,"TAG_RESOLVE_FAILED",`Value may be parsed as either ${e.tagString(o.tag)} or ${e.tagString(s.tag)}`,!0)}return o}(e,i,t,r):e.schema[U];let u;try{const o=c.resolve(i,(e=>r(n??t,"TAG_RESOLVE_FAILED",e)),e.options);u=X(o)?o:new _e(o)}catch(e){const o=e instanceof Error?e.message:String(e);r(n??t,"TAG_RESOLVE_FAILED",o),u=new _e(i)}return u.range=a,u.source=i,o&&(u.type=o),l&&(u.tag=l),c.format&&(u.format=c.format),s&&(u.comment=s),u}function On(e,t,n){if(t){null===n&&(n=t.length);for(let r=n-1;r>=0;--r){let n=t[r];switch(n.type){case"space":case"comment":case"newline":e-=n.source.length;continue}for(n=t[++r];"space"===n?.type;)e+=n.source.length,n=t[++r];break}}return e}const Sn={composeNode:En,composeEmptyNode:An};function En(e,t,n,r){const{spaceBefore:i,comment:o,anchor:s,tag:a}=n;let l,c=!0;switch(t.type){case"alias":l=function({options:e},{offset:t,source:n,end:r},i){const o=new ge(n.substring(1));""===o.source&&i(t,"BAD_ALIAS","Alias cannot be an empty string"),o.source.endsWith(":")&&i(t+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const s=t+n.length,a=yn(r,s,e.strict,i);return o.range=[t,s,a.offset],a.comment&&(o.comment=a.comment),o}(e,t,r),(s||a)&&r(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=xn(e,t,a,r),s&&(l.anchor=s.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=function(e,t,n,r,i){let o;switch(n.type){case"block-map":o=function({composeNode:e,composeEmptyNode:t},n,r,i){const o=new et(n.schema);n.atRoot&&(n.atRoot=!1);let s=r.offset,a=null;for(const l of r.items){const{start:c,key:u,sep:f,value:p}=l,h=fn(c,{indicator:"explicit-key-ind",next:u??f?.[0],offset:s,onError:i,startOnNewline:!0}),d=!h.found;if(d){if(u&&("block-seq"===u.type?i(s,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in u&&u.indent!==r.indent&&i(s,"BAD_INDENT",mn)),!h.anchor&&!h.tag&&!f){a=h.end,h.comment&&(o.comment?o.comment+="\n"+h.comment:o.comment=h.comment);continue}(h.hasNewlineAfterProp||pn(u))&&i(u??c[c.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else h.found?.indent!==r.indent&&i(s,"BAD_INDENT",mn);const m=h.end,y=u?e(n,u,h,i):t(n,m,c,null,h,i);n.schema.compat&&hn(r.indent,u,i),dn(n,o.items,y)&&i(m,"DUPLICATE_KEY","Map keys must be unique");const g=fn(f??[],{indicator:"map-value-ind",next:p,offset:y.range[2],onError:i,startOnNewline:!u||"block-scalar"===u.type});if(s=g.end,g.found){d&&("block-map"!==p?.type||g.hasNewline||i(s,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&h.start<g.found.offset-1024&&i(y.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const a=p?e(n,p,g,i):t(n,s,f,null,g,i);n.schema.compat&&hn(r.indent,p,i),s=a.range[2];const c=new We(y,a);n.options.keepSourceTokens&&(c.srcToken=l),o.items.push(c)}else{d&&i(y.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),g.comment&&(y.comment?y.comment+="\n"+g.comment:y.comment=g.comment);const e=new We(y);n.options.keepSourceTokens&&(e.srcToken=l),o.items.push(e)}}return a&&a<s&&i(a,"IMPOSSIBLE","Map comment with trailing content"),o.range=[r.offset,s,a??s],o}(e,t,n,i);break;case"block-seq":o=function({composeNode:e,composeEmptyNode:t},n,r,i){const o=new nt(n.schema);n.atRoot&&(n.atRoot=!1);let s=r.offset,a=null;for(const{start:l,value:c}of r.items){const u=fn(l,{indicator:"seq-item-ind",next:c,offset:s,onError:i,startOnNewline:!0});if(!u.found){if(!(u.anchor||u.tag||c)){a=u.end,u.comment&&(o.comment=u.comment);continue}c&&"block-seq"===c.type?i(u.end,"BAD_INDENT","All sequence items must start at the same column"):i(s,"MISSING_CHAR","Sequence item without - indicator")}const f=c?e(n,c,u,i):t(n,u.end,l,null,u,i);n.schema.compat&&hn(r.indent,c,i),s=f.range[2],o.items.push(f)}return o.range=[r.offset,s,a??s],o}(e,t,n,i);break;case"flow-collection":o=function({composeNode:e,composeEmptyNode:t},n,r,i){const o="{"===r.start.source,s=o?"flow map":"flow sequence",a=o?new et(n.schema):new nt(n.schema);a.flow=!0;const l=n.atRoot;l&&(n.atRoot=!1);let c=r.offset+r.start.source.length;for(let l=0;l<r.items.length;++l){const u=r.items[l],{start:f,key:p,sep:h,value:d}=u,m=fn(f,{flow:s,indicator:"explicit-key-ind",next:p??h?.[0],offset:c,onError:i,startOnNewline:!1});if(!m.found){if(!(m.anchor||m.tag||h||d)){0===l&&m.comma?i(m.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${s}`):l<r.items.length-1&&i(m.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${s}`),m.comment&&(a.comment?a.comment+="\n"+m.comment:a.comment=m.comment),c=m.end;continue}!o&&n.options.strict&&pn(p)&&i(p,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===l)m.comma&&i(m.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${s}`);else if(m.comma||i(m.start,"MISSING_CHAR",`Missing , between ${s} items`),m.comment){let e="";e:for(const t of f)switch(t.type){case"comma":case"space":break;case"comment":e=t.source.substring(1);break e;default:break e}if(e){let t=a.items[a.items.length-1];J(t)&&(t=t.value??t.key),t.comment?t.comment+="\n"+e:t.comment=e,m.comment=m.comment.substring(e.length+1)}}if(o||h||m.found){const r=m.end,l=p?e(n,p,m,i):t(n,r,f,null,m,i);vn(p)&&i(l.range,"BLOCK_IN_FLOW",gn);const y=fn(h??[],{flow:s,indicator:"map-value-ind",next:d,offset:l.range[2],onError:i,startOnNewline:!1});if(y.found){if(!o&&!m.found&&n.options.strict){if(h)for(const e of h){if(e===y.found)break;if("newline"===e.type){i(e,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}m.start<y.found.offset-1024&&i(y.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else d&&("source"in d&&d.source&&":"===d.source[0]?i(d,"MISSING_CHAR",`Missing space after : in ${s}`):i(y.start,"MISSING_CHAR",`Missing , or : between ${s} items`));const g=d?e(n,d,y,i):y.found?t(n,y.end,h,null,y,i):null;g?vn(d)&&i(g.range,"BLOCK_IN_FLOW",gn):y.comment&&(l.comment?l.comment+="\n"+y.comment:l.comment=y.comment);const v=new We(l,g);if(n.options.keepSourceTokens&&(v.srcToken=u),o){const e=a;dn(n,e.items,l)&&i(r,"DUPLICATE_KEY","Map keys must be unique"),e.items.push(v)}else{const e=new et(n.schema);e.flow=!0,e.items.push(v),a.items.push(e)}c=g?g.range[2]:y.end}else{const r=d?e(n,d,m,i):t(n,m.end,h,null,m,i);a.items.push(r),c=r.range[2],vn(d)&&i(r.range,"BLOCK_IN_FLOW",gn)}}const u=o?"}":"]",[f,...p]=r.end;let h=c;if(f&&f.source===u)h=f.offset+f.source.length;else{const e=s[0].toUpperCase()+s.substring(1);i(c,l?"MISSING_CHAR":"BAD_INDENT",l?`${e} must end with a ${u}`:`${e} in block collection must be sufficiently indented and end with a ${u}`),f&&1!==f.source.length&&p.unshift(f)}if(p.length>0){const e=yn(p,h,n.options.strict,i);e.comment&&(a.comment?a.comment+="\n"+e.comment:a.comment=e.comment),a.range=[r.offset,h,e.offset]}else a.range=[r.offset,h,h];return a}(e,t,n,i)}if(!r)return o;const s=t.directives.tagName(r.source,(e=>i(r,"TAG_RESOLVE_FAILED",e)));if(!s)return o;const a=o.constructor;if("!"===s||s===a.tagName)return o.tag=a.tagName,o;const l=H(o)?"map":"seq";let c=t.schema.tags.find((e=>e.collection===l&&e.tag===s));if(!c){const e=t.schema.knownTags[s];if(!e||e.collection!==l)return i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${s}`,!0),o.tag=s,o;t.schema.tags.push(Object.assign({},e,{default:!1})),c=e}const u=c.resolve(o,(e=>i(r,"TAG_RESOLVE_FAILED",e)),t.options),f=ee(u)?u:new _e(u);return f.range=o.range,f.tag=s,c?.format&&(f.format=c.format),f}(Sn,e,t,a,r),s&&(l.anchor=s.source.substring(1));break;default:r(t,"UNEXPECTED_TOKEN","error"===t.type?t.message:`Unsupported token (type: ${t.type})`),l=An(e,t.offset,void 0,null,n,r),c=!1}return s&&""===l.anchor&&r(s,"BAD_ALIAS","Anchor cannot be an empty string"),i&&(l.spaceBefore=!0),o&&("scalar"===t.type&&""===t.source?l.comment=o:l.commentBefore=o),e.options.keepSourceTokens&&c&&(l.srcToken=t),l}function An(e,t,n,r,{spaceBefore:i,comment:o,anchor:s,tag:a,end:l},c){const u=xn(e,{type:"scalar",offset:On(t,n,r),indent:-1,source:""},a,c);return s&&(u.anchor=s.source.substring(1),""===u.anchor&&c(s,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(u.spaceBefore=!0),o&&(u.comment=o,u.range[2]=l),u}function Tn(e){if("number"==typeof e)return[e,e+1];if(Array.isArray(e))return 2===e.length?e:[e[0],e[1]];const{offset:t,source:n}=e;return[t,t+("string"==typeof n?n.length:1)]}function Cn(e){let t="",n=!1,r=!1;for(let i=0;i<e.length;++i){const o=e[i];switch(o[0]){case"#":t+=(""===t?"":r?"\n\n":"\n")+(o.substring(1)||" "),n=!0,r=!1;break;case"%":"#"!==e[i+1]?.[0]&&(i+=1),n=!1;break;default:n||(r=!0),n=!1}}return{comment:t,afterEmptyLine:r}}class Nn{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,t,n,r)=>{const i=Tn(e);r?this.warnings.push(new cn(i,t,n)):this.errors.push(new ln(i,t,n))},this.directives=new he({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:n,afterEmptyLine:r}=Cn(this.prelude);if(n){const i=e.contents;if(t)e.comment=e.comment?`${e.comment}\n${n}`:n;else if(r||e.directives.docStart||!i)e.commentBefore=n;else if(Z(i)&&!i.flow&&i.items.length>0){let e=i.items[0];J(e)&&(e=e.key);const t=e.commentBefore;e.commentBefore=t?`${n}\n${t}`:n}else{const e=i.commentBefore;i.commentBefore=e?`${n}\n${e}`:n}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Cn(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,n=-1){for(const t of e)yield*this.next(t);yield*this.end(t,n)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,((t,n,r)=>{const i=Tn(e);i[0]+=t,this.onError(i,"BAD_DIRECTIVE",n,r)})),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=function(e,t,{offset:n,start:r,value:i,end:o},s){const a=Object.assign({_directives:t},e),l=new on(void 0,a),c={atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},u=fn(r,{indicator:"doc-start",next:i??o?.[0],offset:n,onError:s,startOnNewline:!0});u.found&&(l.directives.docStart=!0,!i||"block-map"!==i.type&&"block-seq"!==i.type||u.hasNewline||s(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=i?En(c,i,u,s):An(c,u.end,r,null,u,s);const f=l.contents.range[2],p=yn(o,f,!1,s);return p.comment&&(l.comment=p.comment),l.range=[n,f,p.offset],l}(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,n=new ln(Tn(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){const t="Unexpected doc-end without preceding document";this.errors.push(new ln(Tn(e),"UNEXPECTED_TOKEN",t));break}this.doc.directives.docEnd=!0;const t=yn(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const e=this.doc.comment;this.doc.comment=e?`${e}\n${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new ln(Tn(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const e=Object.assign({_directives:this.directives},this.options),n=new on(void 0,e);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),n.range=[0,t,t],this.decorate(n,!1),yield n}}}const Ln=Symbol("break visit"),jn=Symbol("skip children"),Pn=Symbol("remove item");function In(e,t){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),Mn(Object.freeze([]),e,t)}function Mn(e,t,n){let r=n(t,e);if("symbol"==typeof r)return r;for(const i of["key","value"]){const o=t[i];if(o&&"items"in o){for(let t=0;t<o.items.length;++t){const r=Mn(Object.freeze(e.concat([[i,t]])),o.items[t],n);if("number"==typeof r)t=r-1;else{if(r===Ln)return Ln;r===Pn&&(o.items.splice(t,1),t-=1)}}"function"==typeof r&&"key"===i&&(r=r(t,e))}}return"function"==typeof r?r(t,e):r}In.BREAK=Ln,In.SKIP=jn,In.REMOVE=Pn,In.itemAtPath=(e,t)=>{let n=e;for(const[e,r]of t){const t=n?.[e];if(!t||!("items"in t))return;n=t.items[r]}return n},In.parentCollection=(e,t)=>{const n=In.itemAtPath(e,t.slice(0,-1))?.[t[t.length-1][0]];if(n&&"items"in n)return n;throw new Error("Parent collection not found")};function Rn(e){switch(e){case void 0:case" ":case"\n":case"\r":case"\t":return!0;default:return!1}}const Bn="0123456789ABCDEFabcdef".split(""),Dn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),Fn=",[]{}".split(""),$n=" ,[]{}\n\r\t".split(""),Kn=e=>!e||$n.includes(e);class Vn{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!t;let n=this.next??"stream";for(;n&&(t||this.hasChars(1));)n=yield*this.parseNext(n)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;" "===t||"\t"===t;)t=this.buffer[++e];return!t||"#"===t||"\n"===t||"\r"===t&&"\n"===this.buffer[e+1]}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let n=0;for(;" "===t;)t=this.buffer[++n+e];if("\r"===t){const t=this.buffer[n+e+1];if("\n"===t||!t&&!this.atEnd)return e+n+1}return"\n"===t||n>=this.indentNext||!t&&!this.atEnd?e+n:-1}if("-"===t||"."===t){const t=this.buffer.substr(e,3);if(("---"===t||"..."===t)&&Rn(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return("number"!=typeof e||-1!==e&&e<this.pos)&&(e=this.buffer.indexOf("\n",this.pos),this.lineEndPos=e),-1===e?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[e-1]&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(null===e)return this.setNext("stream");if("\ufeff"===e[0]&&(yield*this.pushCount(1),e=e.substring(1)),"%"===e[0]){let t=e.length;const n=e.indexOf("#");if(-1!==n){const r=e[n-1];" "!==r&&"\t"!==r||(t=n-1)}for(;;){const n=e[t-1];if(" "!==n&&"\t"!==n)break;t-=1}const r=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-r),this.pushNewline(),"stream"}if(this.atLineEnd()){const t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield"",yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if("-"===e||"."===e){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const e=this.peek(3);if("---"===e&&Rn(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if("..."===e&&Rn(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Rn(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if(("-"===e||"?"===e||":"===e)&&Rn(t)){const e=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=e,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(null===e)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Kn),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=(yield*this.parseBlockScalarHeader()),t+=(yield*this.pushSpaces(!0)),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,n=-1;do{e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=n=t):t=0,t+=(yield*this.pushSpaces(!0))}while(e+t>0);const r=this.getLine();if(null===r)return this.setNext("flow");if((-1!==n&&n<this.indentNext&&"#"!==r[0]||0===n&&(r.startsWith("---")||r.startsWith("..."))&&Rn(r[3]))&&(n!==this.indentNext-1||1!==this.flowLevel||"]"!==r[0]&&"}"!==r[0]))return this.flowLevel=0,yield"",yield*this.parseLineStart();let i=0;for(;","===r[i];)i+=(yield*this.pushCount(1)),i+=(yield*this.pushSpaces(!0)),this.flowKey=!1;switch(i+=(yield*this.pushIndicators()),r[i]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-i),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Kn),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const e=this.charAt(1);if(this.flowKey||Rn(e)||","===e)return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let t=this.buffer.indexOf(e,this.pos+1);if("'"===e)for(;-1!==t&&"'"===this.buffer[t+1];)t=this.buffer.indexOf("'",t+2);else for(;-1!==t;){let e=0;for(;"\\"===this.buffer[t-1-e];)e+=1;if(e%2==0)break;t=this.buffer.indexOf('"',t+1)}const n=this.buffer.substring(0,t);let r=n.indexOf("\n",this.pos);if(-1!==r){for(;-1!==r;){const e=this.continueScalar(r+1);if(-1===e)break;r=n.indexOf("\n",e)}-1!==r&&(t=r-("\r"===n[r-1]?2:1))}if(-1===t){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const t=this.buffer[++e];if("+"===t)this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if("-"!==t)break}return yield*this.pushUntil((e=>Rn(e)||"#"===e))}*parseBlockScalar(){let e,t=this.pos-1,n=0;e:for(let r=this.pos;e=this.buffer[r];++r)switch(e){case" ":n+=1;break;case"\n":t=r,n=0;break;case"\r":{const e=this.buffer[r+1];if(!e&&!this.atEnd)return this.setNext("block-scalar");if("\n"===e)break}default:break e}if(!e&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{const e=this.continueScalar(t+1);if(-1===e)break;t=this.buffer.indexOf("\n",e)}while(-1!==t);if(-1===t){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}if(!this.blockScalarKeep)for(;;){let e=t-1,r=this.buffer[e];"\r"===r&&(r=this.buffer[--e]);const i=e;for(;" "===r||"\t"===r;)r=this.buffer[--e];if(!("\n"===r&&e>=this.pos&&e+1+n>i))break;t=e}return yield"",yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let t,n=this.pos-1,r=this.pos-1;for(;t=this.buffer[++r];)if(":"===t){const t=this.buffer[r+1];if(Rn(t)||e&&","===t)break;n=r}else if(Rn(t)){let i=this.buffer[r+1];if("\r"===t&&("\n"===i?(r+=1,t="\n",i=this.buffer[r+1]):n=r),"#"===i||e&&Fn.includes(i))break;if("\n"===t){const e=this.continueScalar(r+1);if(-1===e)break;r=Math.max(r,e-2)}}else{if(e&&Fn.includes(t))break;n=r}return t||this.atEnd?(yield"",yield*this.pushToIndex(n+1,!0),e?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){const n=this.buffer.slice(this.pos,e);return n?(yield n,this.pos+=n.length,n.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Kn))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,t=this.charAt(1);if(Rn(t)||e&&Fn.includes(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if("<"===this.charAt(1)){let e=this.pos+2,t=this.buffer[e];for(;!Rn(t)&&">"!==t;)t=this.buffer[++e];return yield*this.pushToIndex(">"===t?e+1:e,!1)}{let e=this.pos+1,t=this.buffer[e];for(;t;)if(Dn.includes(t))t=this.buffer[++e];else{if("%"!==t||!Bn.includes(this.buffer[e+1])||!Bn.includes(this.buffer[e+2]))break;t=this.buffer[e+=3]}return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return"\n"===e?yield*this.pushCount(1):"\r"===e&&"\n"===this.charAt(1)?yield*this.pushCount(2):0}*pushSpaces(e){let t,n=this.pos-1;do{t=this.buffer[++n]}while(" "===t||e&&"\t"===t);const r=n-this.pos;return r>0&&(yield this.buffer.substr(this.pos,r),this.pos=n),r}*pushUntil(e){let t=this.pos,n=this.buffer[t];for(;!e(n);)n=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}class qn{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,n=this.lineStarts.length;for(;t<n;){const r=t+n>>1;this.lineStarts[r]<e?t=r+1:n=r}return this.lineStarts[t]===e?{line:t+1,col:1}:0===t?{line:0,col:e}:{line:t,col:e-this.lineStarts[t-1]+1}}}}function Un(e,t){for(let n=0;n<e.length;++n)if(e[n].type===t)return!0;return!1}function zn(e){for(let t=0;t<e.length;++t)switch(e[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function Yn(e){switch(e?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Gn(e){switch(e.type){case"document":return e.start;case"block-map":{const t=e.items[e.items.length-1];return t.sep??t.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function Wn(e){if(0===e.length)return[];let t=e.length;e:for(;--t>=0;)switch(e[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;"space"===e[++t]?.type;);return e.splice(t,e.length)}function Hn(e){if("flow-seq-start"===e.start.type)for(const t of e.items)!t.sep||t.value||Un(t.start,"explicit-key-ind")||Un(t.sep,"map-value-ind")||(t.key&&(t.value=t.key),delete t.key,Yn(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class Jn{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Vn,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&0===this.offset&&this.onNewLine(0);for(const n of this.lexer.lex(e,t))yield*this.next(n);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar)return this.atScalar=!1,yield*this.step(),void(this.offset+=e.length);const t=function(e){switch(e){case"\ufeff":return"byte-order-mark";case"":return"doc-mode";case"":return"flow-error-end";case"":return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case"\n":case"\r\n":return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"\t":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}(e);if(t)if("scalar"===t)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&" "===e[0]&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const t=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:t,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if("doc-end"!==this.type||e&&"doc-end"===e.type){if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}else{for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source})}}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(t)if(0===this.stack.length)yield t;else{const e=this.peek(1);switch("block-scalar"===t.type?t.indent="indent"in e?e.indent:0:"flow-collection"===t.type&&"document"===e.type&&(t.indent=0),"flow-collection"===t.type&&Hn(t),e.type){case"document":e.value=t;break;case"block-scalar":e.props.push(t);break;case"block-map":{const n=e.items[e.items.length-1];if(n.value)return e.items.push({start:[],key:t,sep:[]}),void(this.onKeyLine=!0);if(!n.sep)return Object.assign(n,{key:t,sep:[]}),void(this.onKeyLine=!Un(n.start,"explicit-key-ind"));n.value=t;break}case"block-seq":{const n=e.items[e.items.length-1];n.value?e.items.push({start:[],value:t}):n.value=t;break}case"flow-collection":{const n=e.items[e.items.length-1];return void(!n||n.value?e.items.push({start:[],key:t,sep:[]}):n.sep?n.value=t:Object.assign(n,{key:t,sep:[]}))}default:yield*this.pop(),yield*this.pop(t)}if(!("document"!==e.type&&"block-map"!==e.type&&"block-seq"!==e.type||"block-map"!==t.type&&"block-seq"!==t.type)){const n=t.items[t.items.length-1];n&&!n.sep&&!n.value&&n.start.length>0&&-1===zn(n.start)&&(0===t.indent||n.start.every((e=>"comment"!==e.type||e.indent<t.indent)))&&("document"===e.type?e.end=n.start:e.items.push({start:n.start}),t.items.splice(-1,1))}}else{const e="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:e}}}*stream(){switch(this.type){case"directive-line":return void(yield{type:"directive",offset:this.offset,source:this.source});case"byte-order-mark":case"space":case"comment":case"newline":return void(yield this.sourceToken);case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};return"doc-start"===this.type&&e.start.push(this.sourceToken),void this.stack.push(e)}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":return void(-1!==zn(e.start)?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken));case"anchor":case"tag":case"space":case"comment":case"newline":return void e.start.push(this.sourceToken)}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if("map-value-ind"===this.type){const t=Wn(Gn(this.peek(2)));let n;e.end?(n=e.end,n.push(this.sourceToken),delete e.end):n=[this.sourceToken];const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:t,key:e,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":return void e.props.push(this.sourceToken);case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf("\n")+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf("\n",e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const n="end"in t.value?t.value.end:void 0;"comment"===(Array.isArray(n)?n[n.length-1]:void 0)?.type?n?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const n=e.items[e.items.length-2]?.value?.end;if(Array.isArray(n))return Array.prototype.push.apply(n,t.start),n.push(this.sourceToken),void e.items.pop()}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const n=!this.onKeyLine&&this.indent===e.indent&&t.sep;let r=[];if(n&&t.sep&&!t.value){const n=[];for(let r=0;r<t.sep.length;++r){const i=t.sep[r];switch(i.type){case"newline":n.push(r);break;case"space":break;case"comment":i.indent>e.indent&&(n.length=0);break;default:n.length=0}}n.length>=2&&(r=t.sep.splice(n[1]))}switch(this.type){case"anchor":case"tag":return void(n||t.value?(r.push(this.sourceToken),e.items.push({start:r}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken));case"explicit-key-ind":return t.sep||Un(t.start,"explicit-key-ind")?n||t.value?(r.push(this.sourceToken),e.items.push({start:r})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}):t.start.push(this.sourceToken),void(this.onKeyLine=!0);case"map-value-ind":if(Un(t.start,"explicit-key-ind"))if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Un(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]});else if(Yn(t.key)&&!Un(t.sep,"newline")){const e=Wn(t.start),n=t.key,r=t.sep;r.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:n,sep:r}]})}else r.length>0?t.sep=t.sep.concat(r,this.sourceToken):t.sep.push(this.sourceToken);else if(Un(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const e=Wn(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||n?e.items.push({start:r,key:null,sep:[this.sourceToken]}):Un(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return void(this.onKeyLine=!0);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);return void(n||t.value?(e.items.push({start:r,key:i,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(i):(Object.assign(t,{key:i,sep:[]}),this.onKeyLine=!0))}default:{const i=this.startBlockValue(e);if(i)return n&&"block-seq"!==i.type&&Un(t.start,"explicit-key-ind")&&e.items.push({start:r}),void this.stack.push(i)}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const n="end"in t.value?t.value.end:void 0;"comment"===(Array.isArray(n)?n[n.length-1]:void 0)?.type?n?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const n=e.items[e.items.length-2]?.value?.end;if(Array.isArray(n))return Array.prototype.push.apply(n,t.start),n.push(this.sourceToken),void e.items.pop()}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;return void t.start.push(this.sourceToken);case"seq-item-ind":if(this.indent!==e.indent)break;return void(t.value||Un(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken))}if(this.indent>e.indent){const t=this.startBlockValue(e);if(t)return void this.stack.push(t)}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if("flow-error-end"===this.type){let e;do{yield*this.pop(),e=this.peek(1)}while(e&&"flow-collection"===e.type)}else if(0===e.end.length){switch(this.type){case"comma":case"explicit-key-ind":return void(!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken));case"map-value-ind":return void(!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]}));case"space":case"comment":case"newline":case"anchor":case"tag":return void(!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken));case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const n=this.flowScalar(this.type);return void(!t||t.value?e.items.push({start:[],key:n,sep:[]}):t.sep?this.stack.push(n):Object.assign(t,{key:n,sep:[]}))}case"flow-map-end":case"flow-seq-end":return void e.end.push(this.sourceToken)}const n=this.startBlockValue(e);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{const t=this.peek(2);if("block-map"===t.type&&("map-value-ind"===this.type&&t.indent===e.indent||"newline"===this.type&&!t.items[t.items.length-1].sep))yield*this.pop(),yield*this.step();else if("map-value-ind"===this.type&&"flow-collection"!==t.type){const n=Wn(Gn(t));Hn(e);const r=e.end.splice(1,e.end.length);r.push(this.sourceToken);const i={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:n,key:e,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=i}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let e=this.source.indexOf("\n")+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf("\n",e)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=Wn(Gn(e));return t.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t}]}}case"map-value-ind":{this.onKeyLine=!0;const t=Wn(Gn(e));return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return"comment"===this.type&&!(this.indent<=t)&&e.every((e=>"newline"===e.type||"space"===e.type))}*documentEnd(e){"doc-mode"!==this.type&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop())}}}function Xn(e,t={}){const{lineCounter:n,prettyErrors:r}=function(e){const t=!1!==e.prettyErrors;return{lineCounter:e.lineCounter||t&&new qn||null,prettyErrors:t}}(t),i=new Jn(n?.addNewLine),o=new Nn(t);let s=null;for(const t of o.compose(i.parse(e),!0,e.length))if(s){if("silent"!==s.options.logLevel){s.errors.push(new ln(t.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else s=t;return r&&n&&(s.errors.forEach(un(e,n)),s.warnings.forEach(un(e,n))),s}class Qn extends an{constructor(e,t,n){super(e,t,"IMPOSSIBLE",n),this.name=e}pretty(e){this.linePos=e.lineCounter.linePos(this.pos);const{line:t,col:n}=this.linePos;this.message+=` at line ${t}, column ${n} ${e.file?" @"+e.file:""}`}}class Zn{constructor(){this.lineCounter=new qn,this.src="",this.txt="",this.errors=[],this.warnings=[],this.yaml_ok=!1,this.contents=null,this.listener=null,this.prog={}}errors(e){this.errors=this.errors.concat(e)}warnings(e){this.warnings=this.warnings.concat(e)}fileError(e){let t=new Qn("FILE_ERROR",0,`FileError : ${e}`);return this.errors.push(t),t}syntaxError(e,t){let n=new Qn("SYNTAX_ERROR",e.range?e.range[0]:0,`SyntaxError : ${t}`);return this.errors.push(n),n}syntaxWarning(e,t){let n=new Qn("SYNTAX_WARNING",e.range?e.range[0]:0,`SyntaxWarning : ${t}`);return this.warnings.push(n),n}typeError(e,t){let n=new Qn("TYPE_ERROR",e.range?e.range[0]:0,`TypeError : ${t}`);return this.errors.push(n),n}grammarError(e){let t=new Qn("GRAMMAR_ERROR",0,`GrammarError : ${e}`);this.errors.push(t)}grammarWarning(e){let t=new Qn("GRAMMAR_WARNING",0,`GrammarWarning : ${e}`);return this.warnings.push(t),t}fails(){return this.errors.length>0}success(){return 0==this.errors.length&&0==this.warnings.length}result(){return this.contents}}class er{constructor(e,t,n){this.ctx=e,this.type=t,this.current=n,this.start=n.range[0],this.end=n.range[1],this.childs=[]}getChild(e){return this.childs[e]}getChildCount(){return this.childs.length}getValue(){return this.value}toString(){return this.value}}class tr extends er{constructor(e,t,n){super(e,t,n)}equals(e){if(e instanceof tr)return this.value==e.value;this.ctx.syntaxError(this.current,`Error can not compare values '${this.value}' and '${e.value}'`)}}class nr extends tr{constructor(e,t){if(super(e,"string",t),!nr.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t?t.value:""}' is not a string`);this.value=t.value}static checkCurrent(e){return X(e)&&"string"==typeof e.value}static parse(e,t){try{return new nr(e,t)}catch(e){return null}}}class rr extends tr{constructor(e,t){if(super(e,"binary",t),!rr.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t?t.value:""}' is not a base64 string`);this.value=t.value}static checkCurrent(e){return X(e)&&"string"==typeof e.value&&/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(e.value)}static parse(e,t){try{return new rr(e,t)}catch(e){return null}}}class ir extends tr{constructor(e,t){if(super(e,"int",t),!ir.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t?t.value:""}' is not an integer`);this.value=t.value}static checkCurrent(e){return X(e)&&"number"==typeof e.value&&e.value==Math.floor(e.value)}static parse(e,t){try{return new ir(e,t)}catch(e){return null}}}class or extends tr{constructor(e,t){if(super(e,"float",t),!or.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t?t.value:""}' is not a number`);this.value=t.value}static checkCurrent(e){return X(e)&&"number"==typeof e.value}static parse(e,t){try{return new or(e,t)}catch(e){return null}}}class sr extends tr{constructor(e,t){if(super(e,"boolean",t),this.value=null,!sr.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t.value}' is not a boolean`);this.value=t.value}static checkCurrent(e){return X(e)&&"boolean"==typeof e.value}static parse(e,t){try{return new sr(e,t)}catch(e){return null}}}class ar extends tr{constructor(e,t){if(super(e,"null",t),this.value=null,!ar.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t?t.value:""}' is not the null value`)}static checkCurrent(e){return X(e)&&(null==e.value||["Null","NULL","null","~"].includes(e.value))}static parse(e,t){try{return new ar(e,t)}catch(e){return null}}}class lr extends tr{constructor(e,t,n){if(super(e,"timestamp",t),!lr.checkCurrent(t))throw e.syntaxError(t,`Error: value '${t?t.value:""}' is not a timestamp in ISO9601 format`);this.value=new Date(t.value)}static checkCurrent(e){let t=X(e)&&"string"==typeof e.value&&/\d{4}-\d{2}-\d{2}|\d{4}-\d{2}?-\d{2}?([Tt]|[ \t]+)\d{2}?:\d{2}:\d{2}(\.\d*)?(([ \t]*)Z|[-+]\d\d?(:\d{2})?)?/.test(e.value);if(1==t)try{new Date(e.value)}catch(e){t=!1}return t}static parse(e,t){try{return new lr(e,t)}catch(e){return null}}equals(e){return e instanceof lr?this.value.getTime()==e.value.getTime():this.ctx.syntaxError("Error : can not compare a timestamp with something else")}}class cr extends er{constructor(e,t,n){super(e,t,n)}length(){return this.childs.length}isEmpty(){return 0==this.length()}}class ur extends cr{constructor(e,t,n){if(super(e,"map",t),"object"!=typeof n||n instanceof Array)throw e.syntaxError(t,"Erorr : MapNode must be initialized with a parsed map. This should not happen.");this.value=n;for(const e in n)this.childs.push(n[e])}static checkCurrent(e){return H(e)&&e.items.every((e=>e.key&&X(e.key)&&"string"==typeof e.key.value))}}class fr{static parse(e,t,n){"object"!=typeof t&&e.grammarError("Error: oneof rule can not be parsed'");let r=t._oneOf;if(r instanceof Array){let t=[].concat(e.errors),i=[].concat(e.warnings),o=e.errors.length;for(let s of r){let r=xr(e,null,s,n);if(o==e.errors.length)return e.errors=t,e.warnings=i,r;o=e.errors.length}return e.syntaxError(n,"Syntax Error : no valid alternative found during parsing"),null}e.grammarError("Error: _oneof rules expects a sequence of alternatives")}}var pr="undefined"!=typeof Symbol;function hr(e){var t=typeof e;return"string"===t||"number"===t||"boolean"===t||!0===pr&&"symbol"===t||null==e||!0===pr&&e instanceof Symbol||e instanceof String||e instanceof Number||e instanceof Boolean}class dr{static parse(e,t){if("object"==typeof t){if(t._oneOf){let n;!t._oneOf instanceof Array&&e.grammarError("Error : _oneof value have to be a list"),t._oneOf=t._oneOf.map((t=>dr.parse(e,t)));do{if(n=t._oneOf.findIndex((e=>e._oneOf)),n>=0){let e=t._oneOf[n]._oneOf;(t={_oneOf:[].concat(t._oneOf)})._oneOf.splice(n,1),t._oneOf=t._oneOf.concat(e)}}while(n>=0);return t}if(t._merge){if(!(t._merge instanceof Array))return e.grammarError("Error : _merge value have to be a map"),null;const{_merge:n,...r}=t;let i;t={_merge:t._merge},Object.keys(r).length&&t._merge.push(r),t._merge=t._merge.map((t=>hr(t)&&e.rules[t]?e.rules[t]:t)),t._merge=t._merge.map((t=>dr.parse(e,t)));do{if(i=t._merge.findIndex((e=>e._merge)),i>=0){let e=t.one._merge;(t={_merge:[].concat(t._merge)})._merge.splice(i,1),t._merge=t._merge.concat(e)}}while(i>=0);let o={_oneOf:[]};do{if(i=(t={_merge:[].concat(t._merge)})._merge.findIndex((e=>e._oneOf)),i>=0){let e=t._merge[i]._oneOf;(t={_merge:[].concat(t._merge)})._merge.splice(i,1),e.forEach((e=>{let n={_merge:[e].concat(t._merge)};o._oneOf.push(n)}))}}while(i>=0);if(o._oneOf.length>=1)return dr.parse(e,o);t._merge.some((e=>e._merge||e._oneOf))&&e.grammarError("Error : merge has not been processed successfully. This error should not occur.");let s={},a={},l=null,c=-1,u=-1,f=-1;t._merge.forEach((t=>{if(t._map){s={...s};for(let n in t._map)s.key&&e.grammarError("Error : can not merge two maps with some identical keys"),s[n]=t._map[n]}if(t._mapFacultative){a={...a};for(let n in t._mapFacultative)a.key&&e.grammarError("Error : can not merge two maps with some identical keys"),a[n]=t._mapFacultative[n]}if(t._mapOf){if(null!=l)return e.grammarError("Error : only one '_mapOf' is allowed in a '_merge' clause"),null;l=t._mapOf}t._nb&&(c<0||c==t._nb?c=t._nb:e.grammarError("Contradictory sizing in merge clause")),t._min&&(u=Math.max(t._min,u)),t._max&&(nax=c>0?Math.min(t._max,f):t._max)}));let p={};return c>=0&&(p._nb=c),u>=0&&(p._min=u),f>=0&&(p._max=f),Object.keys(s).length>0&&(p._map=s),Object.keys(a).length>0&&(p._mapFacultative=a),null!=l&&(p._mapOf=l),p}if(t._map){let n={};for(const r in t._map)n[r]=dr.parse(e,t._map[r]);t._map=n}if(t._mapFacultative){let n={};for(const r in t._mapFacultative)n[r]=dr.parse(e,t._mapFacultative[r]);t._mapFacultative=n}if(t._mapOf){let n={};for(const r in t._mapOf){let i=dr.parse(e,r),o=dr.parse(e,t._mapOf[r]);n[i]=o}t._mapOf=n}t._list&&(t._list=t._list.map((t=>dr.parse(e,t)))),t._listFacultative&&(t._listFacultative=t._listFacultative.map((t=>dr.parse(e,t)))),t._listOf&&(t._listOf=dr.parse(e,t._listOf))}return t}}class mr{static isPositiveInt(e){return"number"==typeof e&&e==Math.floor(e)&&e>0}static sizeChecker(e,t,n,r){if(mr.isPositiveInt(n))if(H(r)||Q(r))switch(t){case"eq":return r.items.length==n;case"min":return r.items.length>=n;case"max":return r.items.length<=n}else e.syntaxError(r,"Error : a map is expected");else e.grammarError(`Error: the map checker '${t}' does not have a positive integer as value`);return!1}static sizeCheckers(e,t,n){return null==t._nb||mr.sizeChecker(e,"eq",t._nb,n)?null==t._min||mr.sizeChecker(e,"min",t._min,n)?!(null!=t._max&&!mr.sizeChecker(e,"max",t._max,n)&&(e.syntaxError(n,`Error : map expected with more than ${t._max} elements but ${n.items.length} are provided`),1)):(e.syntaxError(n,`Error : map expected with more than ${t._min} elements but ${n.items.length} are provided`),!1):(e.syntaxError(n,`Error : map expected with ${t._nb} elements but ${n.items.length} are provided`),!1)}}class yr{static parse(e,t,n){if(!ur.checkCurrent(n))return e.syntaxError(n,"Error : a map whose keys are strings is expected "),null;if(t._merge&&(t=dr.parse(e,t))._oneOf)return fr.parse(e,t,n);let r=t._map,i=t._mapOf,o=t._mapFacultative;if(null!=i&&"object"!=typeof i||null!=o&&"object"!=typeof o)return e.grammarError("Error : error in map value definition"),null;if(!mr.sizeCheckers(e,t,n))return null;if(null!=r)for(let t in r){if("string"!=typeof t)return e.grammarError("Error : error in map definition"),null;if(!n.has(t))return e.syntaxError(n,`Error : key '${t}' not found in current value`),null}let s,a=null;if(i){let e=Object.entries(i);1==e.length&&([[s,a]]=e)}let l={};for(let i of n.items){let n=i.key.value,c=i.value,u=null;if(r&&r[n])u=xr(e,null,r[n],c);else if(o&&o[n])u=xr(e,null,o[n],c);else{if(!s||!a)return e.syntaxError(c,`Error : '${n}' is not a valid key (in rule : ${JSON.stringify(t)})`),null;{let t=xr(e,null,s,i.key);if(u=xr(e,null,a,c),t.value!=n)return e.syntaxError(n,`Error : '${n}' does not match expected '${s}' type`),null}}if(null==u)return e.syntaxError(c,`Error : bad value '${c}'found for '${n}' (mapparser.parse)`),null;let f=new nr(e,i.key);if(u.key=f,null!=l[n])return e.syntaxError(c,`Error : more than one value provided in the map for the key '${n}'`),null;l[n]=u}return new ur(e,n,l)}static parse_any(e,t){if(!ur.checkCurrent(t))return e.syntaxError(t,"Error : a map whose keys are strings is expected "),null;let n={};return t.items.forEach((t=>{let r=t.key.value,i=t.value,o=br.parse_any(e,i);if(null==o)return e.syntaxError(i,`Error : bad value '${i}' found for '${r}' (mapparser.parse_any)`),null;let s=new nr(e,t.key);o.key=s,null!=n[r]&&e.syntaxError(i,`Error : more than one value provided in the map for the key '${r}'`),n[r]=o})),new ur(e,t,n)}}class gr extends cr{constructor(e,t,n){if(super(e,"list",t),!n instanceof Array)throw e.syntaxError(t,"Erorr : ListNode must be initialized with an array. This should not happen.");this.value=n,this.childs=this.value}static checkCurrent(e){return Q(e)}}class vr{static parse(e,t,n){if(!gr.checkCurrent(n))return e.syntaxError(n,"Error : a list is expected "),null;if(!mr.sizeCheckers(e,t,n))return null;let r=t._list,i=t._listOf,o=t._listFacultative;if(null!=r&&!(r instanceof Array)||null!=o&&!(o instanceof Array))return e.grammarError("Error : error in list value definition"),null;let s=0,a=n.items.length,l=[];r&&r.forEach((t=>{if(!(s<a))return e.syntaxError(n,"Error : mandatory elements missing in the list"),null;{let r=xr(e,null,t,n.items[s]);if(null==r)return e.syntaxError(n,"Error : can node parse an element of the list"),null;l.push(r)}s+=1}));let c=[].concat(e.errors),u=[].concat(e.warnings);if(o&&o.forEach((t=>{if(s<a){let r=xr(e,null,t,n.items[s]);null!=r&&(l.push(r),s+=1)}})),null!=i)for(;s<a;s++){let t=xr(e,null,i,n.items[s]);if(null==t)return e.syntaxError(n,"Error : wrong type for an element in a list"),null;l.push(t)}return s<a?(e.syntaxError(n,"Error : too much elements in the list"),null):(e.errors=c,e.warnings=u,new gr(e,n,l))}static parse_any(e,t){if(!gr.checkCurrent(t))return e.syntaxError(t,"Error : a list whose keys are strings is expected "),null;let n=[];return t.items.forEach((t=>{let r=br.parse_any(e,t);if(null==r)return e.SyntaxError(value,`Error : bad value '${value}' found for '${key}' (listparser.parse_any)`),null;n.push(r)})),new gr(e,t,n)}}class br{static parse(e,t,n){switch(t){case"string":return nr.parse(e,n);case"binary":return rr.parse(e,n);case"timestamp":return lr.parse(e,n);case"int":return ir.parse(e,n);case"float":return or.parse(e,n);case"boolean":return sr.parse(e,n);case"null":return ar.parse(e,n);case"any":return br.parse_any(e,n);default:return Or(e,t,n)}}static parse_any(e,t){if(X(t)){switch(typeof t.value){case"number":return ir.checkCurrent(t)?ir.parse(e,t):or.parse(e,t);case"boolean":return sr.parse(e,t);case"string":return nr.parse(e,t);case"object":if(null==t.value)return ar.parse(e,t);e.syntaxError(t,`Error: value '${t.value}' is not a scalar value`);default:e.syntaxError(t,`Error: value '${t.value}' is not a scalar value`)}return null}return H(t)?yr.parse_any(e,t):Q(t)?vr.parse_any(e,t):null}}class wr{static parse(e,t,n){"object"==typeof t&&t._in||e.grammarError("Error:  can not parse _in rule'");let r=t._in;if(!(r instanceof Array))return e.grammarError("Error: _in rules expects a sequence of alternatives"),null;for(let t of r)if(!hr(t))return e.grammarError("Error: _in rules expects each alternative to be a scalar"),null;if(!X(n))return e.syntaxError(n,"Syntax Error : scalar value expected by rule '_in'"),null;let i=br.parse_any(e,n);if(i){let t=[].concat(e.errors),n=[].concat(e.warnings),o=e.errors.length,s=i.value;for(let a of r)if(a){let r=a==s?i:null;if(null!=r)return e.errors=t,e.warnings=n,r;o=e.errors.length}}return e.syntaxError(n,"Syntax Error : no valid alternative for '_in' rule found during parsing"),null}}class _r{static parse(e,t,n){if(!nr.checkCurrent(n))return e.syntaxError(n,`Error: regular expressions match only strings, '${n?n.value:""}' is not a string`),null;let r=t._regex;if(null==r)return e.grammarError("Error : regep rule must have a value for key '_regex'"),null;let i=null;try{i=new RegExp(r)}catch(e){}return null==i?(e.grammarError(`Error: value '${i}' is not a valid regular expression`),null):i.test(n.value)?new nr(e,n):(e.syntaxError(n,`Error: value '${n.value}' does not match the regular expression '${i}'`),null)}}class kr{static scalartypes=["string","int","float","null","boolean","binary","timestamp"];static keywords=["_map","_mapOf","_mapFacultative","_list","_listOf","_listFacultative","_oneOf","_regex","_nb","_min","_max","_in"];static parse(e,t,n,r){if(null==r)return e.fileError("No source to parse"),null;if(kr.scalartypes.includes(t)||kr.keywords.includes(t))return e.syntaxError(r,`'${t}' is not allowed as rule_name in Lidy Grammar (reserved keyword)`),null;let i="enter_"+t;r.ctx=e,e.listener&&e.listener[i]&&e.listener[i](r);let o=xr(e,null,n,r),s="exit_"+t;return"node_template"==t&&console.log("Sortie de node_template"),o&&e.listener&&e.listener[s]&&e.listener[s](o),o}}function xr(e,t,n,r){if(t)return kr.parse(e,t,n,r);if(hr(n))return br.parse(e,n,r);if("object"==typeof n){if(n._map||n._mapOf||n._mapFacultative||n._merge)return yr.parse(e,n,r);if(n._list||n._listOf||n._listFacultative)return vr.parse(e,n,r);if(n._oneOf)return fr.parse(e,n,r);if(n._regex)return _r.parse(e,n,r);if(n._in)return wr.parse(e,n,r)}return e.grammarError("Error : grammar error : no valid keyword found"),null}function Or(e,t,n){let r=e.rules[t];return void 0!==r?xr(e,t,r,n):(e.grammarError(`no rule named ${t} found.`),null)}function Sr(e){e.keyword||(e.keyword="main");let t=new Zn;return t.prog=e.prog,e.rules?t.rules=e.rules:function(e,t,n){try{e.rules=function(e,t,n){let r;const i=Xn(e,n);if(!i)return null;if(i.warnings.forEach((e=>qe(i.options.logLevel,e))),i.errors.length>0){if("silent"!==i.options.logLevel)throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:r},n))}(t)}catch(t){throw e.errors.push(t),e.grammarError("ERROR : can not parse dsl ")}if("object"==(e.rules,!1))throw e.grammarError("ERROR : can not parse dsl ");if(!e.rules[n])throw Error("ERROR : no rule labeled '"+n+"' in the grammar")}(t,e.dsl_data,e.keyword),t.listener=e.listener,function(e,t){e.lineCounter=new qn;let n=Xn(t,{lineCounter:e.lineCounter});n||e.fileError("can not parse the provided source code."),e.src=n.contents,e.txt=t,e.errors=n.errors,e.warnings=n.warnings,e.yaml_ok=0==e.errors.length&&0==e.warnings.length}(t,e.src_data),function(e,t,n){let r=Or(e,t,n);return e.errors.filter((e=>e instanceof Qn)).forEach((t=>t.pretty(e))),e.warnings.filter((e=>e instanceof Qn)).forEach((t=>t.pretty(e))),e.contents=r,e}(t,e.keyword,t.src)}var Er={main:"root",root:{_oneOf:["pod","service","ingress","configMap","secret","persistentVolumeClaim","deployment","statefulSet","job","cronJob","standaloneContainer","standaloneConfigMapMount","standaloneSecretMount","standalonePersistentVolumeClaimMount"]},uint16:"int",metadata:{_mapFacultative:{name:"string",namespace:"string",labels:{_mapOf:{string:"string"}},annotations:{_mapOf:{string:"string"}},finalizers:{_mapOf:{string:"string"}},ownerReferences:{_listOf:{_mapFacultative:{apiVersion:"string",blockOwnerDeletion:"boolean",controller:"boolean",kind:"string",name:"string",uid:"string"}}},managedFields:{_listOf:{_mapFacultative:{apiVersion:"string",fieldsType:"string",fieldsV1:{_mapOf:{string:"string"}},manager:"string",operation:"string",subresource:"string",time:"string"}}},generateName:"string",uid:"string",resourceVersion:"string",generation:"int",selfLink:"string",creationTimestamp:"string",deletionGracePeriodSeconds:"int",deletionTimestamp:"string"}},labelSelector:{_mapFacultative:{matchLabels:{_mapOf:{string:"string"}},matchExpressions:{_map:{key:"string",operator:{_in:["In","NotIn","Exists","DoesNotExist"]}},_mapFacultative:{values:{_listOf:"string"}}}}},pod:{_map:{apiVersion:"string",kind:{_in:["Pod"]}},_mapFacultative:{metadata:"metadata",spec:"podSpec"}},podSpec:{_map:{containers:{_listOf:"container"}},_mapFacultative:{volumes:{_listOf:{_oneOf:["configMapVolume","secretVolume","persistentVolumeClaimVolume","any"]}}},_mapOf:{any:"any"}},container:{_mapFacultative:{name:"string",image:"string",ports:{_listOf:{_mapFacultative:{name:"string",protocol:"string",hostIP:"string",hostPort:"uint16",containerPort:"uint16"}}},volumeMounts:{_listOf:"volumeMount"}},_mapOf:{0:"a",1:"n",2:"y"}},volumeMount:{_map:{name:"string",mountPath:"string"},_mapFacultative:{subPath:"string",subPathExpr:"string",mountPropagation:{_in:["None","HostToContainer","Bidirectional"]},readOnly:"boolean"}},service:{_map:{apiVersion:"string",kind:{_in:["Service"]}},_mapFacultative:{metadata:"metadata",spec:{_mapFacultative:{type:{_in:["ClusterIP","NodePort","LoadBalancer","ExternalName"]},selector:{_mapOf:{string:"string"}},ports:{_listOf:{_mapFacultative:{name:"string",protocol:{_in:["TCP","UDP","SCTP"]},targetPort:"string"},_map:{port:"uint16"}}},clusterIP:"string",externalName:"string",sessionAffinity:"string",sessionAffinityConfig:{_mapFacultative:{clientIP:{_mapFacultative:{timeoutSeconds:"int"}}}},clusterIPs:{_listOf:"string"},allocateLoadBalancerNodePorts:"boolean",externalIPs:{_listOf:"string"},externalTrafficPolicy:"string",healthCheckNodePort:"uint16",internalTrafficPolicy:"string",ipFamilies:{_listOf:"string"},ipFamilyPolicy:"string",loadBalancerClass:"string",loadBalancerSourceRanges:{_listOf:"string"},publishNotReadyAddresses:"boolean",loadBalancerIP:"string"}}}},ingress:{_map:{apiVersion:"string",kind:{_in:["Ingress"]}},_mapFacultative:{metadata:"metadata",spec:{_mapFacultative:{ingressClassName:"string",defaultBackend:"ingressBackend",rules:{_listOf:{_mapFacultative:{host:"string",http:{_map:{paths:{_listOf:{_mapFacultative:{path:"string"},_map:{pathType:{_in:["Exact","Prefix","ImplementationSpecific"]},backend:"ingressBackend"}}}}}}}},tls:{_listOf:{_mapFacultative:{hosts:{_listOf:"string"},secretName:"string"}}}}}}},ingressBackend:{_mapFacultative:{service:{_map:{name:"string"},_mapFacultative:{port:{_mapFacultative:{name:"string",number:"uint16"}}}},resource:{_mapFacultative:{apiGroup:"string"},_map:{kind:"string",name:"string"}}}},configMap:{_map:{apiVersion:"string",kind:{_in:["ConfigMap"]}},_mapFacultative:{metadata:"metadata",data:{_mapOf:{string:"string"}},binaryData:{_mapOf:{string:"string"}},immutable:"boolean"}},configMapVolume:{_map:{name:"string"},_mapFacultative:{configMap:{_mapFacultative:{name:"string",defaultMode:"number",items:{_listOf:{_map:{key:"string",path:"string"},_mapFacultative:{mode:"number"}}},optional:"boolean"}}}},secret:{_map:{apiVersion:"string",kind:{_in:["Secret"]}},_mapFacultative:{metadata:"metadata",type:{_in:["Opaque","kubernetes.io/service-account-token","kubernetes.io/dockercfg","kubernetes.io/dockerconfigjson","kubernetes.io/basic-auth","kubernetes.io/ssh-auth","kubernetes.io/tls","bootstrap.kubernetes.io/token"]},stringData:{_mapOf:{string:"string"}},data:{_mapOf:{string:"string"}},immutable:"boolean"}},secretVolume:{_map:{name:"string"},_mapFacultative:{secret:{_mapFacultative:{secretName:"string",defaultMode:"number",items:{_listOf:{_map:{key:"string",path:"string"},_mapFacultative:{mode:"number"}}},optional:"boolean"}}}},persistentVolumeClaim:{_map:{apiVersion:"string",kind:{_in:["PersistentVolumeClaim"]}},_mapFacultative:{metadata:"metadata",spec:{_mapFacultative:{storageClassName:"string",accessModes:{_listOf:{_in:["ReadWriteOnce","ReadWriteMany","ReadWriteOncePod","ReadOnlyMany"]}},volumeMode:{_in:["Filesystem","Block"]},resources:{_mapFacultative:{limits:{_mapOf:{string:"string"}},requests:{_mapOf:{string:"string"}}}},volumeName:"string",selector:"labelSelector"}}}},persistentVolumeClaimVolume:{_map:{name:"string"},_mapFacultative:{persistentVolumeClaim:{_map:{claimName:"string"},_mapFacultative:{readOnly:"boolean"}}}},deployment:{_map:{apiVersion:"string",kind:{_in:["Deployment"]}},_mapFacultative:{metadata:"metadata",spec:"deploymentSpec"}},deploymentSpec:{_mapFacultative:{replicas:"int",strategy:{_mapFacultative:{type:{_in:["RollingUpdate","Recreate"]},rollingUpdate:{_mapFacultative:{maxSurge:"string",maxUnavailable:"string"}}}},revisionHistoryLimit:"int",minReadySeconds:"int",progressDeadlineSeconds:"int",paused:"boolean"},_map:{selector:"labelSelector",template:{_mapFacultative:{metadata:"metadata",spec:"podSpec"}}}},statefulSet:{_map:{apiVersion:"string",kind:{_in:["StatefulSet"]}},_mapFacultative:{metadata:"metadata",spec:"statefulSetSpec"}},statefulSetSpec:{_map:{selector:"labelSelector",template:{_mapFacultative:{metadata:"metadata",spec:"podSpec"}}},_mapOf:{any:"any"}},job:{_map:{apiVersion:"string",kind:{_in:["Job"]}},_mapFacultative:{metadata:"metadata",spec:"jobSpec"}},jobSpec:{_mapFacultative:{selector:"labelSelector"},_map:{template:{_mapFacultative:{metadata:"metadata",spec:"podSpec"}}},_mapOf:{any:"any"}},cronJob:{_map:{apiVersion:"string",kind:{_in:["CronJob"]}},_mapFacultative:{metadata:"metadata",spec:"cronJobSpec"}},cronJobSpec:{_map:{jobTemplate:{_mapFacultative:{metadata:"metadata",spec:"jobSpec"}}},_mapOf:{any:"any"}},standaloneContainer:{_map:{apiVersion:"string",kind:{_in:["Container"]}},_mapFacultative:{isInitContainer:"boolean",name:"string",image:"string",ports:{_listOf:{_mapFacultative:{name:"string",protocol:"string",hostIP:"string",hostPort:"uint16",containerPort:"uint16"}}},volumeMounts:{_listOf:"volumeMount"}},_mapOf:{0:"a",1:"n",2:"y"}},standaloneConfigMapMount:{_map:{apiVersion:"string",kind:{_in:["ConfigMapMount"]},name:"string",mountPath:"string"},_mapFacultative:{configMap:{_mapFacultative:{name:"string",defaultMode:"number",items:{_listOf:{_map:{key:"string",path:"string"},_mapFacultative:{mode:"number"}}},optional:"boolean"}},subPath:"string",subPathExpr:"string",mountPropagation:{_in:["None","HostToContainer","Bidirectional"]},readOnly:"boolean"}},standaloneSecretMount:{_map:{apiVersion:"string",kind:{_in:["SecretMount"]},name:"string",mountPath:"string"},_mapFacultative:{secret:{_mapFacultative:{secretName:"string",defaultMode:"number",items:{_listOf:{_map:{key:"string",path:"string"},_mapFacultative:{mode:"number"}}},optional:"boolean"}},subPath:"string",subPathExpr:"string",mountPropagation:{_in:["None","HostToContainer","Bidirectional"]},readOnly:"boolean"}},standalonePersistentVolumeClaimMount:{_map:{apiVersion:"string",kind:{_in:["PersistentVolumeClaimMount"]},name:"string",mountPath:"string"},_mapFacultative:{persistentVolumeClaim:{_map:{claimName:"string"},_mapFacultative:{readOnly:"boolean"}},subPath:"string",subPathExpr:"string",mountPropagation:{_in:["None","HostToContainer","Bidirectional"]},readOnly:"boolean"}}};function Ar(e){return e.rules=Er,Sr(e)}function Tr(e){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tr(e)}function Cr(e){return function(e){if(Array.isArray(e))return Nr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pr(r.key),r)}}function Pr(e){var t=function(e,t){if("object"!==Tr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Tr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Tr(t)?t:String(t)}const Ir=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Lr(this,t),this.fileInformation=e,this.definitions=n,this.components=[],this.childComponentsByType={}}var n,r;return n=t,(r=[{key:"exit_root",value:function(e){var t=this,n=e.value.apiVersion.value,r=e.value.kind.value;delete e.value.apiVersion,delete e.value.kind;var i=this.createComponentFromTree(e,n,r);i.path=this.fileInformation.path,i.definition.childrenTypes.forEach((function(e){t.setParentComponent(i,t.childComponentsByType[e])}))}},{key:"exit_deploymentSpec",value:function(e){var t=e.value.template;if(t&&Object.keys(t.value).length){var n=this.createComponentFromTree(t,"v1","Pod");this.childComponentsByType.Pod=[n],this.setParentComponent(n,this.childComponentsByType.Container)}delete e.value.template,delete e.value.selector}},{key:"exit_podSpec",value:function(t){var n=this;this.childComponentsByType.Container=[],["initContainers","containers"].forEach((function(r){var i,o,s=(null===(i=t.value[r])||void 0===i?void 0:i.value.map((function(i){var o=n.createVolumeMountComponentsFromTree(i,t),s=n.createComponentFromTree(i,"others","Container"),a=new e.ComponentAttribute({name:"isInitContainer",type:"Boolean",definition:s.definition.definedAttributes.find((function(e){return"isInitContainer"===e.name}))});return a.value="initContainers"===r,s.attributes.push(a),n.setParentComponent(s,o),s})))||[];(o=n.childComponentsByType.Container).push.apply(o,Cr(s)),delete t.value[r]})),delete t.value.volumes}},{key:"createVolumeMountComponentsFromTree",value:function(e,t){var n,r,i=this,o=(null===(n=t.value.volumes)||void 0===n?void 0:n.value)||[],s=[];return null===(r=e.value.volumeMounts)||void 0===r||r.value.forEach((function(e){var t,n=e.value.name.value,r=o.find((function(e){return e.value.name.value===n}));if(r){var a=Object.keys(r.value).filter((function(e){return"map"===r.value[e].type}));if(1===a.length){var l={configMap:"ConfigMapMount",secret:"SecretMount",persistentVolumeClaim:"PersistentVolumeClaimMount"}[a[0]];if(l){var c=i.createComponentFromTree(e,"others",l);(t=c.attributes).push.apply(t,Cr(i.createAttributesFromTreeNode(r,c.definition).filter((function(e){return"name"!==e.name})))),s.push(c)}}}})),delete e.value.volumeMounts,s}},{key:"exit_statefulSetSpec",value:function(e){this.exit_deploymentSpec(e)}},{key:"exit_cronJobSpec",value:function(e){var t=e.value.jobTemplate;if(t&&Object.keys(t.value).length){var n=this.createComponentFromTree(t,"batch/v1","Job");this.childComponentsByType.Job=[n],this.setParentComponent(n,this.childComponentsByType.Pod)}delete e.value.jobTemplate}},{key:"exit_jobSpec",value:function(e){this.exit_deploymentSpec(e)}},{key:"createComponentFromTree",value:function(t,n,r){var i,o,s,a,l=this.definitions.find((function(e){return e.apiVersion===n&&e.type===r})),c=(null===(i=t.value.metadata)||void 0===i||null===(o=i.value.name)||void 0===o?void 0:o.value)||(null===(s=t.value.name)||void 0===s?void 0:s.value)||this.pluginData.generateComponentId(l);null===(a=t.value.metadata)||void 0===a||delete a.value.name,delete t.value.name;var u=new e.Component({id:c,definition:l,attributes:this.createAttributesFromTreeNode(t,l)});return this.components.push(u),u}},{key:"createAttributesFromTreeNode",value:function(t,n){var r=this;return Object.keys(t.value).map((function(i){var o=t.value[i],s=null==n?void 0:n.definedAttributes.find((function(e){return e.name===("list"!==t.type?i:null)})),a=new e.ComponentAttribute({name:i,type:r.lidyToLetoType(o.type),definition:s,value:"map"===o.type||"list"===o.type?r.createAttributesFromTreeNode(o,s):o.value});return s&&"Link"===s.type&&(a.type="Link","selector"!==a.name&&(a.value=a.value?[a.value]:[])),a}))}},{key:"setParentComponent",value:function(e,t){null==t||t.forEach((function(t){t.setReferenceAttribute(e)}))}},{key:"lidyToLetoType",value:function(e){switch(e){case"string":return"String";case"boolean":return"Boolean";case"int":case"float":return"Number";case"map":return"Object";case"list":return"Array";default:return null}}},{key:"exit_uint16",value:function(e){e.value<0||Math.pow(2,16)}}])&&jr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Mr(e){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mr(e)}function Rr(e){return function(e){if(Array.isArray(e))return Br(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Br(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$r(r.key),r)}}function $r(e){var t=function(e,t){if("object"!==Mr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Mr(t)?t:String(t)}function Kr(e,t){return Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kr(e,t)}function Vr(e,t){if(t&&("object"===Mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qr(e){return qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qr(e)}const Ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kr(e,t)}(s,e);var t,n,r,i,o=(r=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qr(r);if(i){var n=qr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Vr(this,e)});function s(){return Dr(this,s),o.apply(this,arguments)}return t=s,n=[{key:"isParsable",value:function(e){return/\.ya?ml$/.test(e.path)}},{key:"parse",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.pluginData.components=[],this.pluginData.parseErrors=[],t.filter((function(e){return null!==e.content})).forEach((function(t){var n,r=new Ir(t,e.pluginData.definitions.components),i=[],o=[],s=[],a=[],l=[];Ar({src_data:t.content,listener:r,path:t.path,prog:{errors:i,warnings:o,imports:s,alreadyImported:a,root:l}}),console.log(i),console.log(o),console.log(s),console.log(a),console.log(l),(n=e.pluginData.components).push.apply(n,Rr(r.components))})),this.convertSelectorAttributesToLinks(),console.log("P",this.pluginData.components)}},{key:"convertSelectorAttributesToLinks",value:function(){var e=this;this.pluginData.components.forEach((function(t){var n=t.getAttributeByName("selector");if(n)switch(t.definition.type){case"Service":e.__convertSelectorToLinkAttribute(n,"Pod");break;case"PersistentVolumeClaim":break;default:throw new Error("Unknown selector in component '".concat(t.id,"'."))}}))}},{key:"__convertSelectorToLinkAttribute",value:function(e,t){var n=this;e.value=this.pluginData.getComponentsByType(t).filter((function(t){var r,i,o=null===(r=t.attributes.find((function(e){return"metadata"===e.name})))||void 0===r||null===(i=r.value)||void 0===i?void 0:i.find((function(e){return"labels"===e.name}));if(!o)return!1;var s=n.convertObjectAttributeToJsObject(e),a=n.convertObjectAttributeToJsObject(o),l=Object.keys(s);return l.length&&l.every((function(e){return s[e]===a[e]}))})).map((function(e){return e.id}))}},{key:"convertObjectAttributeToJsObject",value:function(e){return e.value.reduce((function(e,t){var n=t.name,r=t.value;return e[n]=r,e}),{})}}],n&&Fr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(e.DefaultParser);function zr(e){return null==e}var Yr={isNothing:zr,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:zr(e)?[]:[e]},repeat:function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,r,i,o;if(t)for(n=0,r=(o=Object.keys(t)).length;n<r;n+=1)e[i=o[n]]=t[i];return e}};function Gr(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function Wr(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Gr(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}Wr.prototype=Object.create(Error.prototype),Wr.prototype.constructor=Wr,Wr.prototype.toString=function(e){return this.name+": "+Gr(this,e)};var Hr=Wr;function Jr(e,t,n,r,i){var o="",s="",a=Math.floor(i/2)-1;return r-t>a&&(t=r-a+(o=" ... ").length),n-r>a&&(n=r+a-(s=" ...").length),{str:o+e.slice(t,n).replace(/\t/g,"→")+s,pos:r-t+o.length}}function Xr(e,t){return Yr.repeat(" ",t-e.length)+e}var Qr=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Zr=["scalar","sequence","mapping"],ei=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===Qr.indexOf(t))throw new Hr('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===Zr.indexOf(this.kind))throw new Hr('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function ti(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function ni(e){return this.extend(e)}ni.prototype.extend=function(e){var t=[],n=[];if(e instanceof ei)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new Hr("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof ei))throw new Hr("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new Hr("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new Hr("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof ei))throw new Hr("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var r=Object.create(ni.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=ti(r,"implicit"),r.compiledExplicit=ti(r,"explicit"),r.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(r.compiledImplicit,r.compiledExplicit),r};var ri=ni,ii=new ei("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),oi=new ei("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),si=new ei("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),ai=new ri({explicit:[ii,oi,si]}),li=new ei("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),ci=new ei("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function ui(e){return 48<=e&&e<=55}function fi(e){return 48<=e&&e<=57}var pi=new ei("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,i=0,o=!1;if(!r)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===r)return!0;if("b"===(t=e[++i])){for(i++;i<r;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;o=!0}return o&&"_"!==t}if("x"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;o=!0}return o&&"_"!==t}if("o"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!ui(e.charCodeAt(i)))return!1;o=!0}return o&&"_"!==t}}if("_"===t)return!1;for(;i<r;i++)if("_"!==(t=e[i])){if(!fi(e.charCodeAt(i)))return!1;o=!0}return!(!o||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!Yr.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),hi=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),di=/^[-+]?[0-9]+e/,mi=new ei("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!hi.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||Yr.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Yr.isNegativeZero(e))return"-0.0";return n=e.toString(10),di.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),yi=ai.extend({implicit:[li,ci,pi,mi]}),gi=yi,vi=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),bi=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),wi=new ei("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==vi.exec(e)||null!==bi.exec(e))},construct:function(e){var t,n,r,i,o,s,a,l,c=0,u=null;if(null===(t=vi.exec(e))&&(t=bi.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(o=+t[4],s=+t[5],a=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(u=-u)),l=new Date(Date.UTC(n,r,i,o,s,a,c)),u&&l.setTime(l.getTime()-u),l},instanceOf:Date,represent:function(e){return e.toISOString()}}),_i=new ei("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",xi=new ei("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,i=e.length,o=ki;for(n=0;n<i;n++)if(!((t=o.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,o=ki,s=0,a=[];for(t=0;t<i;t++)t%4==0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(r.charAt(t));return 0==(n=i%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===n?(a.push(s>>10&255),a.push(s>>2&255)):12===n&&a.push(s>>4&255),new Uint8Array(a)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",i=0,o=e.length,s=ki;for(t=0;t<o;t++)t%3==0&&t&&(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]),i=(i<<8)+e[t];return 0==(n=o%3)?(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]):2===n?(r+=s[i>>10&63],r+=s[i>>4&63],r+=s[i<<2&63],r+=s[64]):1===n&&(r+=s[i>>2&63],r+=s[i<<4&63],r+=s[64],r+=s[64]),r}}),Oi=Object.prototype.hasOwnProperty,Si=Object.prototype.toString,Ei=new ei("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,o,s=[],a=e;for(t=0,n=a.length;t<n;t+=1){if(r=a[t],o=!1,"[object Object]"!==Si.call(r))return!1;for(i in r)if(Oi.call(r,i)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==s.indexOf(i))return!1;s.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),Ai=Object.prototype.toString,Ti=new ei("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,o,s=e;for(o=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],"[object Object]"!==Ai.call(r))return!1;if(1!==(i=Object.keys(r)).length)return!1;o[t]=[i[0],r[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,i,o,s=e;for(o=new Array(s.length),t=0,n=s.length;t<n;t+=1)r=s[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}}),Ci=Object.prototype.hasOwnProperty,Ni=new ei("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(Ci.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),Li=gi.extend({implicit:[wi,_i],explicit:[xi,Ei,Ti,Ni]}),ji=Object.prototype.hasOwnProperty,Pi=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Ii=/[\x85\u2028\u2029]/,Mi=/[,\[\]\{\}]/,Ri=/^(?:!|!!|![a-z\-]+!)$/i,Bi=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Di(e){return Object.prototype.toString.call(e)}function Fi(e){return 10===e||13===e}function $i(e){return 9===e||32===e}function Ki(e){return 9===e||32===e||10===e||13===e}function Vi(e){return 44===e||91===e||93===e||123===e||125===e}function qi(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function Ui(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function zi(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var Yi=new Array(256),Gi=new Array(256),Wi=0;Wi<256;Wi++)Yi[Wi]=Ui(Wi)?1:0,Gi[Wi]=Ui(Wi);function Hi(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Li,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Ji(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,i=[0],o=[],s=-1;n=r.exec(e.buffer);)o.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var a,l,c="",u=Math.min(e.line+t.linesAfter,o.length).toString().length,f=t.maxLength-(t.indent+u+3);for(a=1;a<=t.linesBefore&&!(s-a<0);a++)l=Jr(e.buffer,i[s-a],o[s-a],e.position-(i[s]-i[s-a]),f),c=Yr.repeat(" ",t.indent)+Xr((e.line-a+1).toString(),u)+" | "+l.str+"\n"+c;for(l=Jr(e.buffer,i[s],o[s],e.position,f),c+=Yr.repeat(" ",t.indent)+Xr((e.line+1).toString(),u)+" | "+l.str+"\n",c+=Yr.repeat("-",t.indent+u+3+l.pos)+"^\n",a=1;a<=t.linesAfter&&!(s+a>=o.length);a++)l=Jr(e.buffer,i[s+a],o[s+a],e.position-(i[s]-i[s+a]),f),c+=Yr.repeat(" ",t.indent)+Xr((e.line+a+1).toString(),u)+" | "+l.str+"\n";return c.replace(/\n$/,"")}(n),new Hr(t,n)}function Xi(e,t){throw Ji(e,t)}function Qi(e,t){e.onWarning&&e.onWarning.call(null,Ji(e,t))}var Zi={YAML:function(e,t,n){var r,i,o;null!==e.version&&Xi(e,"duplication of %YAML directive"),1!==n.length&&Xi(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&Xi(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&Xi(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&Qi(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&Xi(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],Ri.test(r)||Xi(e,"ill-formed tag handle (first argument) of the TAG directive"),ji.call(e.tagMap,r)&&Xi(e,'there is a previously declared suffix for "'+r+'" tag handle'),Bi.test(i)||Xi(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){Xi(e,"tag prefix is malformed: "+i)}e.tagMap[r]=i}};function eo(e,t,n,r){var i,o,s,a;if(t<n){if(a=e.input.slice(t,n),r)for(i=0,o=a.length;i<o;i+=1)9===(s=a.charCodeAt(i))||32<=s&&s<=1114111||Xi(e,"expected valid JSON character");else Pi.test(a)&&Xi(e,"the stream contains non-printable characters");e.result+=a}}function to(e,t,n,r){var i,o,s,a;for(Yr.isObject(n)||Xi(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(i=Object.keys(n)).length;s<a;s+=1)o=i[s],ji.call(t,o)||(t[o]=n[o],r[o]=!0)}function no(e,t,n,r,i,o,s,a,l){var c,u;if(Array.isArray(i))for(c=0,u=(i=Array.prototype.slice.call(i)).length;c<u;c+=1)Array.isArray(i[c])&&Xi(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===Di(i[c])&&(i[c]="[object Object]");if("object"==typeof i&&"[object Object]"===Di(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)to(e,t,o[c],n);else to(e,t,o,n);else e.json||ji.call(n,i)||!ji.call(t,i)||(e.line=s||e.line,e.lineStart=a||e.lineStart,e.position=l||e.position,Xi(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete n[i];return t}function ro(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):Xi(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function io(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;$i(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!Fi(i))break;for(ro(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&Qi(e,"deficient indentation"),r}function oo(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!Ki(t)))}function so(e,t){1===t?e.result+=" ":t>1&&(e.result+=Yr.repeat("\n",t-1))}function ao(e,t){var n,r,i=e.tag,o=e.anchor,s=[],a=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,Xi(e,"tab characters must not be used in indentation")),45===r)&&Ki(e.input.charCodeAt(e.position+1));)if(a=!0,e.position++,io(e,!0,-1)&&e.lineIndent<=t)s.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,uo(e,t,3,!1,!0),s.push(e.result),io(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)Xi(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!a&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=s,!0)}function lo(e){var t,n,r,i,o=!1,s=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&Xi(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(s=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):Xi(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!Ki(i);)33===i&&(s?Xi(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),Ri.test(n)||Xi(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),Mi.test(r)&&Xi(e,"tag suffix cannot contain flow indicator characters")}r&&!Bi.test(r)&&Xi(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(t){Xi(e,"tag name is malformed: "+r)}return o?e.tag=r:ji.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:Xi(e,'undeclared tag handle "'+n+'"'),!0}function co(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&Xi(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!Ki(n)&&!Vi(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Xi(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function uo(e,t,n,r,i){var o,s,a,l,c,u,f,p,h,d=1,m=!1,y=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=s=a=4===n||3===n,r&&io(e,!0,-1)&&(m=!0,e.lineIndent>t?d=1:e.lineIndent===t?d=0:e.lineIndent<t&&(d=-1)),1===d)for(;lo(e)||co(e);)io(e,!0,-1)?(m=!0,a=o,e.lineIndent>t?d=1:e.lineIndent===t?d=0:e.lineIndent<t&&(d=-1)):a=!1;if(a&&(a=m||i),1!==d&&4!==n||(p=1===n||2===n?t:t+1,h=e.position-e.lineStart,1===d?a&&(ao(e,h)||function(e,t,n){var r,i,o,s,a,l,c,u=e.tag,f=e.anchor,p={},h=Object.create(null),d=null,m=null,y=null,g=!1,v=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),c=e.input.charCodeAt(e.position);0!==c;){if(g||-1===e.firstTabInLine||(e.position=e.firstTabInLine,Xi(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),o=e.line,63!==c&&58!==c||!Ki(r)){if(s=e.line,a=e.lineStart,l=e.position,!uo(e,n,2,!1,!0))break;if(e.line===o){for(c=e.input.charCodeAt(e.position);$i(c);)c=e.input.charCodeAt(++e.position);if(58===c)Ki(c=e.input.charCodeAt(++e.position))||Xi(e,"a whitespace character is expected after the key-value separator within a block mapping"),g&&(no(e,p,h,d,m,null,s,a,l),d=m=y=null),v=!0,g=!1,i=!1,d=e.tag,m=e.result;else{if(!v)return e.tag=u,e.anchor=f,!0;Xi(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return e.tag=u,e.anchor=f,!0;Xi(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(g&&(no(e,p,h,d,m,null,s,a,l),d=m=y=null),v=!0,g=!0,i=!0):g?(g=!1,i=!0):Xi(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=r;if((e.line===o||e.lineIndent>t)&&(g&&(s=e.line,a=e.lineStart,l=e.position),uo(e,t,4,!0,i)&&(g?m=e.result:y=e.result),g||(no(e,p,h,d,m,y,s,a,l),d=m=y=null),io(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&0!==c)Xi(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return g&&no(e,p,h,d,m,null,s,a,l),v&&(e.tag=u,e.anchor=f,e.kind="mapping",e.result=p),v}(e,h,p))||function(e,t){var n,r,i,o,s,a,l,c,u,f,p,h,d=!0,m=e.tag,y=e.anchor,g=Object.create(null);if(91===(h=e.input.charCodeAt(e.position)))s=93,c=!1,o=[];else{if(123!==h)return!1;s=125,c=!0,o={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),h=e.input.charCodeAt(++e.position);0!==h;){if(io(e,!0,t),(h=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=m,e.anchor=y,e.kind=c?"mapping":"sequence",e.result=o,!0;d?44===h&&Xi(e,"expected the node content, but found ','"):Xi(e,"missed comma between flow collection entries"),p=null,a=l=!1,63===h&&Ki(e.input.charCodeAt(e.position+1))&&(a=l=!0,e.position++,io(e,!0,t)),n=e.line,r=e.lineStart,i=e.position,uo(e,t,1,!1,!0),f=e.tag,u=e.result,io(e,!0,t),h=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==h||(a=!0,h=e.input.charCodeAt(++e.position),io(e,!0,t),uo(e,t,1,!1,!0),p=e.result),c?no(e,o,g,f,u,p,n,r,i):a?o.push(no(e,null,g,f,u,p,n,r,i)):o.push(u),io(e,!0,t),44===(h=e.input.charCodeAt(e.position))?(d=!0,h=e.input.charCodeAt(++e.position)):d=!1}Xi(e,"unexpected end of the stream within a flow collection")}(e,p)?y=!0:(s&&function(e,t){var n,r,i,o,s,a=1,l=!1,c=!1,u=t,f=0,p=!1;if(124===(o=e.input.charCodeAt(e.position)))r=!1;else{if(62!==o)return!1;r=!0}for(e.kind="scalar",e.result="";0!==o;)if(43===(o=e.input.charCodeAt(++e.position))||45===o)1===a?a=43===o?3:2:Xi(e,"repeat of a chomping mode identifier");else{if(!((i=48<=(s=o)&&s<=57?s-48:-1)>=0))break;0===i?Xi(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):c?Xi(e,"repeat of an indentation width identifier"):(u=t+i-1,c=!0)}if($i(o)){do{o=e.input.charCodeAt(++e.position)}while($i(o));if(35===o)do{o=e.input.charCodeAt(++e.position)}while(!Fi(o)&&0!==o)}for(;0!==o;){for(ro(e),e.lineIndent=0,o=e.input.charCodeAt(e.position);(!c||e.lineIndent<u)&&32===o;)e.lineIndent++,o=e.input.charCodeAt(++e.position);if(!c&&e.lineIndent>u&&(u=e.lineIndent),Fi(o))f++;else{if(e.lineIndent<u){3===a?e.result+=Yr.repeat("\n",l?1+f:f):1===a&&l&&(e.result+="\n");break}for(r?$i(o)?(p=!0,e.result+=Yr.repeat("\n",l?1+f:f)):p?(p=!1,e.result+=Yr.repeat("\n",f+1)):0===f?l&&(e.result+=" "):e.result+=Yr.repeat("\n",f):e.result+=Yr.repeat("\n",l?1+f:f),l=!0,c=!0,f=0,n=e.position;!Fi(o)&&0!==o;)o=e.input.charCodeAt(++e.position);eo(e,n,e.position,!1)}}return!0}(e,p)||function(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(eo(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else Fi(n)?(eo(e,r,i,!0),so(e,io(e,!1,t)),r=i=e.position):e.position===e.lineStart&&oo(e)?Xi(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);Xi(e,"unexpected end of the stream within a single quoted scalar")}(e,p)||function(e,t){var n,r,i,o,s,a,l;if(34!==(a=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(a=e.input.charCodeAt(e.position));){if(34===a)return eo(e,n,e.position,!0),e.position++,!0;if(92===a){if(eo(e,n,e.position,!0),Fi(a=e.input.charCodeAt(++e.position)))io(e,!1,t);else if(a<256&&Yi[a])e.result+=Gi[a],e.position++;else if((s=120===(l=a)?2:117===l?4:85===l?8:0)>0){for(i=s,o=0;i>0;i--)(s=qi(a=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+s:Xi(e,"expected hexadecimal character");e.result+=zi(o),e.position++}else Xi(e,"unknown escape sequence");n=r=e.position}else Fi(a)?(eo(e,n,r,!0),so(e,io(e,!1,t)),n=r=e.position):e.position===e.lineStart&&oo(e)?Xi(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Xi(e,"unexpected end of the stream within a double quoted scalar")}(e,p)?y=!0:function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!Ki(r)&&!Vi(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Xi(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),ji.call(e.anchorMap,n)||Xi(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],io(e,!0,-1),!0}(e)?(y=!0,null===e.tag&&null===e.anchor||Xi(e,"alias node should not have any properties")):function(e,t,n){var r,i,o,s,a,l,c,u,f=e.kind,p=e.result;if(Ki(u=e.input.charCodeAt(e.position))||Vi(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(Ki(r=e.input.charCodeAt(e.position+1))||n&&Vi(r)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,s=!1;0!==u;){if(58===u){if(Ki(r=e.input.charCodeAt(e.position+1))||n&&Vi(r))break}else if(35===u){if(Ki(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&oo(e)||n&&Vi(u))break;if(Fi(u)){if(a=e.line,l=e.lineStart,c=e.lineIndent,io(e,!1,-1),e.lineIndent>=t){s=!0,u=e.input.charCodeAt(e.position);continue}e.position=o,e.line=a,e.lineStart=l,e.lineIndent=c;break}}s&&(eo(e,i,o,!1),so(e,e.line-a),i=o=e.position,s=!1),$i(u)||(o=e.position+1),u=e.input.charCodeAt(++e.position)}return eo(e,i,o,!1),!!e.result||(e.kind=f,e.result=p,!1)}(e,p,1===n)&&(y=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===d&&(y=a&&ao(e,h))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&Xi(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,c=e.implicitTypes.length;l<c;l+=1)if((f=e.implicitTypes[l]).resolve(e.result)){e.result=f.construct(e.result),e.tag=f.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(ji.call(e.typeMap[e.kind||"fallback"],e.tag))f=e.typeMap[e.kind||"fallback"][e.tag];else for(f=null,l=0,c=(u=e.typeMap.multi[e.kind||"fallback"]).length;l<c;l+=1)if(e.tag.slice(0,u[l].tag.length)===u[l].tag){f=u[l];break}f||Xi(e,"unknown tag !<"+e.tag+">"),null!==e.result&&f.kind!==e.kind&&Xi(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+f.kind+'", not "'+e.kind+'"'),f.resolve(e.result,e.tag)?(e.result=f.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):Xi(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||y}function fo(e){var t,n,r,i,o=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(io(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(s=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!Ki(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&Xi(e,"directive name must not be less than one character in length");0!==i;){for(;$i(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!Fi(i));break}if(Fi(i))break;for(t=e.position;0!==i&&!Ki(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&ro(e),ji.call(Zi,n)?Zi[n](e,n,r):Qi(e,'unknown document directive "'+n+'"')}io(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,io(e,!0,-1)):s&&Xi(e,"directives end mark is expected"),uo(e,e.lineIndent-1,4,!1,!0),io(e,!0,-1),e.checkLineBreaks&&Ii.test(e.input.slice(o,e.position))&&Qi(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&oo(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,io(e,!0,-1)):e.position<e.length-1&&Xi(e,"end of the stream or a document separator is expected")}function po(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new Hi(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,Xi(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)fo(n);return n.documents}var ho={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=po(e,n);if("function"!=typeof t)return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])},load:function(e,t){var n=po(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new Hr("expected a single document in the stream, but found more")}}},mo=Object.prototype.toString,yo=Object.prototype.hasOwnProperty,go=65279,vo={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},bo=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],wo=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function _o(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else{if(!(e<=4294967295))throw new Hr("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+Yr.repeat("0",r-t.length)+t}function ko(e){this.schema=e.schema||Li,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Yr.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,i,o,s,a,l;if(null===t)return{};for(n={},i=0,o=(r=Object.keys(t)).length;i<o;i+=1)s=r[i],a=String(t[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(l=e.compiledTypeMap.fallback[s])&&yo.call(l.styleAliases,a)&&(a=l.styleAliases[a]),n[s]=a;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?2:1,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function xo(e,t){for(var n,r=Yr.repeat(" ",t),i=0,o=-1,s="",a=e.length;i<a;)-1===(o=e.indexOf("\n",i))?(n=e.slice(i),i=a):(n=e.slice(i,o+1),i=o+1),n.length&&"\n"!==n&&(s+=r),s+=n;return s}function Oo(e,t){return"\n"+Yr.repeat(" ",e.indent*t)}function So(e){return 32===e||9===e}function Eo(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==go||65536<=e&&e<=1114111}function Ao(e){return Eo(e)&&e!==go&&13!==e&&10!==e}function To(e,t,n){var r=Ao(e),i=r&&!So(e);return(n?r:r&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e)&&35!==e&&!(58===t&&!i)||Ao(t)&&!So(t)&&35===e||58===t&&i}function Co(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function No(e){return/^\n* /.test(e)}function Lo(e,t,n,r,i){e.dump=function(){if(0===t.length)return 2===e.quotingType?'""':"''";if(!e.noCompatMode&&(-1!==bo.indexOf(t)||wo.test(t)))return 2===e.quotingType?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),a=r||e.flowLevel>-1&&n>=e.flowLevel;switch(function(e,t,n,r,i,o,s,a){var l,c,u=0,f=null,p=!1,h=!1,d=-1!==r,m=-1,y=Eo(c=Co(e,0))&&c!==go&&!So(c)&&45!==c&&63!==c&&58!==c&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c&&35!==c&&38!==c&&42!==c&&33!==c&&124!==c&&61!==c&&62!==c&&39!==c&&34!==c&&37!==c&&64!==c&&96!==c&&function(e){return!So(e)&&58!==e}(Co(e,e.length-1));if(t||s)for(l=0;l<e.length;u>=65536?l+=2:l++){if(!Eo(u=Co(e,l)))return 5;y=y&&To(u,f,a),f=u}else{for(l=0;l<e.length;u>=65536?l+=2:l++){if(10===(u=Co(e,l)))p=!0,d&&(h=h||l-m-1>r&&" "!==e[m+1],m=l);else if(!Eo(u))return 5;y=y&&To(u,f,a),f=u}h=h||d&&l-m-1>r&&" "!==e[m+1]}return p||h?n>9&&No(e)?5:s?2===o?5:2:h?4:3:!y||s||i(e)?2===o?5:2:1}(t,a,e.indent,s,(function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!r,i)){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+jo(t,e.indent)+Po(xo(t,o));case 4:return">"+jo(t,e.indent)+Po(xo(function(e,t){for(var n,r,i,o=/(\n+)([^\n]*)/g,s=(i=-1!==(i=e.indexOf("\n"))?i:e.length,o.lastIndex=i,Io(e.slice(0,i),t)),a="\n"===e[0]||" "===e[0];r=o.exec(e);){var l=r[1],c=r[2];n=" "===c[0],s+=l+(a||n||""===c?"":"\n")+Io(c,t),a=n}return s}(t,s),o));case 5:return'"'+function(e){for(var t,n="",r=0,i=0;i<e.length;r>=65536?i+=2:i++)r=Co(e,i),!(t=vo[r])&&Eo(r)?(n+=e[i],r>=65536&&(n+=e[i+1])):n+=t||_o(r);return n}(t)+'"';default:throw new Hr("impossible error: invalid scalar style")}}()}function jo(e,t){var n=No(e)?String(t):"",r="\n"===e[e.length-1];return n+(!r||"\n"!==e[e.length-2]&&"\n"!==e?r?"":"-":"+")+"\n"}function Po(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function Io(e,t){if(""===e||" "===e[0])return e;for(var n,r,i=/ [^ ]/g,o=0,s=0,a=0,l="";n=i.exec(e);)(a=n.index)-o>t&&(r=s>o?s:a,l+="\n"+e.slice(o,r),o=r+1),s=a;return l+="\n",e.length-o>t&&s>o?l+=e.slice(o,s)+"\n"+e.slice(s+1):l+=e.slice(o),l.slice(1)}function Mo(e,t,n,r){var i,o,s,a="",l=e.tag;for(i=0,o=n.length;i<o;i+=1)s=n[i],e.replacer&&(s=e.replacer.call(n,String(i),s)),(Bo(e,t+1,s,!0,!0,!1,!0)||void 0===s&&Bo(e,t+1,null,!0,!0,!1,!0))&&(r&&""===a||(a+=Oo(e,t)),e.dump&&10===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=l,e.dump=a||"[]"}function Ro(e,t,n){var r,i,o,s,a,l;for(o=0,s=(i=n?e.explicitTypes:e.implicitTypes).length;o<s;o+=1)if(((a=i[o]).instanceOf||a.predicate)&&(!a.instanceOf||"object"==typeof t&&t instanceof a.instanceOf)&&(!a.predicate||a.predicate(t))){if(n?a.multi&&a.representName?e.tag=a.representName(t):e.tag=a.tag:e.tag="?",a.represent){if(l=e.styleMap[a.tag]||a.defaultStyle,"[object Function]"===mo.call(a.represent))r=a.represent(t,l);else{if(!yo.call(a.represent,l))throw new Hr("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');r=a.represent[l](t,l)}e.dump=r}return!0}return!1}function Bo(e,t,n,r,i,o,s){e.tag=null,e.dump=n,Ro(e,n,!1)||Ro(e,n,!0);var a,l=mo.call(e.dump),c=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var u,f,p="[object Object]"===l||"[object Array]"===l;if(p&&(f=-1!==(u=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||f||2!==e.indent&&t>0)&&(i=!1),f&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(p&&f&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),"[object Object]"===l)r&&0!==Object.keys(e.dump).length?(function(e,t,n,r){var i,o,s,a,l,c,u="",f=e.tag,p=Object.keys(n);if(!0===e.sortKeys)p.sort();else if("function"==typeof e.sortKeys)p.sort(e.sortKeys);else if(e.sortKeys)throw new Hr("sortKeys must be a boolean or a function");for(i=0,o=p.length;i<o;i+=1)c="",r&&""===u||(c+=Oo(e,t)),a=n[s=p[i]],e.replacer&&(a=e.replacer.call(n,s,a)),Bo(e,t+1,s,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?c+="?":c+="? "),c+=e.dump,l&&(c+=Oo(e,t)),Bo(e,t+1,a,!0,l)&&(e.dump&&10===e.dump.charCodeAt(0)?c+=":":c+=": ",u+=c+=e.dump));e.tag=f,e.dump=u||"{}"}(e,t,e.dump,i),f&&(e.dump="&ref_"+u+e.dump)):(function(e,t,n){var r,i,o,s,a,l="",c=e.tag,u=Object.keys(n);for(r=0,i=u.length;r<i;r+=1)a="",""!==l&&(a+=", "),e.condenseFlow&&(a+='"'),s=n[o=u[r]],e.replacer&&(s=e.replacer.call(n,o,s)),Bo(e,t,o,!1,!1)&&(e.dump.length>1024&&(a+="? "),a+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Bo(e,t,s,!1,!1)&&(l+=a+=e.dump));e.tag=c,e.dump="{"+l+"}"}(e,t,e.dump),f&&(e.dump="&ref_"+u+" "+e.dump));else if("[object Array]"===l)r&&0!==e.dump.length?(e.noArrayIndent&&!s&&t>0?Mo(e,t-1,e.dump,i):Mo(e,t,e.dump,i),f&&(e.dump="&ref_"+u+e.dump)):(function(e,t,n){var r,i,o,s="",a=e.tag;for(r=0,i=n.length;r<i;r+=1)o=n[r],e.replacer&&(o=e.replacer.call(n,String(r),o)),(Bo(e,t,o,!1,!1)||void 0===o&&Bo(e,t,null,!1,!1))&&(""!==s&&(s+=","+(e.condenseFlow?"":" ")),s+=e.dump);e.tag=a,e.dump="["+s+"]"}(e,t,e.dump),f&&(e.dump="&ref_"+u+" "+e.dump));else{if("[object String]"!==l){if("[object Undefined]"===l)return!1;if(e.skipInvalid)return!1;throw new Hr("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&Lo(e,e.dump,t,o,c)}null!==e.tag&&"?"!==e.tag&&(a=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),a="!"===e.tag[0]?"!"+a:"tag:yaml.org,2002:"===a.slice(0,18)?"!!"+a.slice(18):"!<"+a+">",e.dump=a+" "+e.dump)}return!0}function Do(e,t){var n,r,i=[],o=[];for(Fo(e,i,o),n=0,r=o.length;n<r;n+=1)t.duplicates.push(i[o[n]]);t.usedDuplicates=new Array(r)}function Fo(e,t,n){var r,i,o;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===n.indexOf(i)&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)Fo(e[i],t,n);else for(i=0,o=(r=Object.keys(e)).length;i<o;i+=1)Fo(e[r[i]],t,n)}function $o(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}const Ko={Type:ei,Schema:ri,FAILSAFE_SCHEMA:ai,JSON_SCHEMA:yi,CORE_SCHEMA:gi,DEFAULT_SCHEMA:Li,load:ho.load,loadAll:ho.loadAll,dump:function(e,t){var n=new ko(t=t||{});n.noRefs||Do(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Bo(n,0,r,!0,!0)?n.dump+"\n":""},YAMLException:Hr,types:{binary:xi,float:mi,map:si,null:li,pairs:Ti,set:Ni,timestamp:wi,bool:ci,int:pi,merge:_i,omap:Ei,seq:oi,str:ii},safeLoad:$o("safeLoad","load"),safeLoadAll:$o("safeLoadAll","loadAll"),safeDump:$o("safeDump","dump")};function Vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qo(e){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qo(e)}function Uo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uo(Object(n),!0).forEach((function(t){Yo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yo(e,t,n){return(t=Ho(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ho(r.key),r)}}function Ho(e){var t=function(e,t){if("object"!==qo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qo(t)?t:String(t)}function Jo(e,t){return Jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jo(e,t)}function Xo(e,t){if(t&&("object"===qo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qo(e){return Qo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qo(e)}const Zo=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jo(e,t)}(a,t);var n,r,i,o,s=(i=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Qo(i);if(o){var n=Qo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Xo(this,e)});function a(){return Go(this,a),s.apply(this,arguments)}return n=a,(r=[{key:"renderFiles",value:function(){var t=this;return console.log("R",this.pluginData.components),this.pluginData.components.filter((function(e){return!e.getContainerId()})).map((function(n){return new e.FileInput({path:n.path,content:Ko.dump(t.formatComponent(n,!1))})}))}},{key:"formatComponent",value:function(e,t){var n=this.formatAttributes(e.attributes,e);return n=this.insertComponentName(n,e),t||(n=this.insertFront(n,"kind",e.definition.type),n=this.insertFront(n,"apiVersion",e.definition.apiVersion)),this.insertChildComponentsAttributes(n,e),this.insertDefaultValues(n,e),n}},{key:"formatAttributes",value:function(e,t){var n=this;return e.reduce((function(e,r){var i;return"Object"===r.type?e[r.name]=n.formatAttributes(r.value,t):"Array"===r.type?e[r.name]=Object.values(n.formatAttributes(r.value,t)):"Link"===r.type?"selector"===r.name?e[r.name]=n.formatSelectorLinkAttribute(r,t):e[r.name]=r.value[0]:"Reference"===(null===(i=r.definition)||void 0===i?void 0:i.type)||(e[r.name]=r.value),e}),{})}},{key:"formatSelectorLinkAttribute",value:function(e,t){var n;if(null===(n=e.value)||void 0===n||!n.length)return{};if("Service"===t.definition.type)return this.__formatSelectorLinkAttribute(e);throw new Error("Unknown selector in component '".concat(t.id,"'."))}},{key:"__formatSelectorLinkAttribute",value:function(e){var t,n,r,i=e.value[0],o=this.pluginData.getComponentById(i);if(!o)throw new Error("Target component not found '".concat(i,"'."));var s=null===(t=o.attributes.find((function(e){return"metadata"===e.name})))||void 0===t||null===(n=t.value)||void 0===n||null===(r=n.find((function(e){return"labels"===e.name})))||void 0===r?void 0:r.value;return null!=s&&s.length?this.formatAttributes(s,o):{"app.kubernetes.io/name":o.id}}},{key:"insertComponentName",value:function(e,t){return"others"!==t.definition.apiVersion?this.insertFront(e,"metadata",this.insertFront(e.metadata||{},"name",t.id)):this.insertFront(e,"name",t.id)}},{key:"insertFront",value:function(e,t,n){return delete e[t],zo(Yo({},t,n),e)}},{key:"insertChildComponentsAttributes",value:function(e,t){var n=this,r=this.pluginData.getChildren(t.id);if(r.length)switch(t.definition.type){case"Deployment":case"StatefulSet":case"Job":var i=r[0];e.spec||(e.spec={}),e.spec.template=this.formatComponent(i,!0);break;case"Pod":this.insertPodChildComponentsAttributes(e,r);break;case"Container":var o=r;e.volumeMounts=o.map((function(e){var t=n.formatComponent(e,!0);return Object.keys(t).forEach((function(e){"object"===qo(t[e])&&delete t[e]})),t}));break;case"CronJob":var s=r[0];e.spec||(e.spec={}),e.spec.jobTemplate=this.formatComponent(s,!0)}}},{key:"insertDefaultValues",value:function(e,t){var n,r,i,o,s,a,l,c;switch("others"!==t.definition.apiVersion&&((c=e.metadata).labels||(c.labels={"app.kubernetes.io/name":t.id})),t.definition.type){case"Deployment":case"StatefulSet":case"Job":e.spec||(e.spec={});var u=e.spec.template||{};delete e.spec.template,(n=e.spec).selector||(n.selector={}),e.spec.selector.matchLabels=zo({},null===(r=u.metadata)||void 0===r?void 0:r.labels)||{},(i=e.spec).template||(i.template=u);break;case"Pod":e.spec||(e.spec={}),(o=e.spec).containers||(o.containers=[]);break;case"ConfigMapMount":e.configMap||(e.configMap={}),e.mountPath||(e.mountPath="");break;case"SecretMount":e.secret||(e.secret={}),e.mountPath||(e.mountPath="");break;case"PersistentVolumeClaimMount":e.persistentVolumeClaim||(e.persistentVolumeClaim={}),(s=e.persistentVolumeClaim).claimName||(s.claimName=""),e.mountPath||(e.mountPath="");break;case"Service":e.spec||(e.spec={}),(a=e.spec).ports||(a.ports=[]);break;case"CronJob":e.spec||(e.spec={}),(l=e.spec).jobTemplate||(l.jobTemplate={})}}},{key:"insertPodChildComponentsAttributes",value:function(e,t){var n=this;e.spec||(e.spec={});var r=[];["initContainers","containers"].forEach((function(i){var o=t.filter((function(e){var t=e.getAttributeByName("isInitContainer").value;return"Container"===e.definition.type&&t===("initContainers"===i)}));o.length&&(e.spec[i]=o.map((function(e){var t=n.formatComponent(e,!0);delete t.isInitContainer;var i,o=n.pluginData.getChildren(e.id);return r.push.apply(r,function(e){if(Array.isArray(e))return Vo(e)}(i=o.map((function(e){var t=n.formatComponent(e,!0);return Object.keys(t).forEach((function(e){"object"!==qo(t[e])&&"name"!==e&&delete t[e]})),t})))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||function(e,t){if(e){if("string"==typeof e)return Vo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vo(e,t):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),t})))})),r.length&&(e.spec.volumes=r)}}])&&Wo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),a}(e.DefaultRender),es=JSON.parse('{"u2":"kubernator-plugin","i8":"0.1.0"}');function ts(e){return ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ts(e)}function ns(e,t){return ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ns(e,t)}function rs(e,t){if(t&&("object"===ts(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function is(e){return is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},is(e)}const os=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ns(e,t)}(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=is(n);if(r){var i=is(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return rs(this,e)});function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new u({name:es.u2,version:es.i8});return i.call(this,{pluginData:e,pluginDrawer:new b(e),pluginMetadata:new F(e),pluginParser:new Ur(e),pluginRenderer:new Zo(e)})}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(e.DefaultPlugin)})();var i=exports;for(var o in r)i[o]=r[o];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();