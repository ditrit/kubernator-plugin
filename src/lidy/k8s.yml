main: root

root:
  _map:
    apiVersion: string
    kind: string
  _mapFacultative:
    metadata: metadata
    spec:
      _oneOf:
        - deploymentSpec
        - podSpec
        - serviceSpec
        - ingressSpec
        - configMapSpec
        - secretSpec

# spec:
#   _oneOf:
#     - simpleSpec
#     - compoundSpec

# simpleSpec:
#   _oneOf:
#     - podSpec
#     - serviceSpec
#     - ingressSpec
#     - configMapSpec
#     - secretSpec

# compoundSpec: # special cases: spec containing multiple components
#   _oneOf:
#     - deploymentSpec # Deployments and their Pod template are treated as separate components

########## CALLBACKS ###########################################################

uint16: int

########## COMMON STRUCTS (to reuse in SPECS) ##################################

metadata:
  _mapFacultative:
    name: string
    namespace: string
    labels:
      _mapOf: { string: string }
    annotations:
      _mapOf: { string: string }

selector:
  _mapFacultative:
    matchLabels:
      _mapOf: { string: string }

########## SPECS (used for type/structure checks only) #########################

deploymentSpec:
  _mapFacultative:
    replicas: int
    selector: selector
    template:
      _mapFacultative:
        metadata: metadata
        spec: podSpec

podSpec:
  _mapFacultative:
    containers:
      _listOf:
        _mapFacultative:
          name: string
          image: string
          ports:
            _listOf:
              _mapFacultative:
                containerPort: uint16

serviceSpec:
  _mapFacultative:
    todo: string

ingressSpec:
  _mapFacultative:
    todo: string

configMapSpec:
  _mapFacultative:
    todo: string

secretSpec:
  _mapFacultative:
    todo: string
